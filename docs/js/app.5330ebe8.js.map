{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?c650","webpack:///./src/App.vue?6003","webpack:///./src/data/DiagramConfig.ts","webpack:///./src/data/Track.ts","webpack:///./src/data/Station.ts","webpack:///./src/data/Stop.ts","webpack:///./src/data/Train.ts","webpack:///./src/data/Diagram.ts","webpack:///./src/data/ViewConfig.ts","webpack:///./src/data/ViewState.ts","webpack:///./src/components/Stage.vue?b9d2","webpack:///./src/components/BackLayer.vue?2a20","webpack:///./src/components/StationGroup.vue?f8f4","webpack:///./src/components/TrackGroup.vue?7ae4","webpack:///./src/components/TrackGroup.vue","webpack:///./src/components/TrackGroup.vue?80ea","webpack:///./src/components/TrackGroup.vue?a194","webpack:///./src/components/StationGroup.vue","webpack:///./src/components/StationGroup.vue?f322","webpack:///./src/components/StationGroup.vue?1b58","webpack:///./src/components/BackLayer.vue","webpack:///./src/components/BackLayer.vue?3b1f","webpack:///./src/components/BackLayer.vue?c43c","webpack:///./src/components/Pointer.vue?20ab","webpack:///./src/utils.ts","webpack:///./src/components/Pointer.vue","webpack:///./src/components/Pointer.vue?63e5","webpack:///./src/components/Pointer.vue?a4a9","webpack:///./src/components/TrainPathLayer.vue?bd61","webpack:///./src/components/TrainPathGroup.vue?8abc","webpack:///./src/components/TrainPathMarker.vue?2a29","webpack:///./src/components/TrainPathMarker.vue","webpack:///./src/components/TrainPathMarker.vue?ce7d","webpack:///./src/components/TrainPathMarker.vue?a47c","webpack:///./src/components/TrainPathGroup.vue","webpack:///./src/components/TrainPathGroup.vue?c604","webpack:///./src/components/TrainPathGroup.vue?fe26","webpack:///./src/components/TrainPathLayer.vue","webpack:///./src/components/TrainPathLayer.vue?75af","webpack:///./src/components/TrainPathLayer.vue?44a2","webpack:///./src/components/Stage.vue","webpack:///./src/components/Stage.vue?091d","webpack:///./src/components/Stage.vue?d206","webpack:///./src/components/StationAddTrackButton.vue?c29a","webpack:///./src/components/StationAddTrackButton.vue","webpack:///./src/components/StationAddTrackButton.vue?f328","webpack:///./src/components/StationAddTrackButton.vue?b738","webpack:///./src/components/StationExpandButton.vue?ce7f","webpack:///./src/components/StationExpandButton.vue","webpack:///./src/components/StationExpandButton.vue?8892","webpack:///./src/components/StationExpandButton.vue?e10d","webpack:///./src/components/StationNameInput.vue?a0de","webpack:///./src/components/StationNameInput.vue","webpack:///./src/components/StationNameInput.vue?fcac","webpack:///./src/components/StationNameInput.vue?9ce9","webpack:///./src/components/StationRemoveButton.vue?0011","webpack:///./src/components/StationRemoveButton.vue","webpack:///./src/components/StationRemoveButton.vue?6092","webpack:///./src/components/StationRemoveButton.vue?7287","webpack:///./src/components/StationRemoveTrackButton.vue?749f","webpack:///./src/components/StationRemoveTrackButton.vue","webpack:///./src/components/StationRemoveTrackButton.vue?2de7","webpack:///./src/components/StationRemoveTrackButton.vue?c700","webpack:///./src/components/TrackNameInput.vue?e783","webpack:///./src/components/TrackNameInput.vue","webpack:///./src/components/TrackNameInput.vue?2a59","webpack:///./src/components/TrackNameInput.vue?4243","webpack:///./src/default-diagram.ts","webpack:///./src/App.vue","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/messages.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","on","updateY","onStationNameInputStart","onTrackNameInputStart","ref","_l","values","diagram","stations","scopedSlots","_u","fn","_v","proxy","class","viewState","editMode","onEditButtonClick","onUploadButtonClick","onDownloadButtonClick","staticRenderFns","minimumTimeUnit","fontFamily","topPaneHeight","hourlyLabelBottomMargin","hourlyLabelFontSize","hourlyLabelColor","hourlyGridLineWidth","hourlyGridLineColor","majorMinutelyGridLineSpan","majorMinutelyGridLineWidth","majorMinutelyGridLineColor","minorMinutelyGridLineSpan","minorMinutelyGridLineWidth","minorMinutelyGridLineColor","leftPaneWidth","stationLabelLeftMargin","stationLabelRightMargin","stationLabelFontSize","stationLabelColor","stationLineWidth","stationLineColor","plotPaneVerticalPadding","trackLabelLeftMargin","trackLabelFontSize","trackLabelColor","trackLineWidth","trackLineColor","trackLineSpan","scrollX","scrollY","xScale","yScale","trainPathWidth","trainPathColor","dc","DiagramConfig","assign","id","relY","mileage","tracks","expanded","topRelY","bottomRelY","floating","Array","isArray","Station","map","fromJSON","stationId","trackId","arrTime","depTime","Stop","stops","stopId","side","stop","find","time","undefined","stopRange","inRange","fromStopId","fromStopSide","toStopId","toStopSide","stopIndex","indexOf","prevStop","nextStop","Train","config","trains","maxId","y","x","sort","a","b","trainId","train","sta","nextSE","getPreviousStopEvent","getNextStopEvent","nextSta","Math","sign","revNextSE","revNextSta","fromEntries","max","Diagram","minHitWidth","pointerWidth","pointerColor","pointerOnMarkerColor","pointerLabelFontSize","pointerPrecisePixelPerTimeUnit","selectedTrackLabelColor","selectedTrackLineColor","selectedTrainPathColor","selectedTrainPathWidthScale","selectedTrainPathMarkerWidth","selectedTrainPathMarkerColor","unselectedTrainPathOpacity","markerLabelMaxDistance","markerLabelColor","markerLabelFontSize","markerLabelLineHeight","wheelScale","viewWidth","viewHeight","appHeight","maxRelY","trainSelections","pointerDragging","pointerOnMarker","pointerScreenX","pointerTime","pointerY","pointerTargetLine","pointerPreciseState","drawingState","trainPathDragState","stationNameInputTarget","trackNameInputTarget","controlKeyPressed","diagramFileName","stageConfig","onStageMouseDown","onStageMouseMove","onStageClick","onStageDoubleClick","onStageMouseWheel","onContextMenu","_g","$listeners","_e","lineConfig","labelConfig","topLineConfig","labelRectConfig","onStationLabelClick","onStationLabelMouseDown","station","isBottomLineIntersectingPlotPane","bottomLineConfig","onLabelClick","points","getYByRelY","track","stroke","strokeWidth","listening","width","height","text","fontSize","fill","align","verticalAlign","isInputEnabled","$emit","component","dragState","widthForChars","charSpan","from","index","dragging","konvaEvent","sy0","evt","screenY","mileage0","addEventListener","onWindowMouseMove","onWindowMouseUp","event","removeEventListener","components","TrackGroup","lines","scrollLeftTime","ceil","StationGroup","groupConfig","drawingLineConfig","rectConfig","getTimeText","forceSec","hStr","floor","mmStr","padStart","ssStr","visible","keys","viewConfig","getXByTime","lastStopId","direction","layerConfig","filter","regularTrainPathConfig","onTrainPathClick","selectedTrainPathConfig","onSelectedTrainPathClick","onSelectedTrainPathDoubleClick","onSelectedTrainPathMouseDown","onMarkerClick","onMarkerMouseDown","$event","trainPathNode","onRectMouseMove","onRectDoubleClick","isLastStop","vSide","labelPosition","getLabelPosition","prevSE","thisTime","thisSta","prevSta","thisRelY","prevRelY","abs","dir","getTrainPathDirection","screenX","regularTrainPathNodes","flat","opacity","hitStrokeWidth","trainPathNodes","selectedTrainPathEnabled","timeShift","selected","selectedTrainPathNodes","flatMap","stopEvents","getStopEvents","selectedStopRange","se","prevStation","nextStation","clickedStopRange","getClickedStopRange","clientX","clientY","changeTrainSelections","clickSelected","sel","ctrlKey","selectedFromStopIndex","findIndex","selectedToStopIndex","clickedFromStopIndex","clickedToStopIndex","$delete","$set","targetTime","getTimeByX","lastStop","nearestSta","getNearestStation","nearestStop","getNearestStop","genId","getStationsInMileageOrder","getRelYByY","minSta","minDist","minStop","minTimeShift","maxTimeShift","fromSE","getStopEvent","prevFromSE","toSE","nextToSE","min","firstNode","t0","sx0","y0","targetStopEvents","node","targetTrain","newStops","newStop","newTrain","targets","newTime","TrainPathMarker","clip","TrainPathGroup","stageDragState","document","onKeyDown","onKeyUp","target","currentTarget","scrollX0","scrollY0","screenX0","screenY0","dragged","dUnit","round","findPointerTargetLine","pointedStation","stationsInMileageOrder","pointedTrack","targetLine","reverse","f","pow","deltaY","repeat","toStopIndex","fromStopIndex","preventDefault","BackLayer","Pointer","TrainPathLayer","directives","rawName","expression","style","nativeOn","onClick","left","top","newTrack","icon","targetStation","domProps","type","_k","keyCode","onComplete","composing","paddingTop","lineHeight","border","refered","some","$buefy","dialog","confirm","message","$t","toString","onConfirm","forEach","targetTrack","tar","file","updateAppSize","$nextTick","$refs","stationNameInput","$el","focus","trackNameInput","input","createElement","accept","onchange","reader","FileReader","files","readAsText","onload","JSON","parse","e","notification","open","click","json","stringify","blob","Blob","url","URL","createObjectURL","href","download","viewElem","getElementById","clientWidth","clientHeight","initialMileage","lastMileage","sy","Stage","StationAddTrackButton","StationExpandButton","StationNameInput","StationRemoveButton","StationRemoveTrackButton","TrackNameInput","ja","confirmRemoveStationRefered","confirmRemoveTrackRefered","failedToLoadJSON","productionTip","use","defaultNotificationDuration","defaultNotificationPosition","i18n","locale","messages","render","h","$mount"],"mappings":"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","file":"js/app.5330ebe8.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{attrs:{\"id\":\"view-pane\"}},[_c('stage',{attrs:{\"id\":\"stage-pane\"},on:{\"updateY\":_vm.updateY,\"stationNameInputStart\":_vm.onStationNameInputStart,\"trackNameInputStart\":_vm.onTrackNameInputStart}}),_c('div',{attrs:{\"id\":\"ui-pane\"}},[_c('station-name-input',{ref:\"stationNameInput\"}),_c('track-name-input',{ref:\"trackNameInput\"}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-expand-button',{key:(\"station-expand-button-\" + (s.id)),attrs:{\"station\":s},on:{\"updateY\":_vm.updateY,\"trackNameInputStart\":_vm.onTrackNameInputStart}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-remove-button',{key:(\"station-remove-button-\" + (s.id)),attrs:{\"station\":s},on:{\"updateY\":_vm.updateY}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-add-track-button',{key:(\"station-add-track-button-\" + (s.id)),attrs:{\"station\":s},on:{\"updateY\":_vm.updateY,\"trackNameInputStart\":_vm.onTrackNameInputStart}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _vm._l((s.tracks),function(t){return _c('station-remove-track-button',{key:(\"station-remove-track-button-\" + (s.id) + \"-\" + (t.id)),attrs:{\"station\":s,\"track\":t},on:{\"updateY\":_vm.updateY}})})})],2)],1),_c('b-navbar',{attrs:{\"id\":\"nav-pane\",\"transparent\":\"\"},scopedSlots:_vm._u([{key:\"brand\",fn:function(){return [_c('b-navbar-item',[_vm._v(\"Diafreaks\")])]},proxy:true},{key:\"start\",fn:function(){return [_c('b-navbar-item',[_c('b-button',{class:_vm.viewState.editMode ? 'is-selected': '',attrs:{\"icon-left\":\"pencil-outline\",\"size\":\"medium\"},on:{\"click\":_vm.onEditButtonClick}})],1)]},proxy:true},{key:\"end\",fn:function(){return [_c('b-navbar-item',[_c('b-button',{attrs:{\"icon-left\":\"upload\",\"size\":\"medium\"},on:{\"click\":_vm.onUploadButtonClick}})],1),_c('b-navbar-item',[_c('b-button',{attrs:{\"icon-left\":\"download\",\"size\":\"medium\"},on:{\"click\":_vm.onDownloadButtonClick}})],1)]},proxy:true}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default class DiagramConfig {\r\n    minimumTimeUnit = 5;\r\n    fontFamily = \"Verdana, sans-serif\";\r\n    topPaneHeight = 32;\r\n    hourlyLabelBottomMargin = 4;\r\n    hourlyLabelFontSize = 16;\r\n    hourlyLabelColor = \"rgb(128, 192, 128)\";\r\n    hourlyGridLineWidth = 2.25;\r\n    hourlyGridLineColor = \"rgb(128, 192, 128)\";\r\n    majorMinutelyGridLineSpan = 10 * 60;\r\n    majorMinutelyGridLineWidth = 1.5;\r\n    majorMinutelyGridLineColor = \"rgb(128, 192, 128)\";\r\n    minorMinutelyGridLineSpan = 2 * 60;\r\n    minorMinutelyGridLineWidth = 0.75;\r\n    minorMinutelyGridLineColor = \"rgb(128, 192, 128)\";\r\n    leftPaneWidth = 160;\r\n    stationLabelLeftMargin = 16;\r\n    stationLabelRightMargin = 16;\r\n    stationLabelFontSize = 16;\r\n    stationLabelColor = \"rgb(128, 192, 128)\";\r\n    stationLineWidth = 1;\r\n    stationLineColor = \"rgb(128, 192, 128)\";\r\n    plotPaneVerticalPadding = 4;\r\n    trackLabelLeftMargin = 10;\r\n    trackLabelFontSize = 12;\r\n    trackLabelColor = \"rgb(128, 192, 128)\";\r\n    trackLineWidth = 0.75;\r\n    trackLineColor = \"rgb(128, 192, 128)\";\r\n    trackLineSpan = 12;\r\n    scrollX = 6 * 3600 * 0.08;\r\n    scrollY = 0;\r\n    xScale = 0.08;\r\n    yScale = 10;\r\n    trainPathWidth = 1;\r\n    trainPathColor = \"rgb(0, 0, 0)\";\r\n\r\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\r\n    static fromJSON(o: any): DiagramConfig {\r\n        if (!(o && typeof o == \"object\")) {\r\n            throw \"Invalid JSON\";\r\n        }\r\n        const dc = new DiagramConfig();\r\n        Object.assign(dc, o);\r\n        return dc;\r\n    }\r\n}","export default class Track {\r\n    constructor(\r\n        public id: number, \r\n        public name: string,\r\n        public relY: number = 0,\r\n    ) {}\r\n\r\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\r\n    static fromJSON(o: any): Track {\r\n        /* eslint-disable @typescript-eslint/no-explicit-any */\r\n        if (!(o && typeof o == \"object\" && o.id != null && o.name != null)) {\r\n            throw \"Invalid JSON @ Track\";\r\n        }\r\n        return o as Track;\r\n    }\r\n}","import Track from \"./Track\";\r\n\r\nexport default class Station {\r\n    constructor(\r\n        public id: number, \r\n        public name: string,\r\n        public mileage: number = 0,\r\n        public tracks: Track[] = [],\r\n        public expanded: boolean = false,\r\n        public topRelY: number = 0,\r\n        public bottomRelY: number = 0,\r\n        public floating: number = 0,\r\n    ) {}\r\n\r\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\r\n    static fromJSON(o: any): Station {\r\n        /* eslint-disable @typescript-eslint/no-explicit-any */\r\n        if (!(o && typeof o == \"object\" && o.id != null && o.name != null && o.mileage != null && Array.isArray(o.tracks))) {\r\n            throw \"Invalid JSON @ Station\"\r\n        }\r\n        return new Station(\r\n            o.id,\r\n            o.name,\r\n            o.mileage,\r\n            o.tracks.map((t: any) => Track.fromJSON(t)),\r\n            o.expanded,\r\n        )\r\n    }\r\n}\r\n","export default class Stop {\r\n    constructor(\r\n        public id: number,\r\n        public stationId: number,\r\n        public trackId: number,\r\n        public arrTime: number,\r\n        public depTime: number,\r\n    ) {}\r\n\r\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\r\n    static fromJSON(o: any): Stop {\r\n        /* eslint-disable @typescript-eslint/no-explicit-any */\r\n        if (!(o && typeof o == \"object\" && o.stationId != null && o.trackId != null && (o.arrTime != null || o.depTime != null))) {\r\n            throw \"Invalid JSON @ Stop\";\r\n        }\r\n        return new Stop(\r\n            o.id,\r\n            o.stationId,\r\n            o.trackId,\r\n            o.arrTime != null ? o.arrTime : o.depTime,\r\n            o.depTime != null ? o.depTime : o.arrTime\r\n        );\r\n    }\r\n}","import Stop from \"./Stop\";\r\n\r\nexport interface TrainStopRange {\r\n    fromStopId: number;\r\n    fromStopSide: \"arr\" | \"dep\";\r\n    toStopId: number;\r\n    toStopSide: \"arr\" | \"dep\";\r\n}\r\n\r\nexport interface TrainStopEvent {\r\n    stop: Stop;\r\n    side: \"arr\" | \"dep\";\r\n    time: number;\r\n}\r\n\r\nexport default class Train {\r\n    constructor(\r\n        public id: number, \r\n        public name: string,\r\n        public stops: Stop[] = [],\r\n    ) {}\r\n\r\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\r\n    static fromJSON(o: any): Train {\r\n        /* eslint-disable @typescript-eslint/no-explicit-any */\r\n        if (!(o && typeof o == \"object\" && o.id != null && o.name != null && Array.isArray(o.stops))) {\r\n            throw \"Invalid JSON @ Train\";\r\n        }\r\n        return new Train(\r\n            o.id,\r\n            o.name,\r\n            o.stops.map((s: any) => Stop.fromJSON(s)),\r\n        )\r\n    }\r\n\r\n    getStopEvent(stopId: number, side: \"arr\" | \"dep\"): TrainStopEvent | undefined {\r\n        const stop = this.stops.find(s => s.id == stopId);\r\n        return stop ?\r\n            {\r\n                stop: stop,\r\n                side: side,\r\n                time: side == \"arr\" ? stop.arrTime : stop.depTime\r\n            } :\r\n            undefined;\r\n    }\r\n\r\n    getStopEvents(stopRange: TrainStopRange | null = null): TrainStopEvent[] {\r\n        const result: TrainStopEvent[] = [];\r\n        let inRange = stopRange === null;\r\n        for (const stop of this.stops) {\r\n            if (stopRange && stopRange.fromStopId == stop.id && stopRange.fromStopSide == \"arr\") {\r\n                inRange = true;\r\n            }\r\n            if (inRange) {\r\n                result.push({ stop: stop, side: \"arr\", time: stop.arrTime });\r\n            }\r\n            if (stopRange && stopRange.toStopId == stop.id && stopRange.toStopSide == \"arr\") {\r\n                inRange = false;\r\n            }\r\n            if (stopRange && stopRange.fromStopId == stop.id && stopRange.fromStopSide == \"dep\") {\r\n                inRange = true;\r\n            }\r\n            if (inRange) {\r\n                result.push({ stop: stop, side: \"dep\", time: stop.depTime });\r\n            }\r\n            if (stopRange && stopRange.toStopId == stop.id && stopRange.toStopSide == \"dep\") {\r\n                inRange = false;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    getPreviousStopEvent(stopId: number, side: \"arr\" | \"dep\"): TrainStopEvent | undefined {\r\n        const stop = this.stops.find(s => s.id == stopId);\r\n        if (!stop) {\r\n            return;\r\n        } else if (side == \"dep\") {\r\n            return { stop: stop, side: \"arr\", time: stop.arrTime };\r\n        } else {\r\n            const stopIndex = this.stops.indexOf(stop);\r\n            if (stopIndex == 0) {\r\n                return;\r\n            } else {\r\n                const prevStop = this.stops[stopIndex - 1];\r\n                return { stop: prevStop, side: \"dep\", time: prevStop.depTime };\r\n            }\r\n        }\r\n    }\r\n\r\n    getNextStopEvent(stopId: number, side: \"arr\" | \"dep\"): TrainStopEvent | undefined {\r\n        const stop = this.stops.find(s => s.id == stopId);\r\n        if (!stop) {\r\n            return;\r\n        } else if (side == \"arr\") {\r\n            return { stop: stop, side: \"dep\", time: stop.depTime };\r\n        } else {\r\n            const stopIndex = this.stops.indexOf(stop);\r\n            if (stopIndex == this.stops.length - 1) {\r\n                return;\r\n            } else {\r\n                const nextStop = this.stops[stopIndex + 1];\r\n                return { stop: nextStop, side: \"arr\", time: nextStop.arrTime };\r\n            }\r\n        }\r\n    }\r\n}\r\n","import DiagramConfig from \"./DiagramConfig\";\r\nimport Station from \"./Station\";\r\nimport Train from \"./Train\";\r\n\r\nexport default class Diagram {\r\n    constructor(\r\n        public config: DiagramConfig,\r\n        public stations: { [id: number]: Station },\r\n        public trains: { [id: number]: Train },\r\n        public maxId: number,\r\n    ) {}\r\n    \r\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\r\n    static fromJSON(o: any): Diagram {\r\n        /* eslint-disable @typescript-eslint/no-explicit-any */\r\n        if (!(o && typeof o == \"object\" && typeof o.stations == \"object\" && typeof o.trains == \"object\")) {\r\n            throw \"Invalid JSON\";\r\n        }\r\n        const config = DiagramConfig.fromJSON(o.config || {});\r\n        const stations: { [id: number]: Station } = Object.fromEntries(Object.values(o.stations).map((s: any) => [ s.id, Station.fromJSON(s) ]));\r\n        const trains: { [id: number]: Train } = Object.fromEntries(Object.values(o.trains).map((t: any) => [ t.id, Train.fromJSON(t) ]));\r\n\r\n        let maxId = o.maxId ? Math.max(o.maxId, 0) : 0;\r\n        for (const s of Object.values(stations)) {\r\n            maxId = Math.max(s.id, maxId);\r\n            for (const t of s.tracks) {\r\n                maxId = Math.max(t.id, maxId);\r\n            }\r\n        }\r\n        for (const t of Object.values(trains)) {\r\n            maxId = Math.max(t.id, maxId);\r\n            for (const s of t.stops) {\r\n                maxId = Math.max(s.id, maxId);\r\n            }\r\n        }\r\n\r\n        return new Diagram(config, stations, trains, maxId);\r\n    }\r\n\r\n    getYByRelY(relY: number) {\r\n        return relY + this.config.topPaneHeight - this.config.scrollY;\r\n    }\r\n    getRelYByY(y: number) {\r\n        return y - this.config.topPaneHeight + this.config.scrollY;\r\n    }\r\n    getXByTime(time: number) {\r\n        return time * this.config.xScale + this.config.leftPaneWidth - this.config.scrollX;\r\n    }\r\n    getTimeByX(x: number) {\r\n        return (x - this.config.leftPaneWidth + this.config.scrollX) / this.config.xScale;\r\n    }\r\n\r\n    getStationsInMileageOrder(): Station[] {\r\n        return Object.values(this.stations).sort((a, b) => a.mileage - b.mileage);\r\n    }\r\n\r\n    getTrainPathDirection(trainId: number, stopId: number, side: \"arr\" | \"dep\"): number {\r\n        const train = this.trains[trainId];\r\n        if (!train) return 0;\r\n\r\n        const stop = train.stops.find(s => s.id == stopId);\r\n        if (!stop) return 0;\r\n\r\n        const sta = this.stations[stop.stationId];\r\n        if (!sta) return 0;\r\n\r\n        const nextSE = side == \"arr\" ? train.getPreviousStopEvent(stopId, \"arr\") : train.getNextStopEvent(stopId, \"dep\");\r\n        if (nextSE) {\r\n            const nextSta = this.stations[nextSE.stop.stationId];\r\n            if (!nextSta) return 0;\r\n            return Math.sign(nextSta.mileage - sta.mileage);\r\n        }\r\n\r\n        const revNextSE = side == \"arr\" ? train.getNextStopEvent(stopId, \"dep\") : train.getPreviousStopEvent(stopId, \"arr\");\r\n        if (revNextSE) {\r\n            const revNextSta = this.stations[revNextSE.stop.stationId];\r\n            if (!revNextSta) return 0;\r\n            return Math.sign(sta.mileage - revNextSta.mileage);\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    genId(): number {\r\n        return ++this.maxId;\r\n    }\r\n}","export default class ViewConfig {\r\n    minHitWidth = 3;\r\n    pointerWidth = 3;\r\n    pointerColor = \"rgb(0, 0, 0)\";\r\n    pointerOnMarkerColor = \"rgb(255, 0, 0)\";\r\n    pointerLabelFontSize = 12;\r\n    pointerPrecisePixelPerTimeUnit = 5;\r\n    selectedTrackLabelColor = \"rgb(255, 0, 0)\";\r\n    selectedTrackLineColor = \"rgb(255, 0, 0)\";\r\n    selectedTrainPathColor = \"rgb(255, 0, 0)\";\r\n    selectedTrainPathWidthScale = 1.5;\r\n    selectedTrainPathMarkerWidth = 5;\r\n    selectedTrainPathMarkerColor = \"rgb(255, 0, 0)\";\r\n    unselectedTrainPathOpacity = 0.5;\r\n    markerLabelMaxDistance = 20;\r\n    markerLabelColor = \"rgb(255, 0, 0)\";\r\n    markerLabelFontSize = 12;\r\n    markerLabelLineHeight = 16;\r\n    wheelScale = 1;\r\n}\r\n","import Station from \"./Station\";\r\nimport { TrainStopRange } from \"./Train\";\r\nimport Track from \"./Track\";\r\n\r\nexport interface TrainSelectionState {\r\n    trainId: number;\r\n    stopRange: TrainStopRange | null;\r\n}\r\n\r\nexport default class ViewState {\r\n    viewWidth = 0;\r\n    viewHeight = 0;\r\n    appHeight = 0;\r\n    maxRelY = 0;\r\n    trainSelections: { [trainId: number]: TrainSelectionState } = {};\r\n    pointerDragging = false;\r\n    pointerOnMarker = false;\r\n    pointerScreenX = 0;\r\n    pointerTime = 0;\r\n    pointerY = 0;\r\n    pointerTargetLine: { station: Station, track?: Track } | null = null;\r\n    pointerPreciseState: { sx0: number, t0: number } | null = null;\r\n    editMode = true;\r\n    drawingState: { trainId: number, lastStopId: number, direction: number } | null = null;\r\n    trainPathDragState: { timeShift: number } | null = null;\r\n    stationNameInputTarget: { stationId: number } | null = null;\r\n    trackNameInputTarget: { stationId: number, trackId: number } | null = null;\r\n    controlKeyPressed = false;\r\n    diagramFileName = \"diafreaks-diagram.json\";\r\n\r\n    get isInputEnabled(): boolean {\r\n        return this.stationNameInputTarget != null || this.trackNameInputTarget != null;\r\n    }\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.diagram)?_c('v-stage',{attrs:{\"config\":_vm.stageConfig},on:{\"mousedown\":_vm.onStageMouseDown,\"mousemove\":_vm.onStageMouseMove,\"click\":_vm.onStageClick,\"dblclick\":_vm.onStageDoubleClick,\"wheel\":_vm.onStageMouseWheel,\"contextmenu\":_vm.onContextMenu}},[_c('back-layer',_vm._g({},_vm.$listeners)),_c('train-path-layer'),_c('v-layer',[_c('pointer')],1)],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-layer',{attrs:{\"id\":\"back-layer\"}},[_vm._l((_vm.timeGridLines),function(t){return _c('v-group',{key:t.key},[_c('v-line',{attrs:{\"config\":t.lineConfig}}),(t.labelConfig)?_c('v-text',{attrs:{\"config\":t.labelConfig}}):_vm._e()],1)}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-group',_vm._g({key:(\"station-\" + (s.id)),attrs:{\"station\":s}},_vm.$listeners))})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[(_vm.isTopLineIntersectingPlotPane)?_c('v-group',[_c('v-line',{attrs:{\"config\":_vm.topLineConfig}}),_vm._l((_vm.labelCharacters),function(c){return _c('v-text',{key:c.key,attrs:{\"config\":c}})}),_c('v-rect',{attrs:{\"config\":_vm.labelRectConfig},on:{\"click\":_vm.onStationLabelClick,\"mousedown\":_vm.onStationLabelMouseDown}})],2):_vm._e(),(_vm.station.expanded && _vm.isBottomLineIntersectingPlotPane)?_c('v-line',{attrs:{\"config\":_vm.bottomLineConfig}}):_vm._e(),(_vm.station.expanded)?_vm._l((_vm.station.tracks),function(t){return _c('track-group',_vm._g({key:(\"track-\" + (_vm.station.id) + \"-\" + (t.id)),attrs:{\"station\":_vm.station,\"track\":t}},_vm.$listeners))}):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isLineIntersectingPlotPane)?_c('v-group',[_c('v-line',{attrs:{\"config\":_vm.lineConfig}}),_c('v-text',{attrs:{\"config\":_vm.labelConfig},on:{\"click\":_vm.onLabelClick}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport Station from \"@/data/Station\";\nimport Track from \"@/data/Track\";\n\n@Component\nexport default class TrackGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() station!: Station;\n  @Prop() track!: Track;\n  \n  get lineConfig(): unknown {\n    return {\n      points: [\n        this.diagram.config.stationLabelLeftMargin + this.diagram.config.trackLabelLeftMargin, \n        this.diagram.getYByRelY(this.track.relY), \n        this.viewState.viewWidth, \n        this.diagram.getYByRelY(this.track.relY)\n      ],\n      stroke: this.diagram.config.trackLineColor,\n      strokeWidth: this.diagram.config.trackLineWidth,\n      listening: false,\n    }\n  }\n\n  get labelConfig(): unknown {\n    return {\n      id: `track-label-${this.station.id}-${this.track.id}`,\n      x: this.diagram.config.stationLabelLeftMargin + this.diagram.config.trackLabelLeftMargin,\n      y: this.diagram.getYByRelY(this.track.relY) - this.diagram.config.trackLabelFontSize,\n      width: this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.trackLabelLeftMargin - this.diagram.config.stationLabelRightMargin,\n      height: this.diagram.config.trackLabelFontSize,\n      text: this.track.name,\n      fontSize: this.diagram.config.trackLabelFontSize,\n      fontFamily: this.diagram.config.fontFamily,\n      fill: this.diagram.config.trackLabelColor,\n      align: \"left\",\n      verticalAlign: \"bottom\",\n    }\n  }\n\n  get isLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.track.relY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.track.relY) < this.viewState.viewHeight;\n  }\n\n  onLabelClick(): void {\n    if (this.viewState.editMode && !this.viewState.isInputEnabled) {\n      this.viewState.trackNameInputTarget = { stationId: this.station.id, trackId: this.track.id };\n      this.$emit(\"trackNameInputStart\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrackGroup.vue?vue&type=template&id=78152546&scoped=true&\"\nimport script from \"./TrackGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrackGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"78152546\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport TrackGroup from \"./TrackGroup.vue\";\nimport { KonvaEventObject } from \"konva/types/Node\";\n\n@Component({\n  components: {\n    TrackGroup\n  },\n})\nexport default class StationGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() station!: Station;\n\n  dragState: { sy0: number, mileage0: number, dragging: boolean } | null = null;\n\n  get topLineConfig(): unknown {\n    return {\n      points: [\n        0, \n        this.diagram.getYByRelY(this.station.topRelY), \n        this.viewState.viewWidth, \n        this.diagram.getYByRelY(this.station.topRelY)\n      ],\n      stroke: this.diagram.config.stationLineColor,\n      strokeWidth: this.diagram.config.stationLineWidth,\n      listening: false,\n    }\n  }\n\n  get bottomLineConfig(): unknown {\n    return {\n      points: [\n        0, \n        this.diagram.getYByRelY(this.station.bottomRelY), \n        this.viewState.viewWidth, \n        this.diagram.getYByRelY(this.station.bottomRelY)\n      ],\n      stroke: this.diagram.config.stationLineColor,\n      strokeWidth: this.diagram.config.stationLineWidth,\n      listening: false,\n    }\n  }\n\n  get labelRectConfig(): unknown {\n    return {\n      id: `station-label-${this.station.id}`,\n      x: this.diagram.config.stationLabelLeftMargin,\n      y: this.diagram.getYByRelY(this.station.topRelY) - this.diagram.config.stationLabelFontSize,\n      width: this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.stationLabelRightMargin,\n      height: this.diagram.config.stationLabelFontSize,\n    };\n  }\n\n  get labelCharacters(): unknown {\n    const widthForChars = this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.stationLabelRightMargin - this.diagram.config.stationLabelFontSize;\n    const charSpan = this.station.name.length > 1 ? widthForChars / (this.station.name.length - 1) : 0;\n    return Array.from(this.station.name).map((c, index) => {\n      return {\n        key: `station-label-${this.station.id}-${index}`,\n        x: this.station.name.length > 1 ? \n            this.diagram.config.stationLabelLeftMargin + index * charSpan :\n            this.diagram.config.stationLabelLeftMargin + widthForChars * 0.5,\n        y: this.diagram.getYByRelY(this.station.topRelY) - this.diagram.config.stationLabelFontSize,\n        height: this.diagram.config.stationLabelFontSize,\n        text: c,\n        fontSize: this.diagram.config.stationLabelFontSize,\n        fontFamily: this.diagram.config.fontFamily,\n        fill: this.diagram.config.stationLabelColor,\n        align: \"left\",\n        verticalAlign: \"bottom\",\n      }\n    });\n  }\n\n  get isTopLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.topRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.topRelY) < this.viewState.viewHeight;\n  }\n\n  get isBottomLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.bottomRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  onStationLabelClick(): void {\n    if (this.viewState.editMode && !this.viewState.isInputEnabled && !this.dragState?.dragging) {\n      this.viewState.stationNameInputTarget = { stationId: this.station.id };\n      this.$emit(\"stationNameInputStart\");\n    }\n  }\n\n  onStationLabelMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    this.dragState = {\n      sy0: konvaEvent.evt.screenY,\n      mileage0: this.station.mileage,\n      dragging: false,\n    };\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState) {\n      this.dragState.dragging = true;\n      this.station.mileage = this.dragState.mileage0 + (event.screenY - this.dragState.sy0) / this.diagram.config.yScale;\n      this.$emit(\"updateY\");\n    }\n  }\n\n  onWindowMouseUp(event: MouseEvent): void {\n    if (this.dragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      this.onWindowMouseMove(event);\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationGroup.vue?vue&type=template&id=3a438b01&scoped=true&\"\nimport script from \"./StationGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3a438b01\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewState from \"@/data/ViewState\";\nimport StationGroup from \"./StationGroup.vue\";\n\n@Component({\n  components: {\n    StationGroup\n  },\n})\nexport default class BackLayer extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  get timeGridLines(): unknown {\n    const lines = [];\n    const scrollLeftTime = this.diagram.config.scrollX / this.diagram.config.xScale;\n    let t = Math.ceil(scrollLeftTime / this.diagram.config.minorMinutelyGridLineSpan) * this.diagram.config.minorMinutelyGridLineSpan;\n    let x = t * this.diagram.config.xScale - this.diagram.config.scrollX + this.diagram.config.leftPaneWidth;\n    while (x < this.viewState.viewWidth) {\n      lines.push({\n        key: `time-grid-line-${lines.length}`,\n        lineConfig: {\n          points: [\n            x,\n            this.diagram.config.topPaneHeight,\n            x,\n            this.viewState.viewHeight\n          ],\n          stroke:\n            t % 3600 == 0 ? this.diagram.config.hourlyGridLineColor :\n            t % this.diagram.config.majorMinutelyGridLineSpan == 0 ? this.diagram.config.majorMinutelyGridLineColor :\n            this.diagram.config.minorMinutelyGridLineColor,\n          strokeWidth: \n            t % 3600 == 0 ? this.diagram.config.hourlyGridLineWidth :\n            t % this.diagram.config.majorMinutelyGridLineSpan == 0 ? this.diagram.config.majorMinutelyGridLineWidth :\n            this.diagram.config.minorMinutelyGridLineWidth,\n          listening: false,\n        },\n        labelConfig: t % 3600 != 0 ? null : {\n          x: x - this.diagram.config.hourlyLabelFontSize,\n          y: this.diagram.config.topPaneHeight - this.diagram.config.hourlyLabelBottomMargin - this.diagram.config.hourlyLabelFontSize,\n          width: this.diagram.config.hourlyLabelFontSize * 2,\n          height: this.diagram.config.hourlyLabelFontSize,\n          text: `${ t / 3600 % 24 }`,\n          fontSize: this.diagram.config.hourlyLabelFontSize,\n          fontFamily: this.diagram.config.fontFamily,\n          fill: this.diagram.config.hourlyLabelColor,\n          align: \"center\",\n          verticalAlign: \"bottom\",\n        }\n      });\n      t += this.diagram.config.minorMinutelyGridLineSpan;\n      x = t * this.diagram.config.xScale - this.diagram.config.scrollX + this.diagram.config.leftPaneWidth;\n    }\n    return lines;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BackLayer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BackLayer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./BackLayer.vue?vue&type=template&id=654ee79b&scoped=true&\"\nimport script from \"./BackLayer.vue?vue&type=script&lang=ts&\"\nexport * from \"./BackLayer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"654ee79b\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',{attrs:{\"config\":_vm.groupConfig}},[(_vm.viewState.drawingState)?_c('v-line',{attrs:{\"config\":_vm.drawingLineConfig}}):_vm._e(),_c('v-rect',{attrs:{\"config\":_vm.rectConfig}}),_c('v-text',{attrs:{\"config\":_vm.labelConfig}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export function getTimeText(time: number, forceSec?: boolean): string {\r\n    const hStr = `${Math.floor(time / 3600)}`;\r\n    const mmStr = `${Math.floor(time / 60) % 60}`.padStart(2, \"0\");\r\n    const ssStr = `${time % 60}`.padStart(2, \"0\");\r\n    return time % 60 != 0 || forceSec ? `${hStr}:${mmStr}:${ssStr}` : `${hStr}:${mmStr}`;\r\n}\r\n","\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport { getTimeText } from \"@/utils\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class TrainPathGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  get groupConfig(): unknown {\n    return {\n      visible: this.viewState.pointerTargetLine != null && (Object.keys(this.viewState.trainSelections).length == 0 || this.viewState.drawingState != null),\n    };\n  }\n\n  get rectConfig(): unknown {\n    const width = this.viewState.drawingState ? this.viewConfig.selectedTrainPathMarkerWidth : this.viewConfig.pointerWidth;\n    return {\n      x: this.diagram.getXByTime(this.viewState.pointerTime) - width * 0.5,\n      y: this.viewState.pointerY - width * 0.5,\n      width: width,\n      height: width,\n      fill: this.viewState.pointerOnMarker || this.viewState.drawingState ? this.viewConfig.pointerOnMarkerColor : this.viewConfig.pointerColor,\n      listening: false,\n    };\n  }\n\n  get labelConfig(): unknown {\n    const time = this.viewState.pointerTime >= 0 ? \n      this.viewState.pointerTime : \n      this.viewState.pointerTime + Math.ceil(-this.viewState.pointerTime / 3600) * 3600;\n    return {\n      x: this.diagram.getXByTime(this.viewState.pointerTime),\n      y: this.viewState.pointerY - this.viewConfig.pointerLabelFontSize,\n      height: this.viewConfig.pointerLabelFontSize,\n      text: getTimeText(time, this.viewState.pointerPreciseState != null),\n      fontSize: this.viewConfig.pointerLabelFontSize,\n      fontFamily: this.diagram.config.fontFamily,\n      fill: this.viewState.pointerOnMarker || this.viewState.drawingState ? this.viewConfig.pointerOnMarkerColor : this.viewConfig.pointerColor,\n      align: \"left\",\n      verticalAlign: \"bottom\",\n      listening: false,\n    }\n  }\n\n  get drawingLineConfig(): unknown {\n    const drawingState = this.viewState.drawingState;\n    if (drawingState) {  // always true\n      const train = this.diagram.trains[drawingState.trainId];\n      const stop = train.stops.find(s => s.id == drawingState.lastStopId);\n      if (stop) {\n        return {\n          points: [  \n            this.diagram.getXByTime(this.viewState.pointerTime),\n            this.viewState.pointerY,\n            this.diagram.getXByTime(drawingState.direction > 0 ? stop.depTime : stop.arrTime),\n            this.diagram.getYByRelY(this.diagram.stations[stop.stationId].tracks.find(t => t.id == stop.trackId)?.relY ?? 0)\n          ],\n          stroke: this.viewConfig.selectedTrainPathColor,\n          strokeWidth: this.diagram.config.trainPathWidth * this.viewConfig.selectedTrainPathWidthScale,\n        };\n      } else {\n        return {};\n      }\n    } else {\n      return {};\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pointer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pointer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Pointer.vue?vue&type=template&id=6a163b4d&scoped=true&\"\nimport script from \"./Pointer.vue?vue&type=script&lang=ts&\"\nexport * from \"./Pointer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6a163b4d\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-layer',{ref:\"trainPathLayer\",attrs:{\"id\":\"train-path-layer\",\"config\":_vm.layerConfig}},[_vm._l((Object.values(_vm.diagram.trains).filter(function (t) { return !_vm.viewState.trainSelections[t.id]; })),function(t){return _c('train-path-group',{key:(\"train-\" + (t.id)),attrs:{\"train\":t}})}),_vm._l((Object.values(_vm.diagram.trains).filter(function (t) { return _vm.viewState.trainSelections[t.id]; })),function(t){return _c('train-path-group',{key:(\"train-\" + (t.id)),attrs:{\"train\":t}})})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[_c('v-line',{attrs:{\"config\":_vm.regularTrainPathConfig},on:{\"click\":_vm.onTrainPathClick}}),(_vm.selectedTrainPathEnabled)?[_c('v-line',{attrs:{\"config\":_vm.selectedTrainPathConfig},on:{\"click\":_vm.onSelectedTrainPathClick,\"dblclick\":_vm.onSelectedTrainPathDoubleClick,\"mousedown\":_vm.onSelectedTrainPathMouseDown}}),_vm._l((_vm.selectedTrainPathNodes),function(n,index){return _c('train-path-marker',{key:(\"train-path-\" + (_vm.train.id) + \"-marker-\" + index),attrs:{\"trainPathNode\":n},on:{\"click\":_vm.onMarkerClick,\"mousedown\":_vm.onMarkerMouseDown}})})]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[_c('v-rect',{attrs:{\"config\":_vm.rectConfig},on:{\"click\":function($event){return _vm.$emit('click', $event, _vm.trainPathNode)},\"mousemove\":_vm.onRectMouseMove,\"mousedown\":function($event){return _vm.$emit('mousedown', $event, _vm.trainPathNode)},\"dblclick\":_vm.onRectDoubleClick}}),(_vm.labelEnabled)?_c('v-text',{attrs:{\"config\":_vm.labelConfig}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport { getTimeText } from \"@/utils\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport TrainPathNode from \"@/data/TrainPathNode\";\n\n@Component\nexport default class TrainPathMarker extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() trainPathNode!: TrainPathNode;\n\n  get rectConfig(): unknown {\n    return {\n      x: this.trainPathNode.x - this.viewConfig.selectedTrainPathMarkerWidth * 0.5,\n      y: this.trainPathNode.y - this.viewConfig.selectedTrainPathMarkerWidth * 0.5,\n      width: this.viewConfig.selectedTrainPathMarkerWidth,\n      height: this.viewConfig.selectedTrainPathMarkerWidth,\n      fill: this.viewConfig.selectedTrainPathMarkerColor,\n    };\n  }\n\n  get labelEnabled(): boolean {\n    const n = this.trainPathNode;\n    const isLastStop = n.stop.id == n.train.stops[n.train.stops.length - 1].id;\n    return n.vSide == \"station\" &&\n      ((isLastStop && n.side == \"arr\") || (!isLastStop && (n.side == \"dep\" || n.stop.arrTime != n.stop.depTime)));\n  }\n\n  get labelConfig(): unknown {\n    const labelPosition = this.getLabelPosition();\n    return {\n      x: this.trainPathNode.x + labelPosition.x - this.viewConfig.markerLabelFontSize * 8,\n      y: this.trainPathNode.y + labelPosition.y - this.viewConfig.markerLabelLineHeight,\n      width: this.viewConfig.markerLabelFontSize * 8,\n      height: this.viewConfig.markerLabelLineHeight,\n      text: getTimeText(this.trainPathNode.time, this.viewState.pointerPreciseState != null),\n      fontSize: this.viewConfig.pointerLabelFontSize,\n      fontFamily: this.diagram.config.fontFamily,\n      fill: this.viewConfig.markerLabelColor,\n      align: \"right\",\n      verticalAlign: \"bottom\",\n      listening: false,\n    }\n  }\n\n  getLabelPosition(): { x: number, y: number } {\n    if (this.trainPathNode.side == \"arr\") {\n      const prevSE = this.trainPathNode.train.getPreviousStopEvent(this.trainPathNode.stop.id, \"arr\");\n      if (prevSE) {\n        const thisTime = this.trainPathNode.side  == \"arr\" ? this.trainPathNode.stop.arrTime : this.trainPathNode.stop.depTime;\n        const thisSta = this.diagram.stations[this.trainPathNode.stop.stationId];\n        const prevSta = this.diagram.stations[prevSE.stop.stationId];\n        const thisRelY = prevSta.mileage < thisSta.mileage ? thisSta.topRelY : thisSta.bottomRelY;\n        const prevRelY = prevSta.mileage < thisSta.mileage ? prevSta.bottomRelY : prevSta.topRelY;\n        const x = -this.viewConfig.markerLabelLineHeight *\n          ((thisTime - prevSE.time) * this.diagram.config.xScale) /\n          Math.abs(thisRelY - prevRelY);\n        return {\n          x: Math.max(x, -this.viewConfig.markerLabelMaxDistance),\n          y: prevSta.mileage < thisSta.mileage ? 0 : this.viewConfig.markerLabelLineHeight\n        };\n      }\n    }\n    const dir = this.diagram.getTrainPathDirection(this.trainPathNode.train.id, this.trainPathNode.stop.id, this.trainPathNode.side);\n    return {\n      x: 0,\n      y: dir < 0 || (dir == 0 && this.trainPathNode.side == \"arr\") ? 0 : this.viewConfig.markerLabelLineHeight\n    };\n  }\n\n  onRectMouseMove(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const event = konvaEvent.evt;\n    if (!this.viewState.pointerPreciseState && !this.viewState.pointerDragging && !this.viewState.drawingState) {\n      const station = this.diagram.stations[this.trainPathNode.stop.stationId];\n      const track = this.trainPathNode.vSide == \"track\" ? station.tracks.find(t => t.id == this.trainPathNode.stop.trackId) : undefined;\n      this.viewState.pointerTargetLine = { station, track };\n      this.viewState.pointerScreenX = event.screenX;\n      this.viewState.pointerTime = this.trainPathNode.time;\n      this.viewState.pointerY = this.trainPathNode.y;\n      this.viewState.pointerOnMarker = true;\n    }\n  }\n\n  onRectDoubleClick(): void {\n    if (this.viewState.editMode && !this.viewState.drawingState) {\n      const n = this.trainPathNode;\n      if (n.stop.id == n.train.stops[0].id && (n.side == \"arr\" || n.stop.arrTime == n.stop.depTime)) {\n        this.viewState.drawingState = { trainId: n.train.id, lastStopId: n.stop.id, direction: -1 };\n        this.viewState.trainSelections[n.train.id].stopRange = null;\n      } else if (n.stop.id == n.train.stops[n.train.stops.length - 1].id && (n.side == \"dep\" || n.stop.arrTime == n.stop.depTime)) {\n        this.viewState.drawingState = { trainId: n.train.id, lastStopId: n.stop.id, direction: 1 };\n        this.viewState.trainSelections[n.train.id].stopRange = null;\n      }\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathMarker.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathMarker.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathMarker.vue?vue&type=template&id=631b1164&scoped=true&\"\nimport script from \"./TrainPathMarker.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathMarker.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"631b1164\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport Stop from \"@/data/Stop\";\nimport TrainPathNode from \"@/data/TrainPathNode\";\nimport Train, { TrainStopRange, TrainStopEvent } from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport TrainPathMarker from \"./TrainPathMarker.vue\";\n\n@Component({\n  components: {\n    TrainPathMarker\n  },\n})\nexport default class TrainPathGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() train!: Train;\n\n  dragState: { \n    t0: number, \n    sx0: number, \n    y0: number,\n    minTimeShift: number,\n    maxTimeShift: number,\n    targetStopEvents: TrainStopEvent[] | null\n  } | null = null;\n\n  get regularTrainPathConfig(): unknown {\n    return {\n      points: this.regularTrainPathNodes.map(n => [n.x, n.y]).flat(),\n      stroke: this.diagram.config.trainPathColor,\n      opacity: Object.keys(this.viewState.trainSelections).length > 0 ? this.viewConfig.unselectedTrainPathOpacity : 1,\n      strokeWidth: this.diagram.config.trainPathWidth,\n      hitStrokeWidth: Math.max(this.diagram.config.trainPathWidth, this.viewConfig.minHitWidth * 2),\n    }\n  }\n\n  get regularTrainPathNodes(): TrainPathNode[] {\n    const result: TrainPathNode[] = [];\n    for (const n of this.trainPathNodes) {\n      const time = n.time + (this.selectedTrainPathEnabled && this.viewState.trainPathDragState && !this.viewState.controlKeyPressed ? this.viewState.trainPathDragState.timeShift : 0);\n      result.push({\n        train: n.train, stop: n.stop, side: n.side, vSide: n.vSide,\n        time, x: this.diagram.getXByTime(time),\n        y: n.y, selected: n.selected\n      });\n    }\n    return result;\n  }\n\n  get selectedTrainPathEnabled(): boolean {\n    return this.viewState.trainSelections[this.train.id] != null;\n  }\n\n  get selectedTrainPathConfig(): unknown {\n    return {\n      points: this.selectedTrainPathNodes.flatMap(n => [n.x, n.y]),\n      stroke: this.viewConfig.selectedTrainPathColor,\n      strokeWidth: this.diagram.config.trainPathWidth * this.viewConfig.selectedTrainPathWidthScale,\n      hitStrokeWidth: Math.max(this.diagram.config.trainPathWidth * this.viewConfig.selectedTrainPathWidthScale, this.viewConfig.minHitWidth * 2)\n    };\n  }\n\n  get selectedTrainPathNodes():TrainPathNode[] {\n    const result: TrainPathNode[] = [];\n    for (const n of this.trainPathNodes) {\n      if (n.selected) {\n        const time = n.time + (this.viewState.trainPathDragState?.timeShift ?? 0);\n        result.push({\n          train: n.train, stop: n.stop, side: n.side, vSide: n.vSide,\n          time, x: this.diagram.getXByTime(time),\n          y: n.y, selected: n.selected\n        });\n      }\n    }\n    return result;\n  }\n\n  get trainPathNodes(): TrainPathNode[] {\n    const result: TrainPathNode[] = [];\n    const stopEvents = this.train.getStopEvents();\n    const selectedStopRange = this.viewState.trainSelections[this.train.id]?.stopRange;\n    let inRange = selectedStopRange === null;\n    for (let i = 0; i < stopEvents.length; i++) {\n      const se = stopEvents[i];\n      const station = this.diagram.stations[se.stop.stationId];\n      if (selectedStopRange && selectedStopRange.fromStopId == se.stop.id && selectedStopRange.fromStopSide == se.side) {\n        inRange = true;\n      }\n      const time = se.time;\n      const x = this.diagram.getXByTime(time);\n      if (station.expanded) {\n        if (se.side == \"arr\" && i > 0) {\n          const prevSE = stopEvents[i - 1];\n          if (prevSE.stop.stationId != se.stop.stationId) {\n            const prevStation = this.diagram.stations[prevSE.stop.stationId];\n            result.push({ \n              train: this.train, stop: se.stop, side: \"arr\", vSide: \"station\", \n              time, x, \n              y: this.diagram.getYByRelY(prevStation.mileage < station.mileage ? station.topRelY : station.bottomRelY),\n              selected: inRange,\n            });\n          }\n        }\n        result.push({\n          train: this.train, stop: se.stop, side: se.side, vSide: \"track\", \n          time, x,\n          y: this.diagram.getYByRelY(station.tracks.find(t => t.id == se.stop.trackId)?.relY ?? 0),\n          selected: inRange,\n        });\n        if (se.side == \"dep\" && i < stopEvents.length - 1) {\n          const nextSE = stopEvents[i + 1];\n          if (nextSE.stop.stationId != se.stop.stationId) {\n            const nextStation = this.diagram.stations[nextSE.stop.stationId];\n            result.push({\n              train: this.train, stop: se.stop, side: \"dep\", vSide: \"station\",\n              time: time, x,\n              y: this.diagram.getYByRelY(nextStation.mileage > station.mileage ? station.bottomRelY : station.topRelY),\n              selected: inRange,\n            });\n          }        \n        }\n      } else {\n        result.push({ \n          train: this.train, stop: se.stop, side: se.side, vSide: \"station\", \n          time, x, \n          y: this.diagram.getYByRelY(station.topRelY),\n          selected: inRange,\n        });        \n      }\n      if (selectedStopRange && selectedStopRange.toStopId == se.stop.id && selectedStopRange.toStopSide == se.side) {\n        inRange = false;\n      }\n    }\n    return result;\n  }\n\n  onTrainPathClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const clickedStopRange = this.getClickedStopRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    this.changeTrainSelections(konvaEvent, clickedStopRange, false);\n  }\n\n  onSelectedTrainPathClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const clickedStopRange = this.getClickedStopRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    this.changeTrainSelections(konvaEvent, clickedStopRange, true);\n  }\n\n  onMarkerClick(konvaEvent: KonvaEventObject<MouseEvent>, trainPathNode: TrainPathNode): void {\n    const clickedStopRange = {\n      fromStopId: trainPathNode.stop.id,\n      fromStopSide: trainPathNode.stop.arrTime != trainPathNode.stop.depTime ? trainPathNode.side : \"arr\",\n      toStopId: trainPathNode.stop.id,\n      toStopSide: trainPathNode.stop.arrTime != trainPathNode.stop.depTime ? trainPathNode.side : \"dep\"\n    };\n    this.changeTrainSelections(konvaEvent, clickedStopRange, true);\n  }\n\n  changeTrainSelections(konvaEvent: KonvaEventObject<MouseEvent>, clickedStopRange: TrainStopRange, clickSelected: boolean): void {\n    if (!this.viewState.pointerDragging && !this.viewState.drawingState) {\n      const sel = this.viewState.trainSelections[this.train.id];\n\n      // Remove other trains if ctrl not pressed\n      if (!konvaEvent.evt.ctrlKey) {\n        this.viewState.trainSelections = sel ? { [this.train.id]: sel } : {};\n      }\n\n      if (!sel) {\n        this.$set(this.viewState.trainSelections, this.train.id, { trainId: this.train.id, stopRange: null });\n      } else {\n        const selectedStopRange = sel.stopRange;\n        if (!selectedStopRange) {\n          sel.stopRange = clickedStopRange;\n        } else if (!konvaEvent.evt.ctrlKey) {\n          if (!clickSelected) {\n            sel.stopRange = null;\n          }\n        } else {\n          const selectedFromStopIndex = this.train.stops.findIndex(s => s.id == selectedStopRange.fromStopId);\n          const selectedToStopIndex = this.train.stops.findIndex(s => s.id == selectedStopRange.toStopId);\n          const clickedFromStopIndex = this.train.stops.findIndex(s => s.id == clickedStopRange.fromStopId);\n          const clickedToStopIndex = this.train.stops.findIndex(s => s.id == clickedStopRange.toStopId);\n          if (clickedFromStopIndex < selectedFromStopIndex || (clickedFromStopIndex == selectedFromStopIndex && clickedStopRange.fromStopSide == \"arr\")) {\n            selectedStopRange.fromStopId = clickedStopRange.fromStopId;\n            selectedStopRange.fromStopSide = clickedStopRange.fromStopSide;\n          } else if (clickedToStopIndex > selectedToStopIndex || (clickedToStopIndex == selectedToStopIndex && clickedStopRange.toStopSide == \"dep\")) {\n            selectedStopRange.toStopId = clickedStopRange.toStopId;\n            selectedStopRange.toStopSide = clickedStopRange.toStopSide;\n          } else {\n            this.$delete(this.viewState.trainSelections, this.train.id);\n          }\n        }\n      }\n    }\n  }\n\n  getClickedStopRange(x: number, y: number): TrainStopRange {\n    const targetTime = this.diagram.getTimeByX(x);\n    for (let i = 0; i < this.train.stops.length; ++i) {\n      const stop = this.train.stops[i];\n      const station = this.diagram.stations[stop.stationId];\n\n      if (y > this.diagram.getYByRelY(station.topRelY) - this.viewConfig.minHitWidth && y < this.diagram.getYByRelY(station.bottomRelY) + this.viewConfig.minHitWidth) {\n        return { fromStopId: stop.id, fromStopSide: \"arr\", toStopId: stop.id, toStopSide: \"dep\" };\n      }\n      if (i > 0 && targetTime < stop.arrTime) {\n        const prevStop = this.train.stops[i - 1];\n        return { \n          fromStopId: prevStop.id,\n          fromStopSide: prevStop.arrTime == prevStop.depTime ? \"arr\" : \"dep\",\n          toStopId: stop.id,\n          toStopSide: stop.arrTime == stop.depTime ? \"dep\" : \"arr\"\n        };\n      }\n    }\n    const lastStop = this.train.stops[this.train.stops.length - 1];\n    return { fromStopId: lastStop.id, fromStopSide: \"arr\", toStopId: lastStop.id, toStopSide: \"dep\" };\n  }\n\n  onSelectedTrainPathDoubleClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewState.editMode && !this.viewState.drawingState) {\n      const targetTime = this.viewState.pointerTime;\n      const nearestSta = this.getNearestStation(konvaEvent.evt.clientY);\n      const nearestStop = this.getNearestStop(targetTime);\n      if (nearestSta.id != nearestStop.stationId) {\n        const index = this.train.stops.findIndex(s => s.arrTime > targetTime);\n        const id = this.diagram.genId();\n        this.train.stops.splice(index, 0, new Stop(\n          id,\n          nearestSta.id,\n          this.diagram.stations[nearestSta.id].tracks[0].id,\n          targetTime,\n          targetTime\n        ));\n\n        this.viewState.trainSelections = { [this.train.id]: {\n          trainId: this.train.id,\n          stopRange: { fromStopId: id, fromStopSide: \"arr\", toStopId: id, toStopSide: \"dep\" }\n        } };\n      } else if (nearestStop.arrTime == nearestStop.depTime) {\n        if (targetTime < nearestStop.arrTime) {\n          nearestStop.arrTime = targetTime;\n          this.viewState.trainSelections = { [this.train.id]: {\n            trainId: this.train.id,\n            stopRange: { fromStopId: nearestStop.id, fromStopSide: \"arr\", toStopId: nearestStop.id, toStopSide: \"arr\" }\n          } };\n        } else if (targetTime > nearestStop.depTime) {\n          nearestStop.depTime = targetTime;\n          this.viewState.trainSelections = { [ this.train.id]: {\n            trainId: this.train.id,\n            stopRange: { fromStopId: nearestStop.id, fromStopSide: \"dep\", toStopId: nearestStop.id, toStopSide: \"dep\" }\n          } };\n        }\n      }\n    }\n  }\n\n  getNearestStation(y: number): Station {\n    const stations = this.diagram.getStationsInMileageOrder();\n    const relY = this.diagram.getRelYByY(y);\n    let minSta = stations[0];\n    let minDist = Math.abs(relY - minSta.bottomRelY);\n    for (const s of stations) {\n      if (Math.abs(relY - s.topRelY) < minDist) {\n        minSta = s;\n        minDist = Math.abs(relY - s.topRelY);\n      }\n      if (Math.abs(relY - s.bottomRelY) < minDist) {\n        minSta = s;\n        minDist = Math.abs(relY - s.bottomRelY);\n      }\n    }\n    return minSta;\n  }\n\n  getNearestStop(time: number): Stop {\n    let minStop = this.train.stops[0];\n    let minDist = Math.abs(time - minStop.arrTime);\n    for (const s of this.train.stops) {\n      if (Math.abs(time - s.arrTime) < minDist) {\n        minStop = s;\n        minDist = Math.abs(time - s.arrTime);\n      }\n      if (Math.abs(time - s.depTime) < minDist) {\n        minStop = s;\n        minDist = Math.abs(time - s.depTime);\n      }\n    }\n    return minStop;\n  }\n\n  onSelectedTrainPathMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (!this.viewState.editMode) {\n      return;\n    }\n\n    let minTimeShift = -86400;\n    let maxTimeShift = 86400;\n    for (const sel of Object.values(this.viewState.trainSelections)) {\n      const stopRange = sel.stopRange;\n      if (stopRange) {\n        const train = this.diagram.trains[sel.trainId];\n        const fromSE = train.getStopEvent(stopRange.fromStopId, stopRange.fromStopSide);\n        const prevFromSE = fromSE ? train.getPreviousStopEvent(fromSE.stop.id, fromSE.side) : undefined;\n        if (fromSE && prevFromSE) {\n          minTimeShift = Math.max(minTimeShift, prevFromSE.time - fromSE.time);\n        }\n        const toSE = train.getStopEvent(stopRange.toStopId, stopRange.toStopSide);\n        const nextToSE = toSE ? train.getNextStopEvent(toSE.stop.id, toSE.side) : undefined;  \n        if (toSE && nextToSE) {\n          maxTimeShift = Math.min(maxTimeShift, nextToSE.time - toSE.time);\n        }\n      }\n    }\n\n    const firstNode = this.selectedTrainPathNodes[0];\n    this.dragState = { \n      t0: firstNode.time, \n      sx0: konvaEvent.evt.screenX, \n      y0: firstNode.y,\n      minTimeShift: minTimeShift,\n      maxTimeShift: maxTimeShift,\n      targetStopEvents: null\n    };\n    this.viewState.trainPathDragState = {\n      timeShift: 0\n    };\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n  }\n\n  onMarkerMouseDown(konvaEvent: KonvaEventObject<MouseEvent>, node: TrainPathNode): void {\n    if (!this.viewState.editMode) {\n      return;\n    }\n    \n    const prevSE = node.side == \"dep\" && node.stop.arrTime == node.stop.depTime ? \n      this.train.getPreviousStopEvent(node.stop.id, \"arr\") :\n      this.train.getPreviousStopEvent(node.stop.id, node.side);\n    const nextSE = node.side == \"arr\" && node.stop.arrTime == node.stop.depTime ?\n       this.train.getNextStopEvent(node.stop.id, \"dep\") :\n       this.train.getNextStopEvent(node.stop.id, node.side);\n    \n    this.dragState = {\n      t0: node.time,\n      sx0: konvaEvent.evt.screenX,\n      y0: node.y,\n      minTimeShift: prevSE ? prevSE.time - node.time : -86400,\n      maxTimeShift: nextSE ? nextSE.time - node.time : 86400,\n      targetStopEvents: node.stop.arrTime == node.stop.depTime ?\n        [ { stop: node.stop, side: \"arr\", time: node.stop.arrTime }, { stop: node.stop, side: \"dep\", time: node.stop.depTime } ] :\n        [ node ]\n    };\n    this.viewState.trainPathDragState = {\n      timeShift: 0\n    };\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState && this.viewState.trainPathDragState) {\n      if (!this.viewState.pointerDragging) {\n        this.viewState.pointerDragging = true;\n        this.viewState.pointerY = this.dragState.y0;\n      }\n      if (!this.viewState.pointerPreciseState) {\n        this.viewState.pointerTime = this.dragState.t0 + Math.floor((event.screenX - this.dragState.sx0) / this.diagram.config.xScale / 60) * 60;\n      }\n      this.viewState.trainPathDragState.timeShift = \n        Math.min(this.dragState.maxTimeShift, Math.max(this.dragState.minTimeShift, this.viewState.pointerTime - this.dragState.t0));\n    }\n  }\n\n  onWindowMouseUp(): void {\n    if (this.dragState && this.viewState.trainPathDragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      if (!this.viewState.controlKeyPressed) {\n        const targets = \n          this.dragState.targetStopEvents ??\n          Object.values(this.viewState.trainSelections).flatMap(sel => this.diagram.trains[sel.trainId].getStopEvents(sel.stopRange));\n        for (const se of targets) {\n          const newTime = se.time + this.viewState.trainPathDragState.timeShift;\n          if (se.side == \"arr\") {\n            se.stop.arrTime = newTime;\n          } else {\n            se.stop.depTime = newTime;\n          }\n        }\n      } else {\n        for (const sel of Object.values(this.viewState.trainSelections)) {\n          const targetTrain = this.diagram.trains[sel.trainId];\n          const newStops: Stop[] = [];\n          for (const se of targetTrain.getStopEvents(sel.stopRange)) {\n            const time = se.time + this.viewState.trainPathDragState.timeShift;\n            if (newStops.length > 0 && newStops[newStops.length - 1].stationId == se.stop.stationId) {\n              newStops[newStops.length - 1].depTime = time;\n            } else {\n              const newStop = Stop.fromJSON({ \n                id: this.diagram.genId(), \n                stationId: se.stop.stationId, \n                trackId: se.stop.trackId, \n                arrTime: time, \n                depTime: time\n              });\n              newStops.push(newStop);\n            }\n          }\n          const newTrain = Train.fromJSON({\n            id: this.diagram.genId(),\n            name: \"\",\n            stops: newStops\n          });\n          this.$set(this.diagram.trains, newTrain.id, newTrain);\n          this.$delete(this.viewState.trainSelections, sel.trainId);\n          this.$set(this.viewState.trainSelections, newTrain.id, { trainId: newTrain.id, stopRange: null });\n        }\n      }\n      this.viewState.pointerDragging = false;\n      this.viewState.trainPathDragState = null;\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathGroup.vue?vue&type=template&id=db26ad56&scoped=true&\"\nimport script from \"./TrainPathGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"db26ad56\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewState from \"@/data/ViewState\";\nimport TrainPathGroup from \"./TrainPathGroup.vue\";\n\n@Component({\n  components: {\n    TrainPathGroup\n  },\n})\nexport default class BackLayer extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  // mounted(): void {\n  //   const hitCanvas = (this.$refs.trainPathLayer as any).getNode().hitCanvas._canvas;\n  //   document.body.appendChild(hitCanvas);\n  // }\n\n  get layerConfig(): unknown {\n    return {\n      clip: {\n        x: this.diagram.config.leftPaneWidth,\n        y: this.diagram.config.topPaneHeight,\n        width: this.viewState.viewWidth - this.diagram.config.leftPaneWidth,\n        height: this.viewState.viewHeight - this.diagram.config.topPaneHeight,\n      }\n    };\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathLayer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathLayer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathLayer.vue?vue&type=template&id=2f6cdf07&scoped=true&\"\nimport script from \"./TrainPathLayer.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathLayer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2f6cdf07\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport Stop from \"@/data/Stop\";\nimport Track from \"@/data/Track\";\nimport Train from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport BackLayer from \"./BackLayer.vue\";\nimport Pointer from \"./Pointer.vue\";\nimport TrainPathLayer from \"./TrainPathLayer.vue\";\n\n@Component({\n  components: {\n    BackLayer, Pointer, TrainPathLayer\n  },\n})\nexport default class Stage extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  stageDragState: { scrollX0: number, scrollY0: number, screenX0: number, screenY0: number, dragged: boolean } | null = null;\n\n  get stageConfig(): unknown {\n    return {\n      width: this.viewState.viewWidth,\n      height: this.viewState.viewHeight\n    };\n  }\n\n  get stationsInMileageOrder(): Station[] {\n    return this.diagram.getStationsInMileageOrder();\n  }\n\n  mounted(): void {\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    document.addEventListener(\"keydown\", this.onKeyDown);\n    document.addEventListener(\"keyup\", this.onKeyUp);\n  }\n\n  unmounted(): void {\n    window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n    document.removeEventListener(\"keydown\", this.onKeyDown);\n    document.removeEventListener(\"keyup\", this.onKeyUp);\n  }\n\n  onStageMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget) {\n      const event = konvaEvent.evt;\n      this.stageDragState = {\n        scrollX0: this.diagram.config.scrollX,\n        scrollY0: this.diagram.config.scrollY,\n        screenX0: event.screenX,\n        screenY0: event.screenY,\n        dragged: false,\n      };\n    }\n  }\n\n  onStageMouseMove(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    this.viewState.pointerOnMarker = false;\n\n    const event = konvaEvent.evt;\n    this.viewState.pointerScreenX = event.screenX;\n    if (this.viewState.pointerPreciseState) {\n      const dUnit = Math.round((event.screenX - this.viewState.pointerPreciseState.sx0) / this.viewConfig.pointerPrecisePixelPerTimeUnit);\n      this.viewState.pointerTime = dUnit * this.diagram.config.minimumTimeUnit + this.viewState.pointerPreciseState.t0;\n    } else if (!this.viewState.pointerDragging) {\n      this.viewState.pointerTime = Math.round(this.diagram.getTimeByX(event.clientX) / 60) * 60;\n      if (event.clientX >= this.diagram.config.leftPaneWidth) {\n        const pointerTargetLine = this.findPointerTargetLine(event.clientY);\n        if (pointerTargetLine) {\n          this.viewState.pointerTargetLine = pointerTargetLine ?? null;\n          this.viewState.pointerY = this.diagram.getYByRelY(pointerTargetLine.track?.relY ?? pointerTargetLine.station.topRelY);\n        } else {\n          this.viewState.pointerTargetLine = null;\n        }\n      } else {\n        this.viewState.pointerTargetLine = null;\n      }\n    }\n    if (this.viewState.drawingState) {\n      const train = this.diagram.trains[this.viewState.drawingState.trainId];\n      const lastStop = train.stops.find(s => s.id == this.viewState.drawingState?.lastStopId);\n      if (lastStop) {\n        if (this.viewState.drawingState.direction > 0) {\n          this.viewState.pointerTime = Math.max(this.viewState.pointerTime, lastStop.depTime);\n        } else if (this.viewState.drawingState.direction < 0) {\n          this.viewState.pointerTime = Math.min(this.viewState.pointerTime, lastStop.arrTime);\n        }\n      }\n    }\n  }\n\n  findPointerTargetLine(y: number): { station: Station, track?: Track } | undefined {\n    const pointedStation = this.stationsInMileageOrder.find(s => \n      Math.min(Math.abs(this.diagram.getYByRelY(s.topRelY) - y), Math.abs(this.diagram.getYByRelY(s.bottomRelY) - y)) < \n        Math.max(this.diagram.config.stationLineWidth * 0.5, this.viewConfig.minHitWidth)\n    );\n    if (pointedStation) {\n      return { station: pointedStation };\n    }\n\n    const station = this.stationsInMileageOrder.find(s => \n      this.diagram.getYByRelY(s.topRelY) + this.diagram.config.trackLineSpan - Math.max(this.diagram.config.trackLineWidth * 0.5, this.viewConfig.minHitWidth) < y &&\n      this.diagram.getYByRelY(s.bottomRelY) - this.diagram.config.trackLineSpan + Math.max(this.diagram.config.trackLineWidth * 0.5, this.viewConfig.minHitWidth) > y\n    );\n    if (station) {\n      const pointedTrack = station.tracks.find(t => Math.abs(this.diagram.getYByRelY(t.relY) - y) < Math.max(this.diagram.config.trackLineWidth * 0.5, this.viewConfig.minHitWidth));\n      if (pointedTrack) {\n        return { station, track: pointedTrack };\n      }\n    }\n  }\n\n  onStageClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const drawingState = this.viewState.drawingState;\n    if (drawingState) {\n      const train = this.diagram.trains[drawingState.trainId];\n      if (this.viewState.pointerTargetLine) {\n        const lastStop = train.stops.find(s => s.id == drawingState.lastStopId);\n        if (lastStop) {\n          if (drawingState.direction == 0) {\n            drawingState.direction = Math.sign(this.viewState.pointerTime - lastStop.arrTime);\n          }\n          if (this.viewState.pointerTargetLine.station.id == lastStop.stationId) {\n            if (drawingState.direction > 0) {\n              lastStop.depTime = this.viewState.pointerTime;\n            } else {\n              lastStop.arrTime = this.viewState.pointerTime;\n            }\n          } else {\n            const stop = Stop.fromJSON({ \n              id: this.diagram.genId(), \n              stationId: this.viewState.pointerTargetLine.station.id,\n              trackId: this.viewState.pointerTargetLine.track?.id ?? this.viewState.pointerTargetLine.station.tracks[0].id,\n              arrTime: this.viewState.pointerTime,\n              depTime: this.viewState.pointerTime\n            });\n            if (drawingState.direction > 0) {\n              train.stops.push(stop);\n            } else {\n              train.stops.splice(0, 0, stop);\n            }\n            drawingState.lastStopId = stop.id;\n          }\n        }\n      } else {\n        if (train.stops.length == 0) {\n          this.$delete(this.diagram.trains, train.id);\n        }\n        this.viewState.drawingState = null;\n      }\n    }\n\n    if (konvaEvent.target == konvaEvent.currentTarget && !konvaEvent.evt.ctrlKey && !this.stageDragState?.dragged && !this.viewState.pointerDragging && !this.viewState.drawingState) {\n      this.viewState.trainSelections = {};\n    }\n  }\n\n  onStageDoubleClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget && this.viewState.editMode) {\n      if (konvaEvent.evt.clientX >= this.diagram.config.leftPaneWidth) {\n        const targetLine = this.viewState.pointerTargetLine;\n        if (targetLine && (targetLine.track || !targetLine.station.expanded)) {\n          const track = targetLine.track ?? targetLine.station.tracks[0];\n          const stop = Stop.fromJSON({\n            id: this.diagram.genId(),\n            stationId: targetLine.station.id,\n            trackId: track.id,\n            arrTime: this.viewState.pointerTime,\n            depTime: this.viewState.pointerTime,\n          });\n          const train = Train.fromJSON({\n            id: this.diagram.genId(),\n            name: \"\",\n            stops: [ stop ]\n          });\n          this.$set(this.diagram.trains, train.id, train);\n          this.viewState.trainSelections = { [train.id]: { trainId: train.id, stopRange: null } };\n          this.viewState.drawingState = { trainId: train.id, lastStopId: stop.id, direction: 0 };\n        }\n      } else {\n        const relY = this.diagram.getRelYByY(konvaEvent.evt.clientY);\n        const prevSta = this.stationsInMileageOrder.reverse().find(s => s.topRelY < relY);\n        const mileage = prevSta ?\n          (relY - prevSta.bottomRelY) / this.diagram.config.yScale + prevSta.mileage :\n          relY / this.diagram.config.yScale;\n        const station = Station.fromJSON({\n          id: this.diagram.genId(),\n          name: \"\",\n          mileage,\n          tracks: [ { id: this.diagram.genId(), name: \"\" } ],\n        });\n        this.$set(this.diagram.stations, station.id, station);\n        this.$emit(\"updateY\");\n\n        this.viewState.stationNameInputTarget = { stationId: station.id };\n        this.$emit(\"stationNameInputStart\");\n      }\n    }\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.stageDragState) {\n      this.stageDragState.dragged = true;\n      this.diagram.config.scrollX = this.stageDragState.scrollX0 - (event.screenX - this.stageDragState.screenX0);\n      this.diagram.config.scrollY = \n        Math.max(0, Math.min(this.viewState.maxRelY + this.diagram.config.topPaneHeight - this.viewState.viewHeight, \n          this.stageDragState.scrollY0 - (event.screenY - this.stageDragState.screenY0)));\n    }\n  }\n\n  onWindowMouseUp(event: MouseEvent): void {\n    if (this.stageDragState) {\n      this.onWindowMouseMove(event);\n      this.stageDragState = null;\n    }\n  }\n\n  onStageMouseWheel(konvaEvent: KonvaEventObject<WheelEvent>): void {\n    const f = Math.pow(2, -konvaEvent.evt.deltaY * this.viewConfig.wheelScale * 0.001);\n    this.diagram.config.scrollX += (f - 1) * (konvaEvent.evt.clientX - this.diagram.config.leftPaneWidth + this.diagram.config.scrollX);\n    this.diagram.config.scrollY = \n      Math.max(0, Math.min(this.viewState.maxRelY + this.diagram.config.topPaneHeight - this.viewState.viewHeight,\n      this.diagram.config.scrollY + (f - 1) * (konvaEvent.evt.clientY - this.diagram.config.topPaneHeight + this.diagram.config.scrollY)));\n    this.diagram.config.xScale *= f;\n    this.diagram.config.yScale *= f;\n    this.$emit(\"updateY\");\n  }\n\n  onKeyDown(event: KeyboardEvent): void {\n    if (!event.repeat) {\n      if (event.key == \"Shift\") {\n        this.viewState.pointerPreciseState = {\n          sx0: this.viewState.pointerScreenX,\n          t0: this.viewState.pointerTime\n        };\n      }\n      if (event.key == \"Control\") {\n        this.viewState.controlKeyPressed = true;\n      }\n      if (event.key == \"Delete\") {\n        let notEnd = false;\n        for (const sel of Object.values(this.viewState.trainSelections)) {\n          const stopRange = sel.stopRange;\n          if (!stopRange) {\n            this.$delete(this.diagram.trains, sel.trainId);\n            this.$delete(this.viewState.trainSelections, sel.trainId);\n          } else {\n            const train = this.diagram.trains[sel.trainId];\n            if (stopRange.fromStopId == train.stops[0].id && stopRange.fromStopSide == \"arr\") {\n              if (stopRange.toStopId == stopRange.fromStopId && stopRange.toStopSide == \"arr\") {\n                train.stops[0].arrTime = train.stops[0].depTime;\n              } else if (stopRange.toStopId == stopRange.fromStopId && train.stops[0].arrTime == train.stops[0].depTime) {\n                train.stops.splice(0, 1);\n              } else {\n                const toStopIndex = train.stops.findIndex(s => s.id == stopRange.toStopId);\n                train.stops.splice(0, toStopIndex);\n                if (stopRange.toStopSide == \"dep\") {\n                  train.stops[0].arrTime = train.stops[0].depTime;\n                }\n              }\n              if (train.stops.length == 1 && train.stops[0].arrTime == train.stops[0].depTime) {\n                this.$delete(this.diagram.trains, sel.trainId);\n              }\n              this.$delete(this.viewState.trainSelections, sel.trainId);\n            } else if (stopRange.toStopId == train.stops[train.stops.length - 1].id && stopRange.toStopSide == \"dep\") {\n              const lastStop = train.stops[train.stops.length - 1];\n              if (stopRange.fromStopId == stopRange.toStopId && stopRange.fromStopSide == \"dep\") {\n                lastStop.depTime = lastStop.arrTime;\n              } else if (stopRange.fromStopId == stopRange.toStopId && lastStop.arrTime == lastStop.depTime) {\n                train.stops.splice(train.stops.length - 1, 1);\n              } else {\n                const fromStopIndex = train.stops.findIndex(s => s.id == stopRange.fromStopId);\n                train.stops.splice(fromStopIndex + 1, train.stops.length - fromStopIndex - 1);\n                if (stopRange.fromStopSide == \"arr\") {\n                  train.stops[fromStopIndex].depTime = train.stops[fromStopIndex].arrTime;\n                }\n              }\n              if (train.stops.length == 1 && train.stops[0].arrTime == train.stops[0].depTime) {\n                this.$delete(this.diagram.trains, sel.trainId);\n              }\n              this.$delete(this.viewState.trainSelections, sel.trainId);\n            } else {\n              notEnd = true;\n            }\n          }\n        }\n        if (notEnd) {\n          // this.$buefy.notification.open({ message: this.$t(\"message.tryedToDeleteMiddleOfTrainPath\").toString(), type: \"is-danger\" });\n        }\n      }\n    }\n  }\n\n  onKeyUp(event: KeyboardEvent): void {\n    if (event.key == \"Shift\") {\n      this.viewState.pointerPreciseState = null;\n    }\n    if (event.key == \"Control\") {\n      this.viewState.controlKeyPressed = false;\n    }\n  }\n\n  onContextMenu(konvaEvent: KonvaEventObject<MouseEvent>): boolean {\n    konvaEvent.evt.preventDefault();\n    return false;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Stage.vue?vue&type=template&id=0ef88590&scoped=true&\"\nimport script from \"./Stage.vue?vue&type=script&lang=ts&\"\nexport * from \"./Stage.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0ef88590\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isBottomLineIntersectingPlotPane)?_c('b-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.editMode && _vm.station.expanded),expression:\"viewState.editMode && station.expanded\"}],style:(_vm.style),attrs:{\"icon\":\"plus\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport Track from \"@/data/Track\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationAddTrackButton extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() station!: Station;\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelRightMargin}px`,\n      top: `${this.diagram.getYByRelY(this.station.bottomRelY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isBottomLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.bottomRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.isInputEnabled) {\n      const newTrack = Track.fromJSON({\n        id: this.diagram.genId(),\n        name: \"\"\n      });\n      this.station.tracks.push(newTrack);\n      this.$emit(\"updateY\");\n\n      this.viewState.trackNameInputTarget = { stationId: this.station.id, trackId: newTrack.id };\n      this.$emit(\"trackNameInputStart\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationAddTrackButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationAddTrackButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationAddTrackButton.vue?vue&type=template&id=096d95ea&scoped=true&\"\nimport script from \"./StationAddTrackButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationAddTrackButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"096d95ea\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isBottomLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":_vm.icon,\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationExpandButton extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() station!: Station;\n\n  get icon(): string {\n    return this.station.expanded ? \"chevron-up\" : \"chevron-down\";\n  }\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.stationLabelLeftMargin}px`,\n      top: `${this.diagram.getYByRelY(this.station.bottomRelY)}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isBottomLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.bottomRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.isInputEnabled) {\n      this.$set(this.station, \"expanded\", !this.station.expanded);\n      this.$emit(\"updateY\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationExpandButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationExpandButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationExpandButton.vue?vue&type=template&id=1884b36c&scoped=true&\"\nimport script from \"./StationExpandButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationExpandButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1884b36c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.targetStation.name),expression:\"targetStation.name\"},{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.stationNameInputTarget),expression:\"viewState.stationNameInputTarget\"}],style:(_vm.style),domProps:{\"value\":(_vm.targetStation.name)},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onComplete($event)},\"blur\":_vm.onComplete,\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.targetStation, \"name\", $event.target.value)}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationNameInput extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  get targetStation(): Station | Record<string, never> {\n    return this.viewState.stationNameInputTarget ? this.diagram.stations[this.viewState.stationNameInputTarget.stationId] : {};\n  }\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.stationLabelLeftMargin}px`,\n      top: `${this.diagram.getYByRelY(this.targetStation.topRelY) - this.diagram.config.stationLabelFontSize - 4}px`,\n      width: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.stationLabelRightMargin}px`,\n      height: `${this.diagram.config.stationLabelFontSize + 4}px`,\n      paddingTop: \"2px\",\n      lineHeight: `${this.diagram.config.stationLabelFontSize}px`,\n      border: \"none\",\n      fontSize: `${this.diagram.config.stationLabelFontSize}px`,\n    };\n  }\n\n  onComplete(): void {\n    this.viewState.stationNameInputTarget = null;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationNameInput.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationNameInput.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationNameInput.vue?vue&type=template&id=09e5daf8&scoped=true&\"\nimport script from \"./StationNameInput.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationNameInput.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"09e5daf8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isTopLineIntersectingPlotPane)?_c('b-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.editMode),expression:\"viewState.editMode\"}],style:(_vm.style),attrs:{\"icon\":\"close\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationRemoveButton extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() station!: Station;\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelRightMargin}px`,\n      top: `${this.diagram.getYByRelY(this.station.topRelY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isTopLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.topRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.topRelY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.isInputEnabled) {\n      const refered = Object.values(this.diagram.trains).some(t => t.stops.some(s => s.stationId == this.station.id));\n      if (refered) {\n        this.$buefy.dialog.confirm({\n          message: this.$t(\"message.confirmRemoveStationRefered\").toString(),\n          onConfirm: () => {\n            Object.values(this.diagram.trains).forEach(t => {\n              t.stops.map((s, i) => s.stationId == this.station.id ? i : -1).filter(i => i >= 0).reverse()\n                .forEach(i => t.stops.splice(i, 1))\n            });\n            this.$delete(this.diagram.stations, this.station.id);\n            this.$emit(\"updateY\");\n          },\n        });\n      } else {\n        this.$delete(this.diagram.stations, this.station.id);\n        this.$emit(\"updateY\");\n      }\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationRemoveButton.vue?vue&type=template&id=4f1fe388&scoped=true&\"\nimport script from \"./StationRemoveButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationRemoveButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4f1fe388\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isLineIntersectingPlotPane)?_c('b-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.editMode && _vm.station.expanded && Object.values(_vm.station.tracks).length > 1),expression:\"viewState.editMode && station.expanded && Object.values(station.tracks).length > 1\"}],style:(_vm.style),attrs:{\"icon\":\"close\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport Track from \"@/data/Track\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationRemoveTrackButton extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() station!: Station;\n  @Prop() track!: Track;\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelRightMargin}px`,\n      top: `${this.diagram.getYByRelY(this.track.relY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.track.relY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.track.relY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.isInputEnabled) {\n      const refered = Object.values(this.diagram.trains).some(t => t.stops.some(s => s.stationId == this.station.id && s.trackId == this.track.id));\n      if (refered) {\n        this.$buefy.dialog.confirm({\n          message: this.$t(\"message.confirmRemoveTrackRefered\").toString(),\n          onConfirm: () => {\n            Object.values(this.diagram.trains).forEach(t => {\n              t.stops.map((s, i) => s.stationId == this.station.id && s.trackId == this.track.id ? i : -1).filter(i => i >= 0).reverse()\n                .forEach(i => t.stops.splice(i, 1))\n            });\n            this.$delete(this.station.tracks, this.track.id);\n            this.$emit(\"updateY\");\n          },\n        });\n      } else {\n        this.$delete(this.station.tracks, this.track.id);\n        this.$emit(\"updateY\");\n      }\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationRemoveTrackButton.vue?vue&type=template&id=6d2dbf95&scoped=true&\"\nimport script from \"./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6d2dbf95\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.targetTrack.name),expression:\"targetTrack.name\"},{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.trackNameInputTarget),expression:\"viewState.trackNameInputTarget\"}],style:(_vm.style),domProps:{\"value\":(_vm.targetTrack.name)},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onComplete($event)},\"blur\":_vm.onComplete,\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.targetTrack, \"name\", $event.target.value)}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport Track from \"@/data/Track\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class TrackNameInput extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  get targetTrack(): Track | Record<string, never> {\n    const tar = this.viewState.trackNameInputTarget;\n    return tar ? (this.diagram.stations[tar.stationId].tracks.find(t => t.id == tar.trackId) ?? {}) : {};\n  }\n\n  get style(): unknown {\n    return this.viewState.trackNameInputTarget ?\n      {\n        left: `${this.diagram.config.stationLabelLeftMargin + this.diagram.config.trackLabelLeftMargin}px`,\n        top: `${this.diagram.getYByRelY(this.targetTrack.relY) - this.diagram.config.stationLabelFontSize - 4}px`,\n        width: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.trackLabelLeftMargin - this.diagram.config.stationLabelRightMargin}px`,\n        height: `${this.diagram.config.stationLabelFontSize + 4}px`,\n        paddingTop: \"2px\",\n        lineHeight: `${this.diagram.config.stationLabelFontSize}px`,\n        border: \"none\",\n        fontSize: `${this.diagram.config.stationLabelFontSize}px`,\n      } : {};\n  }\n\n  onComplete(): void {\n    this.viewState.trackNameInputTarget = null;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackNameInput.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackNameInput.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrackNameInput.vue?vue&type=template&id=4c30130c&scoped=true&\"\nimport script from \"./TrackNameInput.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrackNameInput.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4c30130c\",\n  null\n  \n)\n\nexport default component.exports","export default {\r\n    \"stations\": [\r\n        { \"id\": 1, \"name\": \"\", \"tracks\": [ { \"id\": 1, \"name\": \"1\" }, { \"id\": 2, \"name\": \"2\" } ], \"mileage\": 0, \"expanded\": true },\r\n        { \"id\": 15, \"name\": \"\", \"tracks\": [ { \"id\": 1, \"name\": \"\" } ], \"mileage\": 3.6 },\r\n        { \"id\": 3, \"name\": \"\", \"tracks\": [ { \"id\": 1, \"name\": \"\" } ], \"mileage\": 7.4 },\r\n        { \"id\": 4, \"name\": \"\", \"tracks\": [ { \"id\": 1, \"name\": \"\" } ], \"mileage\": 12.2 },\r\n        { \"id\": 5, \"name\": \"\", \"tracks\": [ { \"id\": 1, \"name\": \"\" } ], \"mileage\": 17.2 },\r\n        { \"id\": 6, \"name\": \"\", \"tracks\": [ { \"id\": 1, \"name\": \"\" } ], \"mileage\": 22.5 },\r\n        { \"id\": 9, \"name\": \"\", \"tracks\": [ { \"id\": 1, \"name\": \"\" } ], \"mileage\": 33.2 },\r\n        { \"id\": 11, \"name\": \"\", \"tracks\": [ { \"id\": 1, \"name\": \"\" } ], \"mileage\": 40.6 },\r\n        { \"id\": 14, \"name\": \"\", \"tracks\": [ { \"id\": 1, \"name\": \"\" } ], \"mileage\": 56.1 }\r\n    ],\r\n    \"trains\": [\r\n        { \r\n            \"id\": 721, \r\n            \"name\": \"721D\", \r\n            \"stops\": [\r\n                { \"id\": 72109, \"stationId\": 9, \"trackId\": 1, \"depTime\": 20040 },\r\n                { \"id\": 72114, \"stationId\": 14, \"trackId\": 1, \"arrTime\": 21600 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 723, \r\n            \"name\": \"723D\", \r\n            \"stops\": [\r\n                { \"id\": 72309, \"stationId\": 9, \"trackId\": 1, \"depTime\": 23820 },\r\n                { \"id\": 72314, \"stationId\": 14, \"trackId\": 1, \"arrTime\": 25380 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 725, \r\n            \"name\": \"725D\", \r\n            \"stops\": [\r\n                { \"id\": 72501, \"stationId\": 1, \"trackId\": 1, \"depTime\": 23520 },\r\n                { \"id\": 72504, \"stationId\": 4, \"trackId\": 1, \"arrTime\": 24360, \"depTime\": 24600 },\r\n                { \"id\": 72505, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 24900, \"depTime\": 25140 },\r\n                { \"id\": 72509, \"stationId\": 9, \"trackId\": 1, \"arrTime\": 26280, \"depTime\": 26940 },\r\n                { \"id\": 72511, \"stationId\": 11, \"trackId\": 1, \"arrTime\": 27540, \"depTime\": 27900 },\r\n                { \"id\": 72514, \"stationId\": 14, \"trackId\": 1, \"arrTime\": 28860 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 727, \r\n            \"name\": \"727D\", \r\n            \"stops\": [\r\n                { \"id\": 72701, \"stationId\": 1, \"trackId\": 1, \"depTime\": 25980 },\r\n                { \"id\": 72703, \"stationId\": 3, \"trackId\": 1, \"arrTime\": 26580, \"depTime\": 27180 },\r\n                { \"id\": 72704, \"stationId\": 4, \"trackId\": 1, \"arrTime\": 27480, \"depTime\": 27840 },\r\n                { \"id\": 72705, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 28200, \"depTime\": 29100 },\r\n                { \"id\": 72709, \"stationId\": 9, \"trackId\": 1, \"arrTime\": 30240 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 71, \r\n            \"name\": \"71D\", \r\n            \"stops\": [\r\n                { \"id\": 7101, \"stationId\": 1, \"trackId\": 1, \"depTime\": 26700 },\r\n                { \"id\": 7105, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 27420, \"depTime\": 27480 },\r\n                { \"id\": 7109, \"stationId\": 9, \"trackId\": 1, \"arrTime\": 28320, \"depTime\": 28380 },\r\n                { \"id\": 7114, \"stationId\": 14, \"trackId\": 1, \"arrTime\": 29340 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 729, \r\n            \"name\": \"729D\", \r\n            \"stops\": [\r\n                { \"id\": 72901, \"stationId\": 1, \"trackId\": 1, \"depTime\": 28260 },\r\n                { \"id\": 72904, \"stationId\": 4, \"trackId\": 1, \"arrTime\": 29160, \"depTime\": 29340 },\r\n                { \"id\": 72905, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 29640, \"depTime\": 30060 },\r\n                { \"id\": 72909, \"stationId\": 9, \"trackId\": 1, \"arrTime\": 31200 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 720, \r\n            \"name\": \"720D\", \r\n            \"stops\": [\r\n                { \"id\": 72009, \"stationId\": 9, \"trackId\": 1, \"depTime\": 19140 },\r\n                { \"id\": 72005, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 20220, \"depTime\": 20280 },\r\n                { \"id\": 72001, \"stationId\": 1, \"trackId\": 1, \"arrTime\": 21360 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 722, \r\n            \"name\": \"722D\", \r\n            \"stops\": [\r\n                { \"id\": 72209, \"stationId\": 9, \"trackId\": 1, \"depTime\": 22440 },\r\n                { \"id\": 72205, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 23520, \"depTime\": 23820 },\r\n                { \"id\": 72204, \"stationId\": 4, \"trackId\": 1, \"arrTime\": 24120, \"depTime\": 24360 },\r\n                { \"id\": 72201, \"stationId\": 1, \"trackId\": 1, \"arrTime\": 25200 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 724, \r\n            \"name\": \"724D\", \r\n            \"stops\": [\r\n                { \"id\": 72414, \"stationId\": 14, \"trackId\": 1, \"depTime\": 22140 },\r\n                { \"id\": 72409, \"stationId\": 9, \"trackId\": 1, \"arrTime\": 23760, \"depTime\": 23820 },\r\n                { \"id\": 72405, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 24900, \"depTime\": 25080 },\r\n                { \"id\": 72415, \"stationId\": 15, \"trackId\": 1, \"arrTime\": 25980, \"depTime\": 26280 },\r\n                { \"id\": 72401, \"stationId\": 1, \"trackId\": 1, \"arrTime\": 26520 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 52, \r\n            \"name\": \"52D\", \r\n            \"stops\": [\r\n                { \"id\": 5214, \"stationId\": 14, \"trackId\": 1, \"depTime\": 25680 },\r\n                { \"id\": 5209, \"stationId\": 9, \"trackId\": 1, \"arrTime\": 26580, \"depTime\": 26625 },\r\n                { \"id\": 5205, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 27300, \"depTime\": 27480 },\r\n                { \"id\": 5201, \"stationId\": 1, \"trackId\": 1, \"arrTime\": 28140 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 726, \r\n            \"name\": \"726D\", \r\n            \"stops\": [\r\n                { \"id\": 72609, \"stationId\": 9, \"trackId\": 1, \"depTime\": 26940 },\r\n                { \"id\": 72606, \"stationId\": 6, \"trackId\": 1, \"arrTime\": 27720, \"depTime\": 27840 },\r\n                { \"id\": 72605, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 28200, \"depTime\": 28260 },\r\n                { \"id\": 72601, \"stationId\": 1, \"trackId\": 1, \"arrTime\": 29400 }\r\n            ]\r\n        },\r\n        { \r\n            \"id\": 72, \r\n            \"name\": \"72D\", \r\n            \"stops\": [\r\n                { \"id\": 7214, \"stationId\": 14, \"trackId\": 1, \"depTime\": 27240 },\r\n                { \"id\": 7209, \"stationId\": 9, \"trackId\": 1, \"arrTime\": 28200, \"depTime\": 28380 },\r\n                { \"id\": 7205, \"stationId\": 5, \"trackId\": 1, \"arrTime\": 29040, \"depTime\": 29100 },\r\n                { \"id\": 7201, \"stationId\": 1, \"trackId\": 1, \"arrTime\": 29820 }\r\n            ]\r\n        },\r\n    ],\r\n    maxId: 1000000\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, ProvideReactive, Vue } from \"vue-property-decorator\";\nimport Diagram from \"./data/Diagram\";\nimport Station from \"./data/Station\";\nimport ViewConfig from \"./data/ViewConfig\";\nimport ViewState from \"./data/ViewState\";\nimport Stage from \"./components/Stage.vue\";\nimport StationAddTrackButton from \"./components/StationAddTrackButton.vue\";\nimport StationExpandButton from \"./components/StationExpandButton.vue\";\nimport StationNameInput from \"./components/StationNameInput.vue\";\nimport StationRemoveButton from \"./components/StationRemoveButton.vue\";\nimport StationRemoveTrackButton from \"./components/StationRemoveTrackButton.vue\";\nimport TrackNameInput from \"./components/TrackNameInput.vue\";\n\nimport defaultDiagramJson from \"./default-diagram\";\n\n@Component({\n  components: {\n    Stage, StationAddTrackButton, StationExpandButton, StationNameInput, StationRemoveButton, StationRemoveTrackButton, TrackNameInput\n  },\n})\nexport default class App extends Vue {\n  @ProvideReactive() viewConfig = new ViewConfig();\n  @ProvideReactive() viewState = new ViewState();\n  @ProvideReactive() diagram: Diagram = Diagram.fromJSON({ stations: [], trains: [] });\n\n  file: File | null = null;\n\n  get stationsInMileageOrder(): Station[] {\n    return this.diagram.getStationsInMileageOrder();\n  }\n\n  mounted(): void {\n    window.addEventListener(\"resize\", this.updateAppSize);\n    this.updateAppSize();\n\n    this.diagram = Diagram.fromJSON(defaultDiagramJson);\n    this.updateY();\n}\n\n  unmounted(): void {\n    window.removeEventListener(\"resize\", this.updateAppSize);\n  }\n\n  onStationNameInputStart(): void {\n    this.$nextTick(() => ((this.$refs.stationNameInput as Vue).$el as HTMLInputElement).focus());\n  }\n\n  onTrackNameInputStart(): void {\n    this.$nextTick(() => ((this.$refs.trackNameInput as Vue).$el as HTMLInputElement).focus());\n  }\n\n  onEditButtonClick(): void {\n    this.viewState.editMode = !this.viewState.editMode;    \n  }\n\n  onUploadButtonClick(): void {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \".json, application/json\";\n    input.onchange = () => {\n      const reader = new FileReader();\n      if (input.files && input.files.length > 0) {\n        const file = input.files[0];\n        reader.readAsText(file);\n        reader.onload = () => {\n          if (typeof(reader.result) == \"string\") {\n            const data = JSON.parse(reader.result);\n            try {\n              this.diagram = Diagram.fromJSON(data);\n            } catch (e) {\n              this.$buefy.notification.open({\n                type: \"is-danger\",\n                message: `${this.$t(\"message.failedToLoadJSON\").toString()}<br>${file.name}`,\n              });\n            }\n            this.viewState = new ViewState();\n            this.updateAppSize();\n            this.viewState.diagramFileName = file.name;\n            this.updateY();\n          }\n        };\n      }\n    };\n    input.click();\n  }\n\n  onDownloadButtonClick(): void {\n    const json = JSON.stringify(this.diagram);\n    const blob = new Blob([ json ], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = this.viewState.diagramFileName;\n    a.click();\n  }\n\n  updateAppSize(): void {\n    const viewElem = document.getElementById(\"view-pane\");\n    if (viewElem) {\n      this.viewState.viewWidth = viewElem.clientWidth;\n      this.viewState.viewHeight = viewElem.clientHeight;\n      this.viewState.appHeight = document.getElementById(\"app\")?.clientHeight || 0;\n    }\n  }\n\n  updateY(): void {\n    const stations = this.stationsInMileageOrder;\n    if (stations.length == 0) {\n      return;\n    }\n\n    const initialMileage = stations[0].mileage;\n    for (const s of stations) {\n      s.mileage = s.mileage - initialMileage;\n    }\n\n    let y = this.diagram.config.plotPaneVerticalPadding;\n    let lastMileage = 0;\n    for (const s of stations) {\n      y += (s.mileage - lastMileage) * this.diagram.config.yScale;\n      const sy = s.floating ? s.topRelY : y;\n      s.topRelY = sy;\n      if (s.expanded) {\n        s.tracks.forEach((t, i) => {\n          t.relY = sy + (i + 1) * this.diagram.config.trackLineSpan;\n        });\n        s.bottomRelY = sy + (s.tracks.length + 1) * this.diagram.config.trackLineSpan;\n        y += (s.tracks.length + 1) * this.diagram.config.trackLineSpan;\n      } else {\n        Object.values(s.tracks).forEach(t => t.relY = sy);\n        s.bottomRelY = sy;\n      }\n      lastMileage = s.mileage;\n    }\n\n    this.viewState.maxRelY = stations[stations.length - 1].bottomRelY + this.diagram.config.plotPaneVerticalPadding;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=0c413f54&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\r\n    ja: {\r\n        message: {\r\n            confirmRemoveStationRefered: \"\",\r\n            confirmRemoveTrackRefered: \"\",\r\n            failedToLoadJSON: \"\",\r\n        },\r\n    },\r\n};\r\n","import Vue from \"vue\";\nimport Buefy from \"buefy\";\nimport \"buefy/dist/buefy.css\";\nimport VueI18n from \"vue-i18n\";\nimport VueKonva from \"vue-konva\";\nimport App from \"./App.vue\";\nimport messages from \"./messages\";\n\nVue.config.productionTip = false\nVue.use(Buefy, {\n  defaultNotificationDuration: 5000,\n  defaultNotificationPosition: \"is-bottom-right\",\n});\nVue.use(VueI18n);\nVue.use(VueKonva);\n\nconst i18n = new VueI18n({\n  locale: \"ja\",\n  messages,\n});\n\nnew Vue({\n  render: h => h(App),\n  i18n,\n}).$mount(\"#app\");\n"],"sourceRoot":""}