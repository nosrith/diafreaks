{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/assets/help_edit_train.png","webpack:///./src/components/TrainInfoEditor.vue?800a","webpack:///./src/assets/help_select_train.png","webpack:///./src/App.vue?c650","webpack:///./src/assets/help_tips.png","webpack:///./src/components/DiagramView.vue?87cf","webpack:///./src/assets/help_edit_time.png","webpack:///./src/assets/diafreaks_logo.png","webpack:///./src/assets/help_add_new_train.png","webpack:///./src/assets/help_add_new_station.png","webpack:///./src/App.vue?3644","webpack:///./src/HistoryManager.ts","webpack:///./src/data/DiagramConfig.ts","webpack:///./src/data/Track.ts","webpack:///./src/data/Station.ts","webpack:///./src/data/StopEvent.ts","webpack:///./src/data/Train.ts","webpack:///./src/data/Diagram.ts","webpack:///./src/data/ViewConfig.ts","webpack:///./src/data/ViewState.ts","webpack:///./src/data/DiagramViewContext.ts","webpack:///./src/components/DiagramView.vue?a177","webpack:///./src/components/Stage.vue?a32d","webpack:///./src/components/BackLayer.vue?7fe6","webpack:///./src/components/StationGroup.vue?cf7d","webpack:///./src/components/TrackGroup.vue?bf92","webpack:///./src/components/TrackGroup.vue","webpack:///./src/components/TrackGroup.vue?80ea","webpack:///./src/components/TrackGroup.vue?a194","webpack:///./src/components/StationGroup.vue","webpack:///./src/components/StationGroup.vue?f322","webpack:///./src/components/StationGroup.vue?1b58","webpack:///./src/components/BackLayer.vue","webpack:///./src/components/BackLayer.vue?3b1f","webpack:///./src/components/BackLayer.vue?c43c","webpack:///./src/components/Pointer.vue?e787","webpack:///./src/utils.ts","webpack:///./src/components/Pointer.vue","webpack:///./src/components/Pointer.vue?63e5","webpack:///./src/components/Pointer.vue?a4a9","webpack:///./src/components/TrainPathLayer.vue?f0c1","webpack:///./src/components/TrainPathGroup.vue?3bcf","webpack:///./src/components/TrainPathMarker.vue?8ab4","webpack:///./src/components/TrainPathMarker.vue","webpack:///./src/components/TrainPathMarker.vue?ce7d","webpack:///./src/components/TrainPathMarker.vue?a47c","webpack:///./src/components/TrainPathGroup.vue","webpack:///./src/components/TrainPathGroup.vue?c604","webpack:///./src/components/TrainPathGroup.vue?fe26","webpack:///./src/components/TrainPathLayer.vue","webpack:///./src/components/TrainPathLayer.vue?75af","webpack:///./src/components/TrainPathLayer.vue?44a2","webpack:///./src/components/Stage.vue","webpack:///./src/components/Stage.vue?091d","webpack:///./src/components/Stage.vue?d206","webpack:///./src/components/StationAddTrackButton.vue?fe35","webpack:///./src/components/StationAddTrackButton.vue","webpack:///./src/components/StationAddTrackButton.vue?f328","webpack:///./src/components/StationAddTrackButton.vue?b738","webpack:///./src/components/StationExpandButton.vue?f578","webpack:///./src/components/StationExpandButton.vue","webpack:///./src/components/StationExpandButton.vue?8892","webpack:///./src/components/StationExpandButton.vue?e10d","webpack:///./src/components/StationNameInput.vue?2aa9","webpack:///./src/components/StationNameInput.vue","webpack:///./src/components/StationNameInput.vue?fcac","webpack:///./src/components/StationNameInput.vue?9ce9","webpack:///./src/components/StationRemoveButton.vue?eb96","webpack:///./src/components/StationRemoveButton.vue","webpack:///./src/components/StationRemoveButton.vue?6092","webpack:///./src/components/StationRemoveButton.vue?7287","webpack:///./src/components/StationRemoveTrackButton.vue?0377","webpack:///./src/components/StationRemoveTrackButton.vue","webpack:///./src/components/StationRemoveTrackButton.vue?2de7","webpack:///./src/components/StationRemoveTrackButton.vue?c700","webpack:///./src/components/TrackNameInput.vue?f133","webpack:///./src/components/TrackNameInput.vue","webpack:///./src/components/TrackNameInput.vue?2a59","webpack:///./src/components/TrackNameInput.vue?4243","webpack:///./src/components/TrainInfoEditor.vue?3b45","webpack:///./src/components/TrainInfoEditor.vue","webpack:///./src/components/TrainInfoEditor.vue?a5a9","webpack:///./src/components/TrainInfoEditor.vue?53e3","webpack:///./src/components/DiagramView.vue","webpack:///./src/components/DiagramView.vue?0f5f","webpack:///./src/components/DiagramView.vue?613b","webpack:///./src/components/HelpView.vue?e4b0","webpack:///./src/components/HelpView.vue","webpack:///./src/components/HelpView.vue?dc1e","webpack:///./src/components/HelpView.vue?c2ea","webpack:///./src/App.vue","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/messages.ts","webpack:///./src/main.ts","webpack:///./src/components/HelpView.vue?57d9"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","context","subView","_e","_m","staticClass","$t","class","state","editMode","on","onEditButtonClick","history","undoable","onUndoButtonClick","redoable","onRedoButtonClick","keys","diagram","trains","onVanishButtonClick","onUploadButtonClick","onDownloadButtonClick","onHelpButtonClick","staticRenderFns","staticStyle","capacity","undos","redos","elem","pop","undo","redo","minimumTimeUnit","minPlotTime","maxPlotTime","leftPaneWidth","trackLineSpan","scrollX","scrollY","xScale","yScale","dc","DiagramConfig","assign","fromEntries","filter","undefined","map","station","id","relY","Track","mileage","expanded","topRelY","bottomRelY","tracks","track","index","Math","max","indexOf","e","Array","isArray","Station","fromJSON","train","time","privateId","StopEvent","maxPrivateId","stevs","stations","stationId","trackId","arrTime","a","depTime","find","color","lineWidth","stev","stevRange","inRange","from","to","nodes","prev","phase","next","stops","lastStop","w","Train","flatMap","fromJSONStop","forEach","config","maxRelY","values","sort","b","set","delete","getStationsInMileageOrder","initialMileage","y","lastMileage","Diagram","updateY","fontFamily","topPaneHeight","hourlyLabelBottomMargin","hourlyLabelFontSize","hourlyLabelColor","hourlyGridLineWidth","hourlyGridLineColor","majorMinutelyGridLineSpan","majorMinutelyGridLineWidth","majorMinutelyGridLineColor","minorMinutelyGridLineSpan","minorMinutelyGridLineWidth","minorMinutelyGridLineColor","stationLabelLeftMargin","stationLabelRightMargin","stationLabelFontSize","stationLabelColor","stationLineWidth","stationLineColor","plotPanePadding","trackLabelLeftMargin","trackLabelFontSize","trackLabelColor","trackLineWidth","trackLineColor","trainPathWidth","trainPathColor","trainNameLabelLineHeight","trainNameLabelFontSize","minHitWidth","pointerWidth","pointerColor","pointerLabelFontSize","pointerPrecisePixelPerTimeUnit","selectedTrackLabelColor","selectedTrackLineColor","selectedTrainPathColor","selectedTrainPathWidthScale","selectedTrainPathMarkerWidth","selectedTrainPathMarkerColor","unselectedTrainPathOpacity","markerLabelMaxDistance","markerLabelColor","markerLabelFontSize","markerLabelLineHeight","wheelScale","viewWidth","viewHeight","trainSelections","pointerScreenX","pointerTime","pointerY","pointerTargetTrainPath","pointerTargetLine","pointerPreciseState","drawingState","trainPathDragState","stationNameInputTarget","trackNameInputTarget","trainInfoEditorTarget","controlKeyPressed","inputEnabled","x","onStationNameInputStart","onTrackNameInputStart","onTrainInfoEditStart","onTrainInfoEditEnd","ref","_l","stageConfig","onStageMouseDown","onStageMouseMove","onStageClick","onStageDoubleClick","onStageMouseWheel","onContextMenu","onTouchEnd","_g","$listeners","lineConfig","labelConfig","topLineConfig","labelRectConfig","onStationLabelClick","onStationLabelMouseDown","isBottomLineIntersectingPlotPane","bottomLineConfig","onLabelClick","onLabelMouseDown","dragState","points","viewConfig","getYByRelY","viewState","stroke","strokeWidth","listening","width","height","text","fontSize","fill","align","verticalAlign","busy","dragging","$emit","konvaEvent","sy0","evt","screenY","index0","addEventListener","onWindowMouseMove","onWindowMouseUp","event","abs","removeTrack","mouseRelY","getRelYByY","clientY","newIndex","findIndex","removeEventListener","index1","addNewTrack","component","widthForChars","stationName","charSpan","mileage0","mileage1","components","TrackGroup","lines","scrollLeftTime","ceil","getXByTime","StationGroup","rectConfig","getTimeText","forceSec","hStr","floor","mmStr","padStart","ssStr","canvas","document","createElement","ctx","getContext","getTextWidth","font","measureText","layerConfig","trainNameLabelConfig","onTrainNameLabelClick","regularTrainPathConfig","onTrainPathClick","onTrainPathMouseMove","onTrainPathTap","selectedTrainPathConfig","onSelectedTrainPathClick","onSelectedTrainPathDoubleClick","onSelectedTrainPathMouseDown","onSelectedTrainPathMouseMove","onMarkerClick","onMarkerMouseDown","$event","trainPathNode","onRectMouseMove","onRectDoubleClick","labelPosition","getLabelPosition","thisStev","prevStev","nextStev","thisRelY","prevRelY","lastStev","direction","stableEnd","floating","sel","visible","trainNameLabelText","trainNameLabelRect","textWidth","targets","selectedTrainPathNodes","regularTrainPathNodes","firstNodeRunning","segDYToDX","NaN","forwardNode","dx","dy","dy2dx","sign","Infinity","isNaN","hypot","rotation","segDXToD","sqrt","segDYToD","atan","PI","opacity","hitStrokeWidth","getTrainPathNodes","dragTarget","node","timeShift","nInRange","target","currentTarget","shiftKey","$set","getPointedStevRange","clientX","clickedStopRange","changeTrainSelections","clickedStevRange","clickSelected","selectedStevRange","selStart","selEnd","changed","$delete","leftX","rightX","topY","min","bottomY","targetTime","nearestStation","getNearestStation","nearestStev","getNearestStopEvent","newStev","addNewStopEvent","minSta","minDist","minStop","minTimeShift","maxTimeShift","changeTrackTargets","firstNode","t0","y0","sx0","screenX","track0","changeTimeTargets","targetStation","mouseTrack","track1","newTrains","srcTrain","srcStevs","getStopEventsInRange","newTrain","addNewTrain","srcStev","removeTrain","TrainPathMarker","clip","TrainPathGroup","stageDragState","pinchState","onKeyDown","onKeyUp","hammer","$el","DIRECTION_ALL","enable","onPanStart","onPanMove","onPanEnd","onPinchStart","onPinchMove","onPinchEnd","dUnit","round","getTimeByX","findPointerTargetLine","removeStopEvent","targetTrack","stationPointedOnTop","stationsInMileageOrder","stationPointedOnBottom","pointedTrack","button","triple","newLastStev","ctrlKey","startsWith","stableIndex","addedStevs","concat","targetLine","prevSta","reverse","addNewStation","startDrag","moveDrag","pointerType","center","scrollX0","scrollY0","x0","f","pow","deltaY","preventDefault","lastScale","scale","repeat","deletingTrains","deletingStevs","fromIndex","toIndex","size","BackLayer","Pointer","TrainPathLayer","style","nativeOn","onClick","left","top","newTrack","icon","directives","rawName","expression","domProps","type","_k","keyCode","onComplete","paddingTop","lineHeight","border","name0","name1","isTopLineIntersectingPlotPane","removingTrains","removingStevs","isLineIntersectingPlotPane","trackIndex","targetTrain","onBlur","background","onColorPickerTriggerClick","onLineWidthPickerTriggerClick","getDispLineWidthByValue","onColorPickerClick","onLineWidthPickerClick","pickerMode","$refs","trainInfoEditorBox","clientHeight","trainInfoEditorBoxTop","colorPickerTrigger","offsetLeft","lineWidthPickerTrigger","lineWidthPickerValues","disp","trainNameInput","color0","lineWidth0","resizeObserver","ResizeObserver","updateViewSize","observe","$nextTick","stationNameInput","focus","trackNameInput","trainInfoEditor","clientWidth","default","Stage","StationAddTrackButton","StationExpandButton","StationNameInput","StationRemoveButton","StationRemoveTrackButton","TrackNameInput","TrainInfoEditor","_s","diagramFileName","enableSwitchEditMode","screen","fetch","then","json","input","accept","onchange","reader","FileReader","files","file","readAsText","onload","JSON","parse","clear","$buefy","notification","open","message","toString","click","stringify","blob","Blob","url","URL","createObjectURL","href","download","DiagramView","HelpView","ja","failedToLoadJSON","editButtonTooltip","undoButtonTooltip","redoButtonTooltip","vanishTrainsButtonTooltip","vanishStationsButtonTooltip","uploadButtonTooltip","downloadButtonTooltip","helpButtonTooltip","help","addNewStationTitle","addNewStationBody","addNewTrainTitle","addNewTrainBody","selectTrainTitle","selectTrainBody","editTrainTitle","editTrainBody","editTimeTitle","editTimeBody","tipsTitle","tipsBody","contactTitle","contactBody","productionTip","use","defaultNotificationDuration","defaultNotificationPosition","i18n","locale","messages","render","h","$mount"],"mappings":"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","file":"js/app.33279f5a.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = __webpack_public_path__ + \"img/help_edit_train.67395182.png\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainInfoEditor.vue?vue&type=style&index=0&id=0986c1e1&scoped=true&lang=scss&\"","module.exports = __webpack_public_path__ + \"img/help_select_train.6cd1d819.png\";","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","module.exports = __webpack_public_path__ + \"img/help_tips.12f4142e.png\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DiagramView.vue?vue&type=style&index=0&id=4cefd6dc&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/help_edit_time.25aa545d.png\";","module.exports = __webpack_public_path__ + \"img/diafreaks_logo.8b0abdc8.png\";","module.exports = __webpack_public_path__ + \"img/help_add_new_train.0fab88c8.png\";","module.exports = __webpack_public_path__ + \"img/help_add_new_station.d55b6e32.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('diagram-view',{attrs:{\"id\":\"diagram-view\",\"context\":_vm.context}}),(_vm.subView == 'help')?_c('help-view',{attrs:{\"id\":\"help-pane\"}}):_vm._e(),_c('div',{attrs:{\"id\":\"nav-pane\"}},[_vm._m(0),_c('span',{attrs:{\"id\":\"nav-pane-buttons\"}},[_c('span',{attrs:{\"id\":\"nav-pane-buttons-left\"}},[(_vm.enableSwitchEditMode)?_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.editButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{class:_vm.context.state.editMode ? 'is-selected': '',attrs:{\"icon-left\":\"pencil-outline\",\"size\":\"medium\"},on:{\"click\":_vm.onEditButtonClick}})],1)],1):_vm._e(),(_vm.context.state.editMode)?_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.undoButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"undo\",\"size\":\"medium\",\"disabled\":!_vm.context.history.undoable},on:{\"click\":_vm.onUndoButtonClick}})],1)],1):_vm._e(),(_vm.context.state.editMode)?_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.redoButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"redo\",\"size\":\"medium\",\"disabled\":!_vm.context.history.redoable},on:{\"click\":_vm.onRedoButtonClick}})],1)],1):_vm._e(),(_vm.context.state.editMode)?_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":Object.keys(_vm.context.diagram.trains).length > 0 ? _vm.$t('message.vanishTrainsButtonTooltip') : _vm.$t('message.vanishStationsButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"vanish\",\"size\":\"medium\"},on:{\"click\":_vm.onVanishButtonClick}})],1)],1):_vm._e(),_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.uploadButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"upload\",\"size\":\"medium\"},on:{\"click\":_vm.onUploadButtonClick}})],1)],1),_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.downloadButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"download\",\"size\":\"medium\"},on:{\"click\":_vm.onDownloadButtonClick}})],1)],1)]),_c('span',{attrs:{\"id\":\"nav-pane-buttons-spacer\"}}),_c('span',{attrs:{\"id\":\"nav-pane-buttons-right\"}},[(_vm.enableSwitchEditMode)?_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.helpButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{class:_vm.subView == 'help' ? 'is-selected': '',attrs:{\"icon-left\":\"help\",\"size\":\"medium\"},on:{\"click\":_vm.onHelpButtonClick}})],1)],1):_vm._e()])])])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"nav-pane-item\",attrs:{\"id\":\"nav-pane-logo\"}},[_c('img',{staticStyle:{\"height\":\"32px\"},attrs:{\"src\":require(\"@/assets/diafreaks_logo.png\")}})])}]\n\nexport { render, staticRenderFns }","interface HistoryElement {\n    this: unknown;\n    undo: () => void;\n    redo: () => void;\n}\n\nexport default class HistoryManager {\n    constructor(public capacity: number) {}\n    private undos: HistoryElement[] = [];\n    private redos: HistoryElement[] = [];\n\n    get undoable(): boolean { return this.undos.length > 0; }\n    get redoable(): boolean { return this.redos.length > 0; }\n\n    push(elem: HistoryElement): void {\n        if (this.undos.length >= this.capacity) {\n            this.undos.splice(0, this.undos.length - this.capacity + 1);\n        }\n        this.undos.push(elem);\n        this.redos.splice(0);\n    }\n\n    clear(): void {\n        this.undos.splice(0);\n        this.redos.splice(0);\n    }\n\n    undo(): void {\n        const elem = this.undos.pop();\n        if (elem) {\n            this.redos.push(elem);\n            elem.undo.apply(elem.this);\n        }\n    }\n\n    redo(): void {\n        const elem = this.redos.pop();\n        if (elem) {\n            this.undos.push(elem);\n            elem.redo.apply(elem.this);\n        }\n    }\n}\n","export default class DiagramConfig {\n    minimumTimeUnit = 5;\n    minPlotTime = 0;\n    maxPlotTime = 30 * 3600;\n    leftPaneWidth = 160;\n    trackLineSpan = 12;\n    scrollX = 6 * 3600 * 0.08;\n    scrollY = 0;\n    xScale = 0.1;\n    yScale = 12;\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any): DiagramConfig {\n        if (!(o && typeof o == \"object\")) {\n            throw \"Invalid JSON\";\n        }\n        const dc = new DiagramConfig();\n        Object.assign(dc, Object.fromEntries(\n            Object.keys(dc).filter(key => o[key] !== undefined).map(key => [key, o[key]])\n        ));\n        return dc;\n    }\n}","import Station from \"./Station\";\n\nexport default class Track {\n    constructor(\n        public readonly station: Station,\n        public readonly id: number, \n        public name: string | null = null,\n        public relY = 0,\n    ) {}\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any, station: Station): Track {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        const name = o.name ?? o.n;\n        if (!(o && typeof o == \"object\" && o.id != null)) {\n            throw \"Invalid JSON @ Track\";\n        }\n        return new Track(station, o.id, name);\n    }\n\n    toJSON(): unknown {\n        return {\n            id: this.id,\n            n: this.name ?? undefined,\n        };\n    }\n}","import Track from \"./Track\";\n\nexport default class Station {\n    constructor(\n        public readonly id: number, \n        public name: string | null = null, \n        public mileage = 0,\n        public expanded = false,\n        public topRelY = 0,\n        public bottomRelY = 0,\n    ) {}\n    tracks: Track[] = [ new Track(this, 1) ];\n\n    addNewTrack(track?: Track, index: number = this.tracks.length): Track {\n        if (!track) {\n            const id = Math.max(0, ...this.tracks.map(t => t.id)) + 1;\n            track = new Track(this, id);\n        }\n        this.tracks.splice(index, 0, track);\n        return this.tracks[index];\n    }\n\n    removeTrack(t: Track): void {\n        const index = this.tracks.indexOf(t);\n        if (index >= 0) this.tracks.splice(index, 1);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any): Station {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        const name = o.name ?? o.n;\n        const mileage = o.mileage ?? o.m;\n        const expanded = !!(o.expanded ?? o.e);\n        const tracks = o.tracks ?? o.t;\n        if (!(o && typeof o == \"object\" && o.id != null && mileage != null && Array.isArray(tracks))) {\n            throw \"Invalid JSON @ Station\"\n        }\n        const station = new Station(o.id, name, mileage, expanded);\n        station.tracks = (tracks as any[]).map((t: any) => Track.fromJSON(t, station));\n        return station;\n    }\n\n    toJSON(): unknown {\n        return {\n            id: this.id,\n            n: this.name ?? undefined,\n            m: this.mileage,\n            t: this.tracks,\n            e: this.expanded ? 1 : undefined,\n        };\n    }\n}\n","import Station from \"./Station\";\nimport Track from \"./Track\";\nimport Train from \"./Train\";\n\nexport default class StopEvent {\n    static maxPrivateId = 0;\n\n    constructor(\n        public readonly train: Train,\n        public track: Track,\n        public time: number\n    ) {}\n    readonly privateId: number = ++StopEvent.maxPrivateId;\n\n    get station(): Station {\n        return this.track.station;\n    }\n    get next(): StopEvent | undefined {\n        const index = this.train.stevs.indexOf(this);\n        return index >= 0 ? this.train.stevs[index + 1] : undefined;\n    }\n    get prev(): StopEvent | undefined {\n        const index = this.train.stevs.indexOf(this);\n        return index >= 0 ? this.train.stevs[index - 1] : undefined;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSONStop(o: any, train: Train, stations: { [id: number]: Station }): StopEvent[] {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        const stationId = o.stationId ?? o.s;\n        const trackId = o.trackId ?? o.t;\n        const arrTime = o.arrTime ?? o.a;\n        const depTime = o.depTime ?? o.d;\n        if (!(o && typeof o == \"object\" && stationId != null && trackId != null && arrTime != null && depTime != null)) {\n            throw \"Invalid JSON @ Stop\";\n        }\n        const station = stations[stationId];\n        const track = station && station.tracks.find(t => t.id == trackId);\n        if (!(station && track)) {\n            throw \"Invalid data @ Stop\";\n        }\n        return arrTime == depTime ?\n            [ new StopEvent(train, track, arrTime) ] :\n            [ new StopEvent(train, track, arrTime), new StopEvent(train, track, depTime) ];\n    }\n}\n\nexport interface StopEventRange {\n    from: StopEvent;\n    to: StopEvent;\n}\n","import Station from \"./Station\";\nimport StopEvent, { StopEventRange } from \"./StopEvent\";\nimport TrainPathNode from \"./TrainPathNode\";\n\nexport default class Train {\n    constructor(\n        public readonly id: number, \n        public name: string | null = null,\n        public color: string | null = null,\n        public lineWidth: number | null = null,\n    ) {}\n    stevs: StopEvent[] = [];\n\n    addNewStopEvent(stev: StopEvent, index: number = this.stevs.length): StopEvent {\n        this.stevs.splice(index, 0, stev);\n        return this.stevs[index];\n    }\n\n    removeStopEvent(stev: StopEvent): void {\n        const index = this.stevs.indexOf(stev);\n        if (index >= 0) this.stevs.splice(index, 1);\n    }\n\n    getStopEventsInRange(stevRange: StopEventRange): StopEvent[] {\n        const result = [];\n        let inRange = false;\n        for (const stev of this.stevs) {\n            if (stev == stevRange.from) inRange = true;\n            if (inRange) result.push(stev);\n            if (stev == stevRange.to) inRange = false;\n        }\n        return result;\n    }\n\n    getTrainPathNodes(): TrainPathNode[] {\n        const nodes: TrainPathNode[] = [];\n        for (const stev of this.stevs) {\n          if (stev.station.expanded && stev.prev && stev.prev.station != stev.station) {\n            nodes.push({ \n              stev, \n              phase: \"arr\",\n              time: stev.time, \n              relY: stev.prev.station.mileage < stev.station.mileage ? stev.station.topRelY : stev.station.bottomRelY\n            });\n          }\n          nodes.push({\n            stev,\n            phase: \"track\",\n            time: stev.time,\n            relY: stev.track.relY\n          });\n          if (stev.station.expanded && stev.next && stev.next.station != stev.station) {\n            nodes.push({ \n              stev, \n              phase: \"dep\",\n              time: stev.time, \n              relY: stev.next.station.mileage < stev.station.mileage ? stev.station.topRelY : stev.station.bottomRelY\n            });\n          }\n        }\n        return nodes;\n      }\n    \n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any, stations: { [id: number]: Station }): Train {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        const name = o.name ?? o.n;\n        const color = o.color ?? o.c;\n        const lineWidth = o.lineWidth ?? o.w;\n        const stops = o.stops ?? o.s;\n        if (!(o && typeof o == \"object\" && o.id != null && Array.isArray(stops))) {\n            throw \"Invalid JSON @ Train\";\n        }\n        const train = new Train(o.id, name, color, lineWidth);\n        (stops as any[]).flatMap((s: any) => StopEvent.fromJSONStop(s, train, stations))\n            .forEach(stev => train.stevs.push(stev));\n        return train;\n    }\n\n    toJSON(): unknown {\n        const stops: { s: number, t: number, a: number, d: number }[] = [];\n        for (const stev of this.stevs) {\n            const lastStop = stops[stops.length - 1];\n            if (lastStop && lastStop.t == stev.track.id && lastStop.a == lastStop.d) {\n                lastStop.d = stev.time;\n            } else {\n                stops.push({ \n                    s: stev.station.id, \n                    t: stev.track.id, \n                    a: stev.time, \n                    d: stev.time \n                });\n            }\n        }\n        return {\n            id: this.id,\n            n: this.name ?? undefined,\n            c: this.color ?? undefined,\n            w: this.lineWidth ?? undefined,\n            s: stops\n        };\n    }\n}\n","import Vue from \"vue\";\nimport DiagramConfig from \"./DiagramConfig\";\nimport Station from \"./Station\";\nimport Train from \"./Train\";\n\nexport default class Diagram {\n    constructor(\n        public config: DiagramConfig,\n        public stations: { [id: number]: Station },\n        public trains: { [id: number]: Train },\n    ) {}\n    maxRelY = 0;\n    \n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any): Diagram {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && typeof o.stations == \"object\" && typeof o.trains == \"object\")) {\n            throw \"Invalid JSON\";\n        }\n        const config = DiagramConfig.fromJSON(o.config || {});\n        const stations: { [id: number]: Station } = Object.fromEntries(Object.values(o.stations).map((s: any) => [ s.id, Station.fromJSON(s) ]));\n        const trains: { [id: number]: Train } = Object.fromEntries(Object.values(o.trains).map((t: any) => [ t.id, Train.fromJSON(t, stations) ]));\n        const diagram = new Diagram(config, stations, trains);\n\n        diagram.updateY();\n\n        return diagram;\n    }\n\n    getStationsInMileageOrder(): Station[] {\n        return Object.values(this.stations).sort((a, b) => a.mileage - b.mileage);\n    }\n\n    addNewStation(station?: Station): Station {\n        if (!station) {\n            const id = Math.max(0, ...Object.values(this.stations).map(s => s.id)) + 1;\n            station = new Station(id);\n        }\n        return Vue.set(this.stations, station.id, station);\n    }\n    removeStation(station: Station): void {\n        Vue.delete(this.stations, station.id);\n    }\n    addNewTrain(train?: Train): Train {\n        if (!train) {\n            const id = Math.max(0, ...Object.values(this.trains).map(t => t.id)) + 1;\n            train = new Train(id);\n        }\n        return Vue.set(this.trains, train.id, train);\n    }\n    removeTrain(train: Train): void {\n        Vue.delete(this.trains, train.id);\n    }\n\n    updateY(): void {\n        if (Object.keys(this.stations).length == 0) {\n            this.maxRelY = 0;\n            return;\n        }\n\n        const stations = this.getStationsInMileageOrder();\n    \n        const initialMileage = stations[0].mileage;\n        for (const s of stations) {\n          s.mileage = s.mileage - initialMileage;\n        }\n    \n        let y = 0;\n        let lastMileage = 0;\n        for (const s of stations) {\n          y += (s.mileage - lastMileage) * this.config.yScale;\n          s.topRelY = y;\n          if (s.expanded) {\n            s.tracks.forEach((t, i) => {\n              t.relY = y + (i + 1) * this.config.trackLineSpan;\n            });\n            s.bottomRelY = y + (s.tracks.length + 1) * this.config.trackLineSpan;\n            y += (s.tracks.length + 1) * this.config.trackLineSpan;\n          } else {\n            Object.values(s.tracks).forEach(t => t.relY = y);\n            s.bottomRelY = y;\n          }\n          lastMileage = s.mileage;\n        }\n    \n        this.maxRelY = stations[stations.length - 1].bottomRelY;\n      }\n    \n    toJSON(): unknown {\n        return {\n            config: this.config,\n            stations: Object.values(this.stations),\n            trains: Object.values(this.trains),\n        };\n    }\n}","export default class ViewConfig {\n    fontFamily = \"Verdana, sans-serif\";\n    topPaneHeight = 30;\n    hourlyLabelBottomMargin = 4;\n    hourlyLabelFontSize = 14;\n    hourlyLabelColor = \"rgb(128, 192, 128)\";\n    hourlyGridLineWidth = 2.25;\n    hourlyGridLineColor = \"rgb(128, 192, 128)\";\n    majorMinutelyGridLineSpan = 10 * 60;\n    majorMinutelyGridLineWidth = 1.5;\n    majorMinutelyGridLineColor = \"rgb(128, 192, 128)\";\n    minorMinutelyGridLineSpan = 2 * 60;\n    minorMinutelyGridLineWidth = 0.75;\n    minorMinutelyGridLineColor = \"rgb(128, 192, 128)\";\n    stationLabelLeftMargin = 14;\n    stationLabelRightMargin = 14;\n    stationLabelFontSize = 14;\n    stationLabelColor = \"rgb(128, 192, 128)\";\n    stationLineWidth = 1;\n    stationLineColor = \"rgb(128, 192, 128)\";\n    plotPanePadding = 4;\n    trackLabelLeftMargin = 10;\n    trackLabelFontSize = 11;\n    trackLabelColor = \"rgb(128, 192, 128)\";\n    trackLineWidth = 0.75;\n    trackLineColor = \"rgb(128, 192, 128)\";\n    trainPathWidth = 1;\n    trainPathColor = \"rgb(0, 0, 0)\";\n    trainNameLabelLineHeight = 14;\n    trainNameLabelFontSize = 12;\n\n    minHitWidth = 3;\n    pointerWidth = 3;\n    pointerColor = \"rgb(0, 0, 0)\";\n    pointerLabelFontSize = 12;\n    pointerPrecisePixelPerTimeUnit = 5;\n    selectedTrackLabelColor = \"rgb(255, 0, 0)\";\n    selectedTrackLineColor = \"rgb(255, 0, 0)\";\n    selectedTrainPathColor = \"rgb(255, 0, 0)\";\n    selectedTrainPathWidthScale = 1.5;\n    selectedTrainPathMarkerWidth = 5;\n    selectedTrainPathMarkerColor = \"rgb(255, 0, 0)\";\n    unselectedTrainPathOpacity = 0.5;\n    markerLabelMaxDistance = 20;\n    markerLabelColor = \"rgb(255, 0, 0)\";\n    markerLabelFontSize = 12;\n    markerLabelLineHeight = 16;\n    wheelScale = 0.1;\n}\n","import Station from \"./Station\";\nimport StopEvent, { StopEventRange } from \"./StopEvent\";\nimport Track from \"./Track\";\nimport Train from \"./Train\";\nimport TrainSelection from \"./TrainSelection\";\n\nexport default class ViewState {\n    editMode = true;\n    viewWidth = 0;\n    viewHeight = 0;\n    trainSelections: { [trainId: number]: TrainSelection } = {};\n    pointerScreenX = 0;\n    pointerTime = 0;\n    pointerY = 0;\n    pointerTargetTrainPath: { train: Train, stevRange: StopEventRange } | null = null;\n    pointerTargetLine: { station: Station, track: Track | null, relY: number } | null = null;\n    pointerPreciseState: { sx0: number, t0: number } | null = null;\n    drawingState: {\n        train: Train,\n        lastStev: StopEvent,\n        direction: number,\n        stableEnd: StopEvent | null,\n        floating: StopEvent | null\n    } | null = null;\n    trainPathDragState: { \n        dragging: boolean,\n        targets: { [trainId: number]: TrainSelection },\n        timeShift: number \n    } | null = null;\n    stationNameInputTarget: Station | null = null;\n    trackNameInputTarget: Track | null = null;\n    trainInfoEditorTarget: {\n        train: Train,\n        x: number,\n        y: number,\n        verticalAlign: \"top\" | \"bottom\"\n    } | null = null;\n    controlKeyPressed = false;\n\n    get busy(): boolean {\n        return this.drawingState != null || \n            this.trainPathDragState != null ||\n            this.inputEnabled;\n    }\n\n    get inputEnabled(): boolean {\n        return this.stationNameInputTarget != null || \n            this.trackNameInputTarget != null ||\n            this.trainInfoEditorTarget != null;\n    }\n}\n","import HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"./Diagram\";\nimport ViewConfig from \"./ViewConfig\";\nimport ViewState from \"./ViewState\";\n\nexport default class DiagramViewContext {\n    config: ViewConfig = new ViewConfig();\n    state: ViewState = new ViewState();\n    diagram: Diagram = Diagram.fromJSON({ stations: [], trains: [] });\n    history = new HistoryManager(100);\n\n    getYByRelY(relY: number): number {\n        return relY + this.config.plotPanePadding + this.config.topPaneHeight - this.diagram.config.scrollY;\n    }    \n    getRelYByY(y: number): number {\n        return y - this.config.plotPanePadding - this.config.topPaneHeight + this.diagram.config.scrollY;\n    }\n    getXByTime(time: number): number {\n        return time * this.diagram.config.xScale + this.diagram.config.leftPaneWidth - this.diagram.config.scrollX;\n    }\n    getTimeByX(x: number): number {\n        return (x - this.diagram.config.leftPaneWidth + this.diagram.config.scrollX) / this.diagram.config.xScale;\n    }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"diagram-view\"},[_c('stage',{staticClass:\"diagram-view-stage\",on:{\"stationNameInputStart\":_vm.onStationNameInputStart,\"trackNameInputStart\":_vm.onTrackNameInputStart,\"trainInfoEditStart\":_vm.onTrainInfoEditStart,\"trainInfoEditEnd\":_vm.onTrainInfoEditEnd}}),_c('div',{staticClass:\"diagram-view-ui\"},[_c('station-name-input',{ref:\"stationNameInput\"}),_c('track-name-input',{ref:\"trackNameInput\"}),_c('train-info-editor',{ref:\"trainInfoEditor\"}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-expand-button',{key:(\"station-expand-button-\" + (s.id)),attrs:{\"station\":s},on:{\"trackNameInputStart\":_vm.onTrackNameInputStart}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-remove-button',{key:(\"station-remove-button-\" + (s.id)),attrs:{\"station\":s}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-add-track-button',{key:(\"station-add-track-button-\" + (s.id)),attrs:{\"station\":s},on:{\"trackNameInputStart\":_vm.onTrackNameInputStart}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _vm._l((s.tracks),function(t){return _c('station-remove-track-button',{key:(\"station-remove-track-button-\" + (s.id) + \"-\" + (t.id)),attrs:{\"station\":s,\"track\":t}})})})],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.diagram)?_c('v-stage',{attrs:{\"config\":_vm.stageConfig},on:{\"mousedown\":_vm.onStageMouseDown,\"mousemove\":_vm.onStageMouseMove,\"click\":_vm.onStageClick,\"dblclick\":_vm.onStageDoubleClick,\"wheel\":_vm.onStageMouseWheel,\"contextmenu\":_vm.onContextMenu,\"touchend\":_vm.onTouchEnd}},[_c('back-layer',_vm._g({},_vm.$listeners)),_c('train-path-layer',_vm._g({},_vm.$listeners)),_c('v-layer',[_c('pointer')],1)],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-layer',{attrs:{\"id\":\"back-layer\"}},[_vm._l((_vm.timeGridLines),function(t){return _c('v-group',{key:t.key},[_c('v-line',{attrs:{\"config\":t.lineConfig}}),(t.labelConfig)?_c('v-text',{attrs:{\"config\":t.labelConfig}}):_vm._e()],1)}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-group',_vm._g({key:(\"station-\" + (s.id)),attrs:{\"station\":s}},_vm.$listeners))})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[(_vm.isTopLineIntersectingPlotPane)?_c('v-group',[_c('v-line',{attrs:{\"config\":_vm.topLineConfig}}),_vm._l((_vm.labelCharacters),function(c){return _c('v-text',{key:c.key,attrs:{\"config\":c}})}),_c('v-rect',{attrs:{\"config\":_vm.labelRectConfig},on:{\"click\":_vm.onStationLabelClick,\"mousedown\":_vm.onStationLabelMouseDown}})],2):_vm._e(),(_vm.station.expanded && _vm.isBottomLineIntersectingPlotPane)?_c('v-line',{attrs:{\"config\":_vm.bottomLineConfig}}):_vm._e(),(_vm.station.expanded)?_vm._l((_vm.station.tracks),function(t){return _c('track-group',_vm._g({key:(\"track-\" + (_vm.station.id) + \"-\" + (t.id)),attrs:{\"station\":_vm.station,\"track\":t}},_vm.$listeners))}):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isLineIntersectingPlotPane)?_c('v-group',[_c('v-line',{attrs:{\"config\":_vm.lineConfig}}),_c('v-text',{attrs:{\"config\":_vm.labelConfig},on:{\"click\":_vm.onLabelClick,\"mousedown\":_vm.onLabelMouseDown}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Station from \"@/data/Station\";\nimport Track from \"@/data/Track\";\nimport { KonvaEventObject } from \"konva/types/Node\";\n\n@Component\nexport default class TrackGroup extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n  @Prop() private station!: Station;\n  @Prop() private track!: Track;\n\n  private dragState: { sy0: number, index0: number, dragging: boolean } | null = null;\n\n  private get lineConfig(): unknown {\n    return {\n      points: [\n        this.viewConfig.stationLabelLeftMargin + this.viewConfig.trackLabelLeftMargin, \n        this.context.getYByRelY(this.track.relY), \n        this.viewState.viewWidth, \n        this.context.getYByRelY(this.track.relY)\n      ],\n      stroke: this.viewConfig.trackLineColor,\n      strokeWidth: this.viewConfig.trackLineWidth,\n      listening: false,\n    }\n  }\n\n  private get labelConfig(): unknown {\n    return {\n      id: `track-label-${this.station.id}-${this.track.id}`,\n      x: this.viewConfig.stationLabelLeftMargin + this.viewConfig.trackLabelLeftMargin,\n      y: this.context.getYByRelY(this.track.relY) - this.viewConfig.trackLabelFontSize,\n      width: this.diagram.config.leftPaneWidth - this.viewConfig.stationLabelLeftMargin - this.viewConfig.trackLabelLeftMargin - this.viewConfig.stationLabelRightMargin,\n      height: this.viewConfig.trackLabelFontSize,\n      text: this.track.name,\n      fontSize: this.viewConfig.trackLabelFontSize,\n      fontFamily: this.viewConfig.fontFamily,\n      fill: this.viewConfig.trackLabelColor,\n      align: \"left\",\n      verticalAlign: \"bottom\",\n    }\n  }\n\n  private get isLineIntersectingPlotPane(): boolean {\n    return this.context.getYByRelY(this.track.relY) >= this.viewConfig.topPaneHeight && \n      this.context.getYByRelY(this.track.relY) < this.viewState.viewHeight;\n  }\n\n  private onLabelClick(): void {\n    if (this.viewState.editMode && !this.viewState.busy && !this.dragState?.dragging) {\n      this.viewState.trackNameInputTarget = this.track;\n      this.$emit(\"trackNameInputStart\");\n    }\n  }\n\n  private onLabelMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewState.editMode) {\n      this.dragState = { \n        sy0: konvaEvent.evt.screenY, \n        index0: this.station.tracks.indexOf(this.track), \n        dragging: false \n      };\n      window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    }\n  }\n\n  private onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState) {\n      if (Math.abs(event.screenY - this.dragState.sy0) > 1) {\n        this.dragState.dragging = true;\n      }\n      if (this.dragState.dragging) {\n        this.station.removeTrack(this.track);\n\n        const mouseRelY = this.context.getRelYByY(event.clientY);\n        const newIndex = this.station.tracks.findIndex(t => mouseRelY < t.relY);\n        if (newIndex < 0) {\n          this.station.tracks.push(this.track);\n        } else {\n          this.station.tracks.splice(newIndex, 0, this.track);\n        }\n        this.diagram.updateY();\n      }\n    }\n  }\n\n  private onWindowMouseUp(event: MouseEvent): void {\n    if (this.dragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      this.onWindowMouseMove(event);\n\n      const index0 = this.dragState.index0;\n      const index1 = this.station.tracks.indexOf(this.track);\n      if (index0 != index1) {\n        this.context.history.push({\n          this: this,\n          undo: () => { \n            this.station.removeTrack(this.track); \n            this.station.addNewTrack(this.track, index0); \n          },\n          redo: () => {\n            this.station.removeTrack(this.track); \n            this.station.addNewTrack(this.track, index1); \n          }\n        });\n      }\n\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrackGroup.vue?vue&type=template&id=02a069c5&scoped=true&\"\nimport script from \"./TrackGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrackGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"02a069c5\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Station from \"@/data/Station\";\nimport TrackGroup from \"./TrackGroup.vue\";\nimport { KonvaEventObject } from \"konva/types/Node\";\n\n@Component({\n  components: {\n    TrackGroup\n  },\n})\nexport default class StationGroup extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n  @Prop() private station!: Station;\n\n  private dragState: { sy0: number, mileage0: number, dragging: boolean } | null = null;\n\n  private get topLineConfig(): unknown {\n    return {\n      points: [\n        0, \n        this.context.getYByRelY(this.station.topRelY), \n        this.viewState.viewWidth, \n        this.context.getYByRelY(this.station.topRelY)\n      ],\n      stroke: this.viewConfig.stationLineColor,\n      strokeWidth: this.viewConfig.stationLineWidth,\n      listening: false,\n    }\n  }\n\n  private get bottomLineConfig(): unknown {\n    return {\n      points: [\n        0, \n        this.context.getYByRelY(this.station.bottomRelY), \n        this.viewState.viewWidth, \n        this.context.getYByRelY(this.station.bottomRelY)\n      ],\n      stroke: this.viewConfig.stationLineColor,\n      strokeWidth: this.viewConfig.stationLineWidth,\n      listening: false,\n    }\n  }\n\n  private get labelRectConfig(): unknown {\n    return {\n      id: `station-label-${this.station.id}`,\n      x: this.viewConfig.stationLabelLeftMargin,\n      y: this.context.getYByRelY(this.station.topRelY) - this.viewConfig.stationLabelFontSize,\n      width: this.diagram.config.leftPaneWidth - this.viewConfig.stationLabelLeftMargin - this.viewConfig.stationLabelRightMargin,\n      height: this.viewConfig.stationLabelFontSize,\n    };\n  }\n\n  private get labelCharacters(): unknown {\n    const widthForChars = this.diagram.config.leftPaneWidth - this.viewConfig.stationLabelLeftMargin - this.viewConfig.stationLabelRightMargin - this.viewConfig.stationLabelFontSize;\n    const stationName = this.station.name || \"\";\n    const charSpan = stationName.length > 1 ? widthForChars / (stationName.length - 1) : 0;\n    return Array.from(stationName).map((c, index) => {\n      return {\n        key: `station-label-${this.station.id}-${index}`,\n        x: stationName.length > 1 ? \n            this.viewConfig.stationLabelLeftMargin + index * charSpan :\n            this.viewConfig.stationLabelLeftMargin + widthForChars * 0.5,\n        y: this.context.getYByRelY(this.station.topRelY) - this.viewConfig.stationLabelFontSize,\n        height: this.viewConfig.stationLabelFontSize,\n        text: c,\n        fontSize: this.viewConfig.stationLabelFontSize,\n        fontFamily: this.viewConfig.fontFamily,\n        fill: this.viewConfig.stationLabelColor,\n        align: \"left\",\n        verticalAlign: \"bottom\",\n      }\n    });\n  }\n\n  private get isTopLineIntersectingPlotPane(): boolean {\n    return this.context.getYByRelY(this.station.topRelY) >= this.viewConfig.topPaneHeight && \n      this.context.getYByRelY(this.station.topRelY) < this.viewState.viewHeight;\n  }\n\n  private get isBottomLineIntersectingPlotPane(): boolean {\n    return this.context.getYByRelY(this.station.bottomRelY) >= this.viewConfig.topPaneHeight && \n      this.context.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  private onStationLabelClick(): void {\n    if (this.viewState.editMode && !this.viewState.busy && !this.dragState?.dragging) {\n      this.viewState.stationNameInputTarget = this.station;\n      this.$emit(\"stationNameInputStart\");\n    }\n  }\n\n  private onStationLabelMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewState.editMode && !this.viewState.inputEnabled) {\n      this.dragState = {\n        sy0: konvaEvent.evt.screenY,\n        mileage0: this.station.mileage,\n        dragging: false,\n      };\n      window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    }\n  }\n\n  private onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState) {\n      if (Math.abs(event.screenY - this.dragState.sy0) > 1) {\n        this.dragState.dragging = true;\n      }\n      if (this.dragState.dragging) {\n        this.station.mileage = this.dragState.mileage0 + (event.screenY - this.dragState.sy0) / this.diagram.config.yScale;\n        this.diagram.updateY();\n      }\n    }\n  }\n\n  private onWindowMouseUp(event: MouseEvent): void {\n    if (this.dragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      this.onWindowMouseMove(event);\n\n      if (this.dragState.dragging) {\n        const mileage0 = this.dragState.mileage0;\n        const mileage1 = this.station.mileage;\n        this.context.history.push({\n          this: this,\n          undo: () => { this.station.mileage = mileage0; },\n          redo: () => { this.station.mileage = mileage1; }\n        });\n      }\n\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationGroup.vue?vue&type=template&id=5816eadb&scoped=true&\"\nimport script from \"./StationGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5816eadb\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport StationGroup from \"./StationGroup.vue\";\n\n@Component({\n  components: {\n    StationGroup\n  },\n})\nexport default class BackLayer extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  private get timeGridLines(): unknown {\n    const lines = [];\n    const scrollLeftTime = this.diagram.config.scrollX / this.diagram.config.xScale;\n    let t = Math.ceil(scrollLeftTime / this.viewConfig.minorMinutelyGridLineSpan) * this.viewConfig.minorMinutelyGridLineSpan;\n    let x = this.context.getXByTime(t);\n    while (x < this.viewState.viewWidth) {\n      lines.push({\n        key: `time-grid-line-${lines.length}`,\n        lineConfig: {\n          points: [\n            x,\n            this.viewConfig.topPaneHeight,\n            x,\n            this.viewState.viewHeight\n          ],\n          stroke:\n            t % 3600 == 0 ? this.viewConfig.hourlyGridLineColor :\n            t % this.viewConfig.majorMinutelyGridLineSpan == 0 ? this.viewConfig.majorMinutelyGridLineColor :\n            this.viewConfig.minorMinutelyGridLineColor,\n          strokeWidth: \n            t % 3600 == 0 ? this.viewConfig.hourlyGridLineWidth :\n            t % this.viewConfig.majorMinutelyGridLineSpan == 0 ? this.viewConfig.majorMinutelyGridLineWidth :\n            this.viewConfig.minorMinutelyGridLineWidth,\n          listening: false,\n        },\n        labelConfig: t % 3600 != 0 ? null : {\n          x: x - this.viewConfig.hourlyLabelFontSize,\n          y: this.viewConfig.topPaneHeight - this.viewConfig.hourlyLabelBottomMargin - this.viewConfig.hourlyLabelFontSize,\n          width: this.viewConfig.hourlyLabelFontSize * 2,\n          height: this.viewConfig.hourlyLabelFontSize,\n          text: `${ t / 3600 % 24 }`,\n          fontSize: this.viewConfig.hourlyLabelFontSize,\n          fontFamily: this.viewConfig.fontFamily,\n          fill: this.viewConfig.hourlyLabelColor,\n          align: \"center\",\n          verticalAlign: \"bottom\",\n        }\n      });\n      t += this.viewConfig.minorMinutelyGridLineSpan;\n      x = this.context.getXByTime(t);\n    }\n    return lines;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BackLayer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BackLayer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./BackLayer.vue?vue&type=template&id=c5c3815c&scoped=true&\"\nimport script from \"./BackLayer.vue?vue&type=script&lang=ts&\"\nexport * from \"./BackLayer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c5c3815c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.pointerEnabled)?_c('v-group',[_c('v-rect',{attrs:{\"config\":_vm.rectConfig}}),_c('v-text',{attrs:{\"config\":_vm.labelConfig}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export function getTimeText(time: number, forceSec?: boolean): string {\n    const hStr = `${Math.floor(time / 3600)}`;\n    const mmStr = `${Math.floor(time / 60) % 60}`.padStart(2, \"0\");\n    const ssStr = `${time % 60}`.padStart(2, \"0\");\n    return time % 60 != 0 || forceSec ? `${hStr}:${mmStr}:${ssStr}` : `${hStr}:${mmStr}`;\n}\n\nconst canvas = document.createElement(\"canvas\");\nconst ctx = canvas.getContext(\"2d\");\nexport function getTextWidth(text: string, fontFamily: string, fontSize: number): number {\n    if (!ctx) return 0;\n    ctx.font = `${fontSize}px ${fontFamily}`;\n    return ctx.measureText(text).width;\n}\n","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport { getTimeText } from \"@/utils\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\n\n@Component\nexport default class TrainPathGroup extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  private get pointerEnabled(): unknown {\n    return this.viewState.pointerTargetLine && !this.viewState.pointerTargetTrainPath &&\n      !this.viewState.trainPathDragState && !this.viewState.drawingState;\n  }\n\n  private get rectConfig(): unknown {\n    const width = this.viewState.drawingState ? this.viewConfig.selectedTrainPathMarkerWidth : this.viewConfig.pointerWidth;\n    return {\n      x: this.context.getXByTime(this.viewState.pointerTime) - width * 0.5,\n      y: this.viewState.pointerY - width * 0.5,\n      width: width,\n      height: width,\n      fill: this.viewConfig.pointerColor,\n      listening: false,\n    };\n  }\n\n  private get labelConfig(): unknown {\n    const time = this.viewState.pointerTime >= 0 ? \n      this.viewState.pointerTime : \n      this.viewState.pointerTime + Math.ceil(-this.viewState.pointerTime / 3600) * 3600;\n    return {\n      x: this.context.getXByTime(this.viewState.pointerTime),\n      y: this.viewState.pointerY - this.viewConfig.pointerLabelFontSize,\n      height: this.viewConfig.pointerLabelFontSize,\n      text: getTimeText(time, this.viewState.pointerPreciseState != null),\n      fontSize: this.viewConfig.pointerLabelFontSize,\n      fontFamily: this.viewConfig.fontFamily,\n      fill: this.viewConfig.pointerColor,\n      align: \"left\",\n      verticalAlign: \"bottom\",\n      listening: false,\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pointer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pointer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Pointer.vue?vue&type=template&id=15f49962&scoped=true&\"\nimport script from \"./Pointer.vue?vue&type=script&lang=ts&\"\nexport * from \"./Pointer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"15f49962\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-layer',{ref:\"trainPathLayer\",attrs:{\"id\":\"train-path-layer\",\"config\":_vm.layerConfig}},[_vm._l((Object.values(_vm.diagram.trains).filter(function (t) { return !_vm.viewState.trainSelections[t.id]; })),function(t){return _c('train-path-group',_vm._g({key:(\"train-\" + (t.id)),attrs:{\"train\":t}},_vm.$listeners))}),_vm._l((Object.values(_vm.diagram.trains).filter(function (t) { return _vm.viewState.trainSelections[t.id]; })),function(t){return _c('train-path-group',_vm._g({key:(\"train-\" + (t.id)),attrs:{\"train\":t}},_vm.$listeners))})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[_c('v-text',{ref:\"trainNameLabel\",attrs:{\"config\":_vm.trainNameLabelConfig},on:{\"click\":_vm.onTrainNameLabelClick}}),_c('v-line',{attrs:{\"config\":_vm.regularTrainPathConfig},on:{\"click\":_vm.onTrainPathClick,\"mousemove\":_vm.onTrainPathMouseMove,\"tap\":_vm.onTrainPathTap}}),(_vm.selectedTrainPathEnabled)?[_c('v-line',{attrs:{\"config\":_vm.selectedTrainPathConfig},on:{\"click\":_vm.onSelectedTrainPathClick,\"dblclick\":_vm.onSelectedTrainPathDoubleClick,\"mousedown\":_vm.onSelectedTrainPathMouseDown,\"mousemove\":_vm.onSelectedTrainPathMouseMove}}),_vm._l((_vm.selectedTrainPathNodes),function(n){return _c('train-path-marker',{key:(\"marker-\" + (_vm.train.id) + \"-\" + (n.stev.privateId) + \"-\" + (n.phase)),attrs:{\"trainPathNode\":n},on:{\"click\":_vm.onMarkerClick,\"mousedown\":_vm.onMarkerMouseDown}})})]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[_c('v-rect',{attrs:{\"config\":_vm.rectConfig},on:{\"click\":function($event){return _vm.$emit('click', $event, _vm.trainPathNode)},\"mousemove\":_vm.onRectMouseMove,\"mousedown\":function($event){return _vm.$emit('mousedown', $event, _vm.trainPathNode)},\"dblclick\":_vm.onRectDoubleClick}}),(_vm.labelEnabled)?_c('v-text',{attrs:{\"config\":_vm.labelConfig}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport { getTimeText } from \"@/utils\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport TrainPathNode from \"@/data/TrainPathNode\";\n\n@Component\nexport default class TrainPathMarker extends Vue {\n  @InjectReactive() context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n  @Prop() trainPathNode!: TrainPathNode;\n\n  get rectConfig(): unknown {\n    return {\n      x: this.context.getXByTime(this.trainPathNode.time) - this.viewConfig.selectedTrainPathMarkerWidth * 0.5,\n      y: this.context.getYByRelY(this.trainPathNode.relY) - this.viewConfig.selectedTrainPathMarkerWidth * 0.5,\n      width: this.viewConfig.selectedTrainPathMarkerWidth,\n      height: this.viewConfig.selectedTrainPathMarkerWidth,\n      fill: this.trainPathNode.stev.train.color || this.viewConfig.trainPathColor,\n    };\n  }\n\n  get labelEnabled(): boolean {\n    return this.trainPathNode.phase == \"track\";\n  }\n\n  get labelConfig(): unknown {\n    const labelPosition = this.getLabelPosition();\n    return {\n      x: this.context.getXByTime(this.trainPathNode.time) + labelPosition.x - this.viewConfig.markerLabelFontSize * 8,\n      y: this.context.getYByRelY(this.trainPathNode.relY) + labelPosition.y - this.viewConfig.markerLabelLineHeight,\n      width: this.viewConfig.markerLabelFontSize * 8,\n      height: this.viewConfig.markerLabelLineHeight,\n      text: getTimeText(this.trainPathNode.time, this.viewState.pointerPreciseState != null),\n      fontSize: this.viewConfig.pointerLabelFontSize,\n      fontFamily: this.viewConfig.fontFamily,\n      fill: this.trainPathNode.stev.train.color || this.viewConfig.trainPathColor,\n      align: \"right\",\n      verticalAlign: \"bottom\",\n      listening: false,\n    }\n  }\n\n  getLabelPosition(): { x: number, y: number } {\n    const thisStev = this.trainPathNode.stev;\n    const prevStev = thisStev.prev;\n    const nextStev = thisStev.next;\n    if (prevStev && prevStev.track != thisStev.track && (!nextStev || nextStev.track == thisStev.track)) {\n      const thisRelY = prevStev.station.mileage < thisStev.station.mileage ? thisStev.station.topRelY : thisStev.station.bottomRelY;\n      const prevRelY = prevStev.station.mileage < thisStev.station.mileage ? prevStev.station.bottomRelY : prevStev.station.topRelY;\n      const x = thisRelY == prevRelY ? 0:\n        -this.viewConfig.markerLabelLineHeight *\n        ((thisStev.time - prevStev.time) * this.diagram.config.xScale) /\n        Math.abs(thisRelY - prevRelY);\n      return {\n        x: Math.max(x, -this.viewConfig.markerLabelMaxDistance),\n        y: prevStev.station.mileage < thisStev.station.mileage ? 0 : this.viewConfig.markerLabelLineHeight\n      };\n    }\n\n    return {\n      x: 0,\n      y: nextStev && nextStev.station.mileage < thisStev.station.mileage || prevStev && prevStev.station.mileage > thisStev.station.mileage ? 0 : this.viewConfig.markerLabelLineHeight,\n    };\n  }\n\n  onRectMouseMove(): void {\n    this.viewState.pointerTargetTrainPath = {\n      train: this.trainPathNode.stev.train,\n      stevRange: { from: this.trainPathNode.stev, to: this.trainPathNode.stev }\n    };\n  }\n\n  onRectDoubleClick(): void {\n    if (this.viewState.editMode) {\n      if (!this.viewState.drawingState) {\n        const n = this.trainPathNode;\n        if (!n.stev.next || !n.stev.prev) {\n          this.viewState.drawingState = {\n            train: n.stev.train,\n            lastStev: n.stev,\n            direction:\n              !n.stev.next && !n.stev.prev ? 0 :\n              !n.stev.next ? 1 : -1,\n            stableEnd: n.stev,\n            floating: null\n          };\n          this.viewState.trainSelections[n.stev.train.id].stevRange = null;\n        }\n      } else {\n        this.viewState.drawingState = null;\n        this.viewState.trainSelections = {};\n      }\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathMarker.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathMarker.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathMarker.vue?vue&type=template&id=1ecd7eac&scoped=true&\"\nimport script from \"./TrainPathMarker.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathMarker.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1ecd7eac\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport { getTextWidth } from \"@/utils\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Station from \"@/data/Station\";\nimport StopEvent, { StopEventRange } from \"@/data/StopEvent\";\nimport Track from \"@/data/Track\";\nimport Train from \"@/data/Train\";\nimport TrainPathMarker from \"./TrainPathMarker.vue\";\nimport TrainPathNode from \"@/data/TrainPathNode\";\n\n@Component({\n  components: {\n    TrainPathMarker\n  },\n})\nexport default class TrainPathGroup extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  @Prop() private train!: Train;\n\n  dragState: { \n    t0: number, \n    y0: number,\n    sx0: number, \n    sy0: number,\n    track0: Track | null,\n    minTimeShift: number,\n    maxTimeShift: number,\n    changeTimeTargets: StopEvent[] | null,\n    changeTrackTargets: StopEvent[] | null,\n  } | null = null;\n\n  get trainNameLabelConfig(): unknown {\n    const sel = this.viewState.trainSelections[this.train.id];\n    return {\n      ref: `train-name-label-${this.train.id}`,\n      visible:\n        !this.viewState.trainInfoEditorTarget && (\n          Object.keys(this.viewState.trainSelections).length == 0 || \n          (!!sel && !this.viewState.controlKeyPressed)\n        ),\n      text: this.trainNameLabelText, \n      ...this.trainNameLabelRect,\n      fontSize: this.viewConfig.trainNameLabelFontSize,\n      fontFamily: this.viewConfig.fontFamily,\n      fill: this.train.color || this.viewConfig.trainPathColor,\n    };\n  }\n\n  get trainNameLabelText(): string {\n    return this.train.name || `#${this.train.id}`;\n  }\n\n  get trainNameLabelRect(): { x: number, y: number, width: number, height: number, rotation: number } {\n    const text = this.trainNameLabelText;\n    const textWidth = getTextWidth(text, this.viewConfig.fontFamily, this.viewConfig.trainNameLabelFontSize);\n\n    const nodes = \n      this.viewState.trainPathDragState?.targets[this.train.id] && this.viewState.controlKeyPressed ?\n        this.selectedTrainPathNodes : this.regularTrainPathNodes;\n    const firstNodeRunning = \n      nodes.find((n, i) => i < nodes.length - 1 && nodes[i + 1].stev.station != n.stev.station) ??\n      nodes[0];\n    let segDYToDX = NaN;\n    for (const forwardNode of nodes.slice(nodes.indexOf(firstNodeRunning) + 1)) {\n      const dx = forwardNode.x - firstNodeRunning.x;\n      const dy = forwardNode.y - firstNodeRunning.y;\n      const dy2dx = dx != 0 ? dy / dx : Math.sign(dy) * Infinity;\n      if (isNaN(segDYToDX) || Math.sign(dy2dx) == Math.sign(segDYToDX) && Math.abs(dy2dx) < Math.abs(segDYToDX)) {\n        segDYToDX = dy2dx;\n      }\n      if (Math.hypot(dx, dy) >= textWidth) break;\n    }\n\n    if (!isNaN(segDYToDX)) {\n      const segDXToD = Math.sqrt(1 / (1 + segDYToDX * segDYToDX));\n      const segDYToD = segDXToD != 0 ? segDXToD * segDYToDX : 1;\n      const x = segDYToDX >= 0 ?\n        segDYToD * this.viewConfig.trainNameLabelFontSize + firstNodeRunning.x : \n        -segDYToD * (this.viewConfig.trainNameLabelLineHeight - this.viewConfig.trainNameLabelFontSize) + firstNodeRunning.x;\n      const y = segDYToDX >= 0 ?\n        -segDXToD * this.viewConfig.trainNameLabelFontSize + firstNodeRunning.y : \n        segDXToD * (this.viewConfig.trainNameLabelLineHeight - this.viewConfig.trainNameLabelFontSize) + firstNodeRunning.y;\n      const rotation = Math.atan(segDYToDX) / Math.PI * 180;\n      return { \n        x, y, rotation,\n        width: textWidth,\n        height: this.viewConfig.trainNameLabelFontSize,\n      };\n    } else {\n      return { \n        x: firstNodeRunning.x, \n        y: firstNodeRunning.y, \n        rotation: 0,\n        width: textWidth,\n        height: this.viewConfig.trainNameLabelFontSize,\n      };\n    }\n  }\n\n  get regularTrainPathConfig(): unknown {\n    const strokeWidth = this.train.lineWidth ?? this.viewConfig.trainPathWidth;\n    return {\n      points: this.regularTrainPathNodes.flatMap(n => [n.x, n.y]),\n      stroke: this.train.color || this.viewConfig.trainPathColor,\n      opacity: Object.keys(this.viewState.trainSelections).length > 0 ? this.viewConfig.unselectedTrainPathOpacity : 1,\n      strokeWidth,\n      hitStrokeWidth: Math.max(strokeWidth, this.viewConfig.minHitWidth * 2),\n    }\n  }\n\n  get regularTrainPathNodes(): (TrainPathNode & { x: number, y: number })[] {\n    const nodes = this.getTrainPathNodes();\n\n    const dragState = this.viewState.trainPathDragState;\n    const dragTarget = dragState?.targets[this.train.id];\n    if (dragState && dragTarget && !this.viewState.controlKeyPressed) {\n      let inRange = !dragTarget.stevRange;\n      for (const node of nodes) {\n        if (node.stev == dragTarget.stevRange?.from || node.stev == dragTarget.stevRange?.to) inRange = true;\n        if (inRange) {\n          node.time += dragState.timeShift;\n          node.x = this.context.getXByTime(node.time);\n        }\n        if (node.stev == dragTarget.stevRange?.to) inRange = false;\n      }\n    }\n\n    return nodes;\n  }\n\n  get selectedTrainPathEnabled(): boolean {\n    return this.viewState.trainSelections[this.train.id] != null;\n  }\n\n  get selectedTrainPathConfig(): unknown {\n    const strokeWidth = (this.train.lineWidth ?? this.viewConfig.trainPathWidth) + (this.viewConfig.selectedTrainPathWidthScale - 1);\n    return {\n      points: this.selectedTrainPathNodes.flatMap(n => [n.x, n.y]),\n      stroke: this.train.color || this.viewConfig.trainPathColor,\n      strokeWidth,\n      hitStrokeWidth: Math.max(strokeWidth, this.viewConfig.minHitWidth * 2)\n    };\n  }\n\n  get selectedTrainPathNodes(): (TrainPathNode & { x: number, y: number })[] {\n    const stevRange = \n      this.viewState.trainPathDragState?.targets[this.train.id]?.stevRange ??\n      this.viewState.trainSelections[this.train.id].stevRange;\n    let inRange = !stevRange;\n    const nodes = this.getTrainPathNodes().filter(n => {\n      if (n.stev == stevRange?.from || n.stev == stevRange?.to) inRange = true;\n      const nInRange = inRange;\n      if (n.stev == stevRange?.to) inRange = false;\n      return nInRange;\n    });\n\n    if (this.viewState.trainPathDragState) {\n      for (const node of nodes) {\n        node.time += this.viewState.trainPathDragState.timeShift;\n        node.x = this.context.getXByTime(node.time);\n      }\n    }\n\n    return nodes;\n  }\n\n  getTrainPathNodes(): (TrainPathNode & { x: number, y: number })[] {\n    return this.train.getTrainPathNodes().map(n => { \n      return { ...n, x: this.context.getXByTime(n.time), y: this.context.getYByRelY(n.relY) };\n    });\n  }\n\n  onTrainNameLabelClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget) {\n      if (this.viewState.editMode && this.viewState.trainSelections[this.train.id] && !this.viewState.trainSelections[this.train.id].stevRange) {\n        this.viewState.trainInfoEditorTarget = {\n          train: this.train,\n          x: this.trainNameLabelRect.x,\n          y: this.trainNameLabelRect.y,\n          verticalAlign: this.trainNameLabelRect.rotation >= 0 ? \"top\" : \"bottom\"\n        };\n        this.$emit(\"trainInfoEditStart\");\n      } else {\n        if (!konvaEvent.evt.shiftKey) {\n          this.viewState.trainSelections = {};\n        }\n        this.$set(this.viewState.trainSelections, this.train.id, { train: this.train, stevRange: null });\n      }\n    }\n  }\n\n  onTrainPathMouseMove(): void {\n    this.viewState.pointerTargetTrainPath = null;\n  }\n\n  onSelectedTrainPathMouseMove(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    this.viewState.pointerTargetTrainPath = { \n      train: this.train, \n      stevRange: this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY)\n    };\n  }\n\n  onTrainPathClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const clickedStopRange = this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    this.changeTrainSelections(konvaEvent, clickedStopRange, false);\n  }\n\n  onSelectedTrainPathClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const clickedStopRange = this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    this.changeTrainSelections(konvaEvent, clickedStopRange, true);\n  }\n\n  onMarkerClick(konvaEvent: KonvaEventObject<MouseEvent>, trainPathNode: TrainPathNode): void {\n    const clickedStevRange = { from: trainPathNode.stev, to: trainPathNode.stev };\n    this.changeTrainSelections(konvaEvent, clickedStevRange, true);\n  }\n\n  changeTrainSelections(konvaEvent: KonvaEventObject<MouseEvent>, clickedStevRange: StopEventRange, clickSelected: boolean): void {\n    if (!this.viewState.trainPathDragState?.dragging && !this.viewState.drawingState) {\n      const sel = this.viewState.trainSelections[this.train.id];\n\n      // Remove other trains if shift not pressed\n      if (!konvaEvent.evt.shiftKey) {\n        this.viewState.trainSelections = sel ? { [this.train.id]: sel } : {};\n      }\n\n      if (!sel) {\n        this.$set(this.viewState.trainSelections, this.train.id, { train: this.train, stevRange: null });\n      } else {\n        const selectedStevRange = sel.stevRange;\n        if (!selectedStevRange) {\n          sel.stevRange = clickedStevRange;\n        } else if (!konvaEvent.evt.shiftKey) {\n          sel.stevRange = clickSelected ? clickedStevRange : null;\n        } else {\n          let selStart = false, selEnd = false, changed = false;\n          for (const stev of this.train.stevs) {\n            if (!selStart && stev == clickedStevRange.from) {\n              selectedStevRange.from = clickedStevRange.from;\n              changed = true;\n            }\n            if (stev == selectedStevRange.from) selStart = true;\n            if (stev == selectedStevRange.to) selEnd = true;\n            if (selEnd && stev == clickedStevRange.to) {\n              selectedStevRange.to = clickedStevRange.to;\n              changed = true;\n            }\n          }\n          if (!changed) {\n            this.$delete(this.viewState.trainSelections, this.train.id);\n          }\n        }\n      }\n    }\n  }\n\n  onTrainPathTap(): void {\n    this.viewState.trainSelections = { [this.train.id]: { train: this.train, stevRange: null } };\n  }\n\n  getPointedStevRange(x: number, y: number): StopEventRange {\n    if (this.train.stevs.length <= 2) {\n      return { from: this.train.stevs[0], to: this.train.stevs[this.train.stevs.length - 1] };\n    }\n\n    // TODO: more precise detection\n    for (let i = 0; i < this.train.stevs.length - 1; ++i) {\n      const thisStev = this.train.stevs[i];\n      const nextStev = this.train.stevs[i + 1];\n      const leftX = this.context.getXByTime(thisStev.time) - this.viewConfig.minHitWidth;\n      const rightX = this.context.getXByTime(nextStev.time) + this.viewConfig.minHitWidth;\n      const topY = this.context.getYByRelY(Math.min(thisStev.track.relY, nextStev.track.relY)) - this.viewConfig.minHitWidth;\n      const bottomY = this.context.getYByRelY(Math.max(thisStev.track.relY, nextStev.track.relY)) + this.viewConfig.minHitWidth;\n      if (leftX < x && x < rightX && topY < y && y < bottomY) {\n        return { from: thisStev, to: nextStev };\n      }\n    }\n    return { from: this.train.stevs[0], to: this.train.stevs[this.train.stevs.length - 1] };\n  }\n\n  onSelectedTrainPathDoubleClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewState.editMode && !this.viewState.drawingState) {\n      const targetTime = this.viewState.pointerTime;\n      const nearestStation = this.getNearestStation(konvaEvent.evt.clientY);\n      const nearestStev = this.getNearestStopEvent(targetTime);\n      if (!(nearestStation == nearestStev.station && (nearestStev.prev?.track == nearestStev.track || nearestStev.next?.track == nearestStev.track))) {\n        const index = this.train.stevs.findIndex(s => s.time > targetTime);\n        const newStev = this.train.addNewStopEvent(new StopEvent(this.train, nearestStation.tracks[0], targetTime), index);\n        this.viewState.trainSelections = { \n          [this.train.id]: {\n            train: this.train,\n            stevRange: { from: newStev, to: newStev }\n          } \n        };\n      }\n    }\n  }\n\n  getNearestStation(y: number): Station {\n    const stations = this.diagram.getStationsInMileageOrder();\n    const relY = this.context.getRelYByY(y);\n    let minSta = stations[0];\n    let minDist = Math.abs(relY - minSta.bottomRelY);\n    for (const s of stations) {\n      if (Math.abs(relY - s.topRelY) < minDist) {\n        minSta = s;\n        minDist = Math.abs(relY - s.topRelY);\n      }\n      if (Math.abs(relY - s.bottomRelY) < minDist) {\n        minSta = s;\n        minDist = Math.abs(relY - s.bottomRelY);\n      }\n    }\n    return minSta;\n  }\n\n  getNearestStopEvent(time: number): StopEvent {\n    let minStop = this.train.stevs[0];\n    let minDist = Math.abs(time - minStop.time);\n    for (const s of this.train.stevs) {\n      if (Math.abs(time - s.time) < minDist) {\n        minStop = s;\n        minDist = Math.abs(time - s.time);\n      }\n    }\n    return minStop;\n  }\n\n  onSelectedTrainPathMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (!this.viewState.editMode) {\n      return;\n    }\n\n    let minTimeShift = -86400;\n    let maxTimeShift = 86400;\n    for (const sel of Object.values(this.viewState.trainSelections)) {\n      const stevRange = sel.stevRange;\n      if (stevRange) {\n        if (stevRange.from.prev) {\n          minTimeShift = Math.max(minTimeShift, stevRange.from.prev.time - stevRange.from.time);\n        }\n        if (stevRange.to.next) {\n          maxTimeShift = Math.min(maxTimeShift, stevRange.to.next.time - stevRange.to.time);\n        }\n      }\n    }\n\n    const clickedStevRange = this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    const changeTrackTargets = \n      clickedStevRange.from == clickedStevRange.to ? [ clickedStevRange.from ] : \n      clickedStevRange.from.track == clickedStevRange.to.track ? [ clickedStevRange.from, clickedStevRange.to ] :\n      null;\n\n    const firstNode = this.selectedTrainPathNodes[0];\n    this.dragState = { \n      t0: firstNode.time, \n      y0: this.context.getYByRelY(firstNode.relY),\n      sx0: konvaEvent.evt.screenX, \n      sy0: konvaEvent.evt.screenY,\n      track0: changeTrackTargets ? changeTrackTargets[0].track : null,\n      minTimeShift: minTimeShift,\n      maxTimeShift: maxTimeShift,\n      changeTimeTargets: null,\n      changeTrackTargets: changeTrackTargets ?? null\n    };\n    this.viewState.trainPathDragState = {\n      dragging: false,\n      targets: this.viewState.trainSelections,\n      timeShift: 0\n    };\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n  }\n\n  onMarkerMouseDown(konvaEvent: KonvaEventObject<MouseEvent>, node: TrainPathNode): void {\n    if (!this.viewState.editMode) {\n      return;\n    }\n\n    this.dragState = {\n      t0: node.time,\n      y0: this.context.getYByRelY(node.relY),\n      track0: node.stev.track,\n      sx0: konvaEvent.evt.screenX,\n      sy0: konvaEvent.evt.screenY,\n      minTimeShift: node.stev.prev ? node.stev.prev.time - node.time : -86400,\n      maxTimeShift: node.stev.next ? node.stev.next.time - node.time : 86400,\n      changeTimeTargets: [ node.stev ],\n      changeTrackTargets: [ node.stev ]\n    };\n    this.viewState.trainPathDragState = {\n      dragging: false,\n      targets: { [node.stev.train.id]: { train: node.stev.train, stevRange: { from: node.stev, to: node.stev } } },\n      timeShift: 0\n    };\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState && this.viewState.trainPathDragState) {\n      if (!this.viewState.trainPathDragState.dragging && Math.hypot(event.clientX - this.dragState.sx0, event.clientY - this.dragState.sy0) > 1) {\n        this.viewState.trainPathDragState.dragging = true;\n        this.viewState.pointerY = this.dragState.y0;\n      }\n      if (this.viewState.trainPathDragState.dragging) {\n        if (!this.viewState.pointerPreciseState) {\n          this.viewState.pointerTime = this.dragState.t0 + Math.floor((event.screenX - this.dragState.sx0) / this.diagram.config.xScale / 60) * 60;\n        }\n        this.viewState.trainPathDragState.timeShift = \n          !this.viewState.controlKeyPressed ?\n            Math.min(this.dragState.maxTimeShift, Math.max(this.dragState.minTimeShift, this.viewState.pointerTime - this.dragState.t0)) :\n            this.viewState.pointerTime - this.dragState.t0;\n        if (this.dragState.changeTrackTargets) {\n          const mouseRelY = this.context.getRelYByY(event.clientY);\n          const targetStation = this.dragState.changeTrackTargets[0].station;\n          const mouseTrack = targetStation.tracks.find(t => Math.abs(t.relY - mouseRelY) < this.viewConfig.minHitWidth);\n          if (mouseTrack) {\n            for (const stev of this.dragState.changeTrackTargets) {\n              stev.track = mouseTrack;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  onWindowMouseUp(): void {\n    if (this.dragState && this.viewState.trainPathDragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      if (this.viewState.trainPathDragState.dragging) {\n        if (this.dragState.changeTrackTargets && this.dragState.track0) {\n          const targets = this.dragState.changeTrackTargets;\n          const track0 = this.dragState.track0;\n          const track1 = this.dragState.changeTrackTargets[0].track;\n          if (track0 != track1) {\n            this.context.history.push({\n              this: this,\n              undo: () => { targets.forEach(stev => stev.track = track0); },\n              redo: () => { targets.forEach(stev => stev.track = track1); }\n            });\n          }\n        }\n\n        const timeShift = this.viewState.trainPathDragState.timeShift;\n        if (timeShift != 0) {\n          if (!this.viewState.controlKeyPressed) {\n            const targets = \n              this.dragState.changeTimeTargets ??\n              Object.values(this.viewState.trainSelections).flatMap(sel => {\n                return sel.stevRange ? sel.train.getStopEventsInRange(sel.stevRange) : sel.train.stevs;\n              });\n            targets.forEach(stev => stev.time += timeShift);\n            this.context.history.push({\n              this: this,\n              undo: () => { targets.forEach(stev => stev.time -= timeShift); },\n              redo: () => { targets.forEach(stev => stev.time += timeShift); }\n            });\n          } else {\n            const newTrains = Object.values(this.viewState.trainPathDragState.targets).map(sel => {\n              const srcTrain = sel.train;\n              const srcStevs = sel.stevRange ? srcTrain.getStopEventsInRange(sel.stevRange) : srcTrain.stevs;\n              const newTrain = this.diagram.addNewTrain();\n              newTrain.color = srcTrain.color;\n              newTrain.lineWidth = srcTrain.lineWidth;\n              for (const srcStev of srcStevs) {\n                newTrain.addNewStopEvent(new StopEvent(newTrain, srcStev.track, srcStev.time + timeShift));\n              }\n              this.$delete(this.viewState.trainSelections, sel.train.id);\n              this.$set(this.viewState.trainSelections, newTrain.id, { train: newTrain, stevRange: null });\n              return newTrain;\n            });\n            this.context.history.push({\n              this: this,\n              undo: () => { newTrains.forEach(train => this.diagram.removeTrain(train)); },\n              redo: () => { newTrains.forEach(train => this.diagram.addNewTrain(train)); }\n            });\n          }\n        }\n      }\n      this.viewState.trainPathDragState = null;\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathGroup.vue?vue&type=template&id=af271fa0&scoped=true&\"\nimport script from \"./TrainPathGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"af271fa0\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport TrainPathGroup from \"./TrainPathGroup.vue\";\n\n@Component({\n  components: {\n    TrainPathGroup\n  },\n})\nexport default class BackLayer extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  // private mounted(): void {\n  //   const hitCanvas = (this.$refs.trainPathLayer as any).getNode().hitCanvas._canvas;\n  //   document.body.appendChild(hitCanvas);\n  // }\n\n  private get layerConfig(): unknown {\n    return {\n      clip: {\n        x: this.diagram.config.leftPaneWidth,\n        y: this.viewConfig.topPaneHeight,\n        width: this.viewState.viewWidth - this.diagram.config.leftPaneWidth,\n        height: this.viewState.viewHeight - this.viewConfig.topPaneHeight,\n      }\n    };\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathLayer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathLayer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathLayer.vue?vue&type=template&id=7e6e656e&scoped=true&\"\nimport script from \"./TrainPathLayer.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathLayer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7e6e656e\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport Hammer from \"hammerjs\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Station from \"@/data/Station\";\nimport StopEvent from \"@/data/StopEvent\";\nimport Track from \"@/data/Track\";\nimport Train from \"@/data/Train\";\nimport BackLayer from \"./BackLayer.vue\";\nimport Pointer from \"./Pointer.vue\";\nimport TrainPathLayer from \"./TrainPathLayer.vue\";\n\n@Component({\n  components: {\n    BackLayer, Pointer, TrainPathLayer\n  },\n})\nexport default class Stage extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  $el!: HTMLElement;\n\n  private stageDragState: { scrollX0: number, scrollY0: number, x0: number, y0: number, dragging: boolean } | null = null;\n  private pinchState: { lastScale: number } | null = null;\n\n  private get stageConfig(): unknown {\n    return {\n      width: this.viewState.viewWidth,\n      height: this.viewState.viewHeight\n    };\n  }\n\n  private get stationsInMileageOrder(): Station[] {\n    return this.diagram.getStationsInMileageOrder();\n  }\n\n  private mounted(): void {\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    document.addEventListener(\"keydown\", this.onKeyDown);\n    document.addEventListener(\"keyup\", this.onKeyUp);\n\n    const hammer = new Hammer(this.$el);\n    hammer.get(\"pan\").set({ direction: Hammer.DIRECTION_ALL });\n    hammer.get(\"pinch\").set({ enable: true });\n    hammer.on(\"panstart\", this.onPanStart);\n    hammer.on(\"panmove\", this.onPanMove);\n    hammer.on(\"panend\", this.onPanEnd);\n    hammer.on(\"pinchstart\", this.onPinchStart);\n    hammer.on(\"pinchmove\", this.onPinchMove);\n    hammer.on(\"pinchend\", this.onPinchEnd);\n  }\n\n  private unmounted(): void {\n    window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n    document.removeEventListener(\"keydown\", this.onKeyDown);\n    document.removeEventListener(\"keyup\", this.onKeyUp);\n  }\n\n  private onStageMouseMove(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const event = konvaEvent.evt;\n\n    // Update pointer state\n    this.viewState.pointerScreenX = event.screenX;\n    if (this.viewState.pointerPreciseState) {\n      const dUnit = Math.round((event.screenX - this.viewState.pointerPreciseState.sx0) / this.viewConfig.pointerPrecisePixelPerTimeUnit);\n      this.viewState.pointerTime = dUnit * this.diagram.config.minimumTimeUnit + this.viewState.pointerPreciseState.t0;\n    } else if (!this.viewState.trainPathDragState?.dragging) {\n      this.viewState.pointerTime = Math.round(this.context.getTimeByX(event.clientX) / 60) * 60;\n      if (event.clientX >= this.diagram.config.leftPaneWidth) {\n        const pointerTargetLine = this.findPointerTargetLine(event.clientY);\n        if (pointerTargetLine) {\n          this.viewState.pointerTargetLine = pointerTargetLine ?? null;\n          this.viewState.pointerY = this.context.getYByRelY(pointerTargetLine.relY);\n        } else {\n          this.viewState.pointerTargetLine = null;\n        }\n      } else {\n        this.viewState.pointerTargetLine = null;\n      }\n    }\n    if (konvaEvent.target == konvaEvent.currentTarget) {\n      this.viewState.pointerTargetTrainPath = null;\n    }\n\n    // Update drawing floating\n    const drawingState = this.viewState.drawingState;\n    if (drawingState) {\n      if (drawingState.direction > 0) {\n        this.viewState.pointerTime = Math.max(this.viewState.pointerTime, drawingState.lastStev.time);\n      } else if (drawingState.direction < 0) {\n        this.viewState.pointerTime = Math.min(this.viewState.pointerTime, drawingState.lastStev.time);\n      }\n\n      if (drawingState.floating) {\n        drawingState.train.removeStopEvent(drawingState.floating);\n        drawingState.floating = null;\n      }\n\n      const pointerTargetLine = event.clientX >= this.diagram.config.leftPaneWidth ?\n        this.findPointerTargetLine(event.clientY) : undefined;\n      if (pointerTargetLine) {\n        const targetTrack = pointerTargetLine.track ?? pointerTargetLine.station.tracks[0];\n        const newStev = drawingState.train.addNewStopEvent(\n          new StopEvent(\n            drawingState.train,\n            targetTrack,\n            this.viewState.pointerTime\n          ),\n          drawingState.direction > 0 || (drawingState.direction == 0 && this.viewState.pointerTime >= drawingState.lastStev.time) ? undefined : 0\n        );\n        drawingState.floating = newStev;\n      }\n    }\n  }\n\n  private findPointerTargetLine(y: number): { station: Station, track: Track | null, relY: number } | undefined {\n    const stationPointedOnTop = this.stationsInMileageOrder.find(s => \n      Math.abs(this.context.getYByRelY(s.topRelY) - y) < Math.max(this.viewConfig.stationLineWidth * 0.5, this.viewConfig.minHitWidth));\n    if (stationPointedOnTop) {\n      return { station: stationPointedOnTop, track: null, relY: stationPointedOnTop.topRelY };\n    }\n\n    const stationPointedOnBottom = this.stationsInMileageOrder.find(s =>\n      Math.abs(this.context.getYByRelY(s.bottomRelY) - y) < Math.max(this.viewConfig.stationLineWidth * 0.5, this.viewConfig.minHitWidth));\n    if (stationPointedOnBottom) {\n      return { station: stationPointedOnBottom, track: null, relY: stationPointedOnBottom.bottomRelY };\n    }\n\n    const station = this.stationsInMileageOrder.find(s => \n      this.context.getYByRelY(s.topRelY) + this.diagram.config.trackLineSpan - Math.max(this.viewConfig.trackLineWidth * 0.5, this.viewConfig.minHitWidth) < y &&\n      this.context.getYByRelY(s.bottomRelY) - this.diagram.config.trackLineSpan + Math.max(this.viewConfig.trackLineWidth * 0.5, this.viewConfig.minHitWidth) > y\n    );\n    if (station) {\n      const pointedTrack = station.tracks.find(t => Math.abs(this.context.getYByRelY(t.relY) - y) < Math.max(this.viewConfig.trackLineWidth * 0.5, this.viewConfig.minHitWidth));\n      if (pointedTrack) {\n        return { station, track: pointedTrack, relY: pointedTrack.relY };\n      }\n    }\n  }\n\n  private onStageClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const drawingState = this.viewState.drawingState;\n    if (drawingState) {\n      if (konvaEvent.evt.button == 0 && this.viewState.pointerTargetLine) {\n        if (drawingState.direction == 0) {\n          drawingState.direction = this.viewState.pointerTime >= drawingState.lastStev.time ? 1 : -1;\n        }\n        if (drawingState.floating){\n          const triple = drawingState.floating.track == drawingState.lastStev.track && (\n            drawingState.direction > 0 && drawingState.lastStev.track == drawingState.lastStev.prev?.track ||\n            drawingState.direction < 0 && drawingState.lastStev.track == drawingState.lastStev.next?.track\n          );\n          if (triple) {\n            drawingState.lastStev.time = this.viewState.pointerTime;\n            drawingState.train.removeStopEvent(drawingState.floating);\n          } else {\n            drawingState.lastStev = drawingState.floating;\n          }\n          drawingState.floating = null;\n        }\n      }\n      if (konvaEvent.evt.button == 2) {\n        if (drawingState.lastStev == drawingState.stableEnd) {\n          if (drawingState.floating) {\n            drawingState.train.removeStopEvent(drawingState.floating);\n          }\n          this.viewState.drawingState = null;\n        } else {\n          const newLastStev = drawingState.direction > 0 ? drawingState.lastStev.prev : drawingState.lastStev.next;\n          if (newLastStev) {\n            drawingState.train.removeStopEvent(drawingState.lastStev);\n            drawingState.lastStev = newLastStev;\n          } else {\n            this.$delete(this.diagram.trains, drawingState.train.id);\n            this.viewState.drawingState = null;\n          }\n        }\n      }\n    }\n\n    if (konvaEvent.target == konvaEvent.currentTarget && \n        !konvaEvent.evt.ctrlKey &&\n        !konvaEvent.evt.shiftKey && \n        !this.stageDragState?.dragging && \n        !this.viewState.trainPathDragState?.dragging && \n        !this.viewState.drawingState) {\n      this.viewState.trainSelections = {};\n    }\n\n    if (this.viewState.trainInfoEditorTarget && !konvaEvent.target.attrs.ref?.startsWith(\"train-name-label\")) {\n      this.$emit(\"trainInfoEditEnd\");\n    }\n  }\n\n  private onTouchEnd(konvaEvent: KonvaEventObject<TouchEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget && \n      !this.stageDragState?.dragging) { \n      this.viewState.trainSelections = {};\n    }    \n    if (this.stageDragState) {\n      this.stageDragState = null;\n    }\n  }\n\n  private onStageDoubleClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget && this.viewState.drawingState) {\n      const drawingState = this.viewState.drawingState;\n      if (drawingState.floating) {\n        drawingState.train.removeStopEvent(drawingState.floating);\n      }\n      if (drawingState.train.stevs.length <= 1) {\n        this.$delete(this.diagram.trains, drawingState.train.id);\n      } else {\n        const stableEnd = drawingState.stableEnd;\n        if (stableEnd) {\n          const stableIndex = drawingState.train.stevs.indexOf(stableEnd);\n          const addedStevs = drawingState.direction > 0 ? \n            drawingState.train.stevs.filter((e, i) => i > stableIndex) : drawingState.train.stevs.filter((e, i) => i < stableIndex);\n          if (drawingState.direction > 0) {\n            this.context.history.push({\n              this: this,\n              undo: () => { drawingState.train.stevs.splice(stableIndex + 1); },\n              redo: () => { addedStevs.forEach(stev => drawingState.train.stevs.push(stev)); }\n            });\n          } else {\n            this.context.history.push({\n              this: this,\n              undo: () => { drawingState.train.stevs.splice(0, stableIndex); },\n              redo: () => { drawingState.train.stevs = addedStevs.concat(drawingState.train.stevs); }\n            });\n          }\n        } else {\n          this.context.history.push({\n            this: this,\n            undo: () => { this.$delete(this.diagram.trains, drawingState.train.id); },\n            redo: () => { this.$set(this.diagram.trains, drawingState.train.id, drawingState.train) }\n          });\n        }\n      }\n      this.viewState.drawingState = null;\n      this.viewState.trainSelections = {};\n    } else if (konvaEvent.target == konvaEvent.currentTarget && this.viewState.editMode) {\n      if (konvaEvent.evt.clientX >= this.diagram.config.leftPaneWidth) {\n        const targetLine = this.viewState.pointerTargetLine;\n        if (targetLine && (targetLine.track || !targetLine.station.expanded)) {\n          const track = targetLine.track ?? targetLine.station.tracks[0];\n          const train = this.diagram.addNewTrain();\n          train.addNewStopEvent(new StopEvent(train, track, this.viewState.pointerTime));\n          this.viewState.trainSelections = { [train.id]: { train: train, stevRange: null } };\n          this.viewState.drawingState = {\n            train: this.diagram.trains[train.id],\n            lastStev: this.diagram.trains[train.id].stevs[0],\n            direction: 0,\n            stableEnd: null,\n            floating: null\n          };\n        }\n      } else {\n        const relY = this.context.getRelYByY(konvaEvent.evt.clientY);\n        const prevSta = this.stationsInMileageOrder.reverse().find(s => s.topRelY < relY);\n        const mileage = prevSta ?\n          (relY - prevSta.bottomRelY) / this.diagram.config.yScale + prevSta.mileage :\n          relY / this.diagram.config.yScale;\n\n        const station = this.diagram.addNewStation();\n        station.mileage = mileage;\n        this.diagram.updateY();\n\n        this.context.history.push({\n          this: this,\n          undo: () => { \n            this.$delete(this.diagram.stations, station.id);\n            this.diagram.updateY();\n          },\n          redo: () => { \n            this.$set(this.diagram.stations, station.id, station);\n            this.diagram.updateY();\n          }\n        });\n\n        this.viewState.stationNameInputTarget = station;\n        this.$emit(\"stationNameInputStart\");\n      }\n    }\n  }\n\n  private onStageMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget) {\n      this.startDrag(konvaEvent.evt.screenX, konvaEvent.evt.screenY);\n    }\n  }\n\n  private onWindowMouseMove(event: MouseEvent): void {\n    this.moveDrag(event.screenX, event.screenY);\n  }\n\n  private onWindowMouseUp(event: MouseEvent): void {\n    if (this.stageDragState) {\n      this.moveDrag(event.screenX, event.screenY);\n      this.stageDragState = null;\n    }\n  }\n\n  private onPanStart(event: { pointerType: string, center: { x: number, y: number } }): void {\n    if (event.pointerType != \"mouse\") {\n      this.startDrag(event.center.x, event.center.y);\n    }\n  }\n\n  private onPanMove(event: { pointerType: string, center: { x: number, y: number } }): void {\n    if (event.pointerType != \"mouse\") {\n      this.moveDrag(event.center.x, event.center.y);\n    }\n  }\n\n  private onPanEnd(event: { pointerType: string, center: { x: number, y: number } }): void {\n    if (event.pointerType != \"mouse\" && this.stageDragState) {\n      this.moveDrag(event.center.x, event.center.y);\n      // this.stageDragState = null;  // do in touchEnd\n    }\n  }\n\n  private startDrag(x: number, y: number): void {\n    if (!this.viewState.pointerPreciseState) {\n      this.stageDragState = {\n        scrollX0: this.diagram.config.scrollX,\n        scrollY0: this.diagram.config.scrollY,\n        x0: x,\n        y0: y,\n        dragging: false,\n      };\n    }\n  }\n\n  private moveDrag(x: number, y: number): void {\n    if (this.stageDragState) {\n      if (Math.hypot(x - this.stageDragState.x0, y - this.stageDragState.y0) > 1) {\n        this.stageDragState.dragging = true;\n      }\n      if (this.stageDragState.dragging) {\n        this.diagram.config.scrollX = \n          Math.max(this.diagram.config.minPlotTime * this.diagram.config.xScale - this.viewConfig.plotPanePadding, \n            Math.min(this.diagram.config.maxPlotTime * this.diagram.config.xScale - (this.viewState.viewWidth - this.diagram.config.leftPaneWidth - this.viewConfig.plotPanePadding),\n              this.stageDragState.scrollX0 - (x - this.stageDragState.x0)));\n        this.diagram.config.scrollY = \n          Math.max(0, Math.min(this.diagram.maxRelY - (this.viewState.viewHeight - this.viewConfig.plotPanePadding - this.viewConfig.topPaneHeight - this.diagram.config.trackLineSpan), \n            this.stageDragState.scrollY0 - (y - this.stageDragState.y0)));\n      }\n    }\n  }\n\n  private onStageMouseWheel(konvaEvent: KonvaEventObject<WheelEvent>): void {\n    // const f = Math.pow(2, -konvaEvent.evt.deltaY * this.viewConfig.wheelScale * 0.001);\n    const f = Math.pow(2, -Math.sign(konvaEvent.evt.deltaY) * this.viewConfig.wheelScale);\n    this.diagram.config.scrollX += (f - 1) * (konvaEvent.evt.clientX - this.diagram.config.leftPaneWidth + this.diagram.config.scrollX);\n    this.diagram.config.scrollY = \n      Math.max(0, Math.min(this.diagram.maxRelY + this.viewConfig.topPaneHeight - this.viewState.viewHeight,\n      this.diagram.config.scrollY + (f - 1) * (konvaEvent.evt.clientY - this.viewConfig.topPaneHeight + this.diagram.config.scrollY)));\n    this.diagram.config.xScale *= f;\n    this.diagram.config.yScale *= f;\n    this.diagram.updateY();\n    konvaEvent.evt.preventDefault();\n  }\n\n  private onPinchStart(event: { scale: number }): void {\n    this.pinchState = { lastScale: event.scale };\n  }\n\n  private onPinchMove(event: { center: { x: number, y: number }, scale: number }): void {\n    if (this.pinchState) {\n      this.diagram.config.scrollX += (event.scale / this.pinchState.lastScale - 1) * (event.center.x - this.diagram.config.leftPaneWidth + this.diagram.config.scrollX);\n      this.diagram.config.scrollY = \n        Math.max(0, Math.min(this.diagram.maxRelY + this.viewConfig.topPaneHeight - this.viewState.viewHeight,\n        this.diagram.config.scrollY + (event.scale / this.pinchState.lastScale - 1) * (event.center.y - this.viewConfig.topPaneHeight + this.diagram.config.scrollY)));\n      this.diagram.config.xScale *= event.scale / this.pinchState.lastScale;\n      this.diagram.config.yScale *= event.scale / this.pinchState.lastScale;\n      this.pinchState.lastScale = event.scale;\n      this.diagram.updateY();\n    }\n  }\n\n  private onPinchEnd(event: { center: { x: number, y: number }, scale: number }): void {\n    if (this.pinchState) {\n      this.onPinchMove(event);\n      this.pinchState = null;\n    }\n  }\n\n  private onKeyDown(event: KeyboardEvent): void {\n    if (!event.repeat) {\n      if (event.key == \"Alt\") {\n        this.viewState.pointerPreciseState = {\n          sx0: this.viewState.pointerScreenX,\n          t0: this.viewState.pointerTime\n        };\n      }\n      if (event.key == \"Control\") {\n        this.viewState.controlKeyPressed = true;\n      }\n      if (event.key == \"Delete\" && this.viewState.editMode && !this.viewState.busy) {\n        const deletingTrains: Train[] = [];\n        const deletingStevs: { stev: StopEvent, index: number }[] = [];\n        for (const sel of Object.values(this.viewState.trainSelections)) {\n          if (!sel.stevRange) {\n            deletingTrains.push(sel.train);\n          } else {\n            const fromIndex = sel.train.stevs.indexOf(sel.stevRange.from);\n            const toIndex = sel.train.stevs.indexOf(sel.stevRange.to);\n            const size = toIndex - fromIndex + 1;\n            if (size >= sel.train.stevs.length - 1) {\n              deletingTrains.push(sel.train);\n            } else {\n              for (let i = fromIndex; i <= toIndex; ++i) {\n                deletingStevs.push({ stev: sel.train.stevs[i], index: i });\n              }\n            }\n          }\n        }\n        deletingTrains.forEach(train => this.$delete(this.diagram.trains, train.id));\n        deletingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n        this.context.history.push({\n          this: this,\n          undo: () => {\n            deletingStevs.forEach(e => e.stev.train.addNewStopEvent(e.stev, e.index));\n            deletingTrains.forEach(train => this.$set(this.diagram.trains, train.id, train));\n          },\n          redo: () => {\n            deletingTrains.forEach(train => this.$delete(this.diagram.trains, train.id));\n            deletingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n          }\n        });\n        this.viewState.trainSelections = {};\n      }\n    }\n  }\n\n  private onKeyUp(event: KeyboardEvent): void {\n    if (event.key == \"Alt\") {\n      this.viewState.pointerPreciseState = null;\n    }\n    if (event.key == \"Control\") {\n      this.viewState.controlKeyPressed = false;\n    }\n  }\n\n  private onContextMenu(konvaEvent: KonvaEventObject<MouseEvent>): boolean {\n    konvaEvent.evt.preventDefault();\n    return false;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Stage.vue?vue&type=template&id=1c0ae7b8&scoped=true&\"\nimport script from \"./Stage.vue?vue&type=script&lang=ts&\"\nexport * from \"./Stage.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1c0ae7b8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.viewState.editMode && _vm.station.expanded && _vm.isBottomLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":\"plus\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Station from \"@/data/Station\";\n\n@Component\nexport default class StationAddTrackButton extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n  @Prop() private station!: Station;\n\n  private get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.viewConfig.stationLabelRightMargin}px`,\n      top: `${this.context.getYByRelY(this.station.bottomRelY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  private get isBottomLineIntersectingPlotPane(): boolean {\n    return this.context.getYByRelY(this.station.bottomRelY) >= this.viewConfig.topPaneHeight && \n      this.context.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  private onClick(): void {\n    if (!this.viewState.inputEnabled) {\n      const newTrack = this.station.addNewTrack();\n      this.diagram.updateY();\n\n      this.context.history.push({\n        this: this,\n        undo: () => { \n          this.station.removeTrack(newTrack); \n          this.diagram.updateY();\n        },\n        redo: () => { \n          this.station.addNewTrack(newTrack); \n          this.diagram.updateY();\n        }\n      });\n\n      this.viewState.trackNameInputTarget = newTrack;\n      this.$emit(\"trackNameInputStart\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationAddTrackButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationAddTrackButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationAddTrackButton.vue?vue&type=template&id=3d7d22e2&scoped=true&\"\nimport script from \"./StationAddTrackButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationAddTrackButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3d7d22e2\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isBottomLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":_vm.icon,\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Station from \"@/data/Station\";\n\n@Component\nexport default class StationExpandButton extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n  @Prop() private station!: Station;\n\n  private get icon(): string {\n    return this.station.expanded ? \"chevron-up\" : \"chevron-down\";\n  }\n\n  private get style(): unknown {\n    return {\n      left: `${this.viewConfig.stationLabelLeftMargin}px`,\n      top: `${this.context.getYByRelY(this.station.bottomRelY)}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  private get isBottomLineIntersectingPlotPane(): boolean {\n    return this.context.getYByRelY(this.station.bottomRelY) >= this.viewConfig.topPaneHeight && \n      this.context.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  private onClick(): void {\n    if (!this.viewState.inputEnabled) {\n      this.station.expanded = !this.station.expanded;\n      this.diagram.updateY();\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationExpandButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationExpandButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationExpandButton.vue?vue&type=template&id=0c63bd4d&scoped=true&\"\nimport script from \"./StationExpandButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationExpandButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0c63bd4d\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.stationNameInputTarget),expression:\"viewState.stationNameInputTarget\"}],style:(_vm.style),domProps:{\"value\":_vm.targetStation.name},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onComplete($event)},\"blur\":_vm.onComplete}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Station from \"@/data/Station\";\n\n@Component\nexport default class StationNameInput extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  $el!: HTMLInputElement;\n\n  private get targetStation(): Station | Record<string, never> {\n    return this.viewState.stationNameInputTarget ?? {};\n  }\n\n  private get style(): unknown {\n    return {\n      left: `${this.viewConfig.stationLabelLeftMargin}px`,\n      top: `${this.context.getYByRelY(this.targetStation.topRelY) - this.viewConfig.stationLabelFontSize - 4}px`,\n      width: `${this.diagram.config.leftPaneWidth - this.viewConfig.stationLabelLeftMargin - this.viewConfig.stationLabelRightMargin}px`,\n      height: `${this.viewConfig.stationLabelFontSize + 4}px`,\n      paddingTop: \"2px\",\n      lineHeight: `${this.viewConfig.stationLabelFontSize}px`,\n      border: \"none\",\n      fontSize: `${this.viewConfig.stationLabelFontSize}px`,\n    };\n  }\n\n  private onComplete(): void {\n    const targetStation = this.targetStation;\n    const name0 = this.targetStation.name;\n    const name1 = (this.$el as HTMLInputElement).value;\n    if (name0 != name1) {\n      targetStation.name = name1;\n      this.context.history.push({\n        this: this,\n        undo: () => { targetStation.name = name0; },\n        redo: () => { targetStation.name = name1; }\n      });\n    }\n    this.viewState.stationNameInputTarget = null;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationNameInput.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationNameInput.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationNameInput.vue?vue&type=template&id=b1467f1a&scoped=true&\"\nimport script from \"./StationNameInput.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationNameInput.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b1467f1a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.viewState.editMode && _vm.isTopLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":\"close\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Station from \"@/data/Station\";\nimport StopEvent from \"@/data/StopEvent\";\nimport Train from \"@/data/Train\";\n\n@Component\nexport default class StationRemoveButton extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n  @Prop() private station!: Station;\n\n  private get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.viewConfig.stationLabelRightMargin}px`,\n      top: `${this.context.getYByRelY(this.station.topRelY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  private get isTopLineIntersectingPlotPane(): boolean {\n    return this.context.getYByRelY(this.station.topRelY) >= this.viewConfig.topPaneHeight && \n      this.context.getYByRelY(this.station.topRelY) < this.viewState.viewHeight;\n  }\n\n  private onClick(): void {\n    if (!this.viewState.busy) {\n      const removingTrains: Train[] = [];\n      const removingStevs: { stev: StopEvent, index: number }[] = [];\n      for (const train of Object.values(this.diagram.trains)) {\n        for (let i = 0; i < train.stevs.length; ++i) {\n          const stev = train.stevs[i];\n          if (stev.station == this.station) {\n            removingStevs.push({ stev, index: i });\n            if (train.stevs.length <= 1) {\n              removingTrains.push(train);\n            }\n          }\n        }\n      }\n\n      removingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n      removingTrains.forEach(train => this.diagram.removeTrain(train)); \n      this.$delete(this.diagram.stations, this.station.id);\n      this.diagram.updateY();\n\n      this.context.history.push({\n        this: this,\n        undo: () => { \n          this.$set(this.diagram.stations, this.station.id, this.station);\n          removingTrains.forEach(train => this.diagram.addNewTrain(train)); \n          removingStevs.forEach(e => e.stev.train.addNewStopEvent(e.stev, e.index));\n          this.diagram.updateY();\n        },\n        redo: () => { \n          removingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n          removingTrains.forEach(train => this.diagram.removeTrain(train)); \n          this.$delete(this.diagram.stations, this.station.id); \n          this.diagram.updateY();\n        }\n      });\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationRemoveButton.vue?vue&type=template&id=5477a2e8&scoped=true&\"\nimport script from \"./StationRemoveButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationRemoveButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5477a2e8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.viewState.editMode && _vm.station.expanded && Object.values(_vm.station.tracks).length > 1 && _vm.isLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":\"close\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Station from \"@/data/Station\";\nimport StopEvent from \"@/data/StopEvent\";\nimport Track from \"@/data/Track\";\nimport Train from \"@/data/Train\";\n\n@Component\nexport default class StationRemoveTrackButton extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  @Prop() private station!: Station;\n  @Prop() private track!: Track;\n\n  private get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.viewConfig.stationLabelRightMargin}px`,\n      top: `${this.context.getYByRelY(this.track.relY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  private get isLineIntersectingPlotPane(): boolean {\n    return this.context.getYByRelY(this.track.relY) >= this.viewConfig.topPaneHeight && \n      this.context.getYByRelY(this.track.relY) < this.viewState.viewHeight;\n  }\n\n  private onClick(): void {\n    if (!this.viewState.busy) {\n      const removingTrains: Train[] = [];\n      const removingStevs: { stev: StopEvent, index: number }[] = [];\n      for (const train of Object.values(this.diagram.trains)) {\n        for (let i = 0; i < train.stevs.length; ++i) {\n          const stev = train.stevs[i];\n          if (stev.track == this.track) {\n            removingStevs.push({ stev, index: i });\n            if (train.stevs.length <= 1) {\n              removingTrains.push(train);\n            }\n          }\n        }\n      }\n      const trackIndex = this.station.tracks.indexOf(this.track);\n\n      removingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n      removingTrains.forEach(train => this.diagram.removeTrain(train)); \n      this.station.removeTrack(this.track);\n      this.diagram.updateY();\n\n      this.context.history.push({\n        this: this,\n        undo: () => { \n          this.station.addNewTrack(this.track, trackIndex); \n          removingTrains.forEach(train => this.diagram.addNewTrain(train)); \n          removingStevs.forEach(e => e.stev.train.addNewStopEvent(e.stev, e.index));\n          this.diagram.updateY();\n        },\n        redo: () => { \n          removingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n          removingTrains.forEach(train => this.diagram.removeTrain(train)); \n          this.station.removeTrack(this.track);\n          this.diagram.updateY();\n        }\n      });\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationRemoveTrackButton.vue?vue&type=template&id=9d3a3506&scoped=true&\"\nimport script from \"./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9d3a3506\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.trackNameInputTarget),expression:\"viewState.trackNameInputTarget\"}],style:(_vm.style),domProps:{\"value\":_vm.targetTrack.name},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onComplete($event)},\"blur\":_vm.onComplete}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Track from \"@/data/Track\";\n\n@Component\nexport default class TrackNameInput extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  $el!: HTMLInputElement;\n\n  private get targetTrack(): Track | Record<string, never> {\n    return this.viewState.trackNameInputTarget ?? {};\n  }\n\n  private get style(): unknown {\n    return this.viewState.trackNameInputTarget ?\n      {\n        left: `${this.viewConfig.stationLabelLeftMargin + this.viewConfig.trackLabelLeftMargin}px`,\n        top: `${this.context.getYByRelY(this.targetTrack.relY) - this.viewConfig.stationLabelFontSize - 4}px`,\n        width: `${this.diagram.config.leftPaneWidth - this.viewConfig.stationLabelLeftMargin - this.viewConfig.trackLabelLeftMargin - this.viewConfig.stationLabelRightMargin}px`,\n        height: `${this.viewConfig.stationLabelFontSize + 4}px`,\n        paddingTop: \"2px\",\n        lineHeight: `${this.viewConfig.stationLabelFontSize}px`,\n        border: \"none\",\n        fontSize: `${this.viewConfig.stationLabelFontSize}px`,\n      } : {};\n  }\n\n  private onComplete(): void {\n    const targetTrack = this.targetTrack;\n    const name0 = targetTrack.name;\n    const name1 = (this.$el as HTMLInputElement).value;\n    if (name0 != name1) {\n      targetTrack.name = name1;\n      this.context.history.push({\n        this: this,\n        undo: () => { targetTrack.name = name0; },\n        redo: () => { targetTrack.name = name1; }\n      });\n    }\n    this.viewState.trackNameInputTarget = null;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackNameInput.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackNameInput.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrackNameInput.vue?vue&type=template&id=5d75e51d&scoped=true&\"\nimport script from \"./TrackNameInput.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrackNameInput.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5d75e51d\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"train-info-editor-group\"},[_c('div',{ref:\"trainInfoEditorBox\",staticClass:\"train-info-editor-box box\",style:(_vm.trainInfoEditorBoxStyle)},[_c('input',{ref:\"trainNameInput\",staticClass:\"train-name-input\",style:(_vm.trainNameInputStyle),domProps:{\"value\":_vm.targetTrain.name},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onComplete($event)},\"blur\":_vm.onBlur}}),_c('span',{ref:\"colorPickerTrigger\",staticClass:\"color-picker picker\",style:({ background: _vm.targetTrain.color || _vm.viewConfig.trainPathColor }),on:{\"click\":_vm.onColorPickerTriggerClick}}),_c('span',{ref:\"lineWidthPickerTrigger\",staticClass:\"line-width-picker picker\",on:{\"click\":_vm.onLineWidthPickerTriggerClick}},[_c('span',{staticClass:\"line-width-picker-preview\",style:({ background: _vm.targetTrain.color || _vm.viewConfig.trainPathColor, height: ((_vm.getDispLineWidthByValue(_vm.targetTrain.lineWidth || _vm.viewConfig.trainPathWidth)) + \"px\") })})])]),_c('div',{staticClass:\"color-picker-box picker-box box\",style:(_vm.colorPickerBoxStyle)},[_c('div',[_c('span',{staticClass:\"color-picker picker\",staticStyle:{\"background\":\"#000\"},on:{\"click\":function($event){return _vm.onColorPickerClick('#000')}}})]),_c('div',_vm._l((_vm.colorPickerColors),function(c,i){return _c('span',{key:(\"train-path-color-picker-\" + i),staticClass:\"color-picker picker\",style:({ background: c }),on:{\"click\":function($event){return _vm.onColorPickerClick(c)}}})}),0)]),_c('div',{staticClass:\"line-width-picker-box picker-box box\",style:(_vm.lineWidthPickerBoxStyle)},[_c('div',_vm._l((_vm.lineWidthPickerValues),function(w,i){return _c('span',{key:(\"train-path-line-width-picker-\" + i),staticClass:\"line-width-picker picker\",on:{\"click\":function($event){return _vm.onLineWidthPickerClick(w.value)}}},[_c('span',{staticClass:\"line-width-picker-preview\",style:({ background: _vm.targetTrain.color || _vm.viewConfig.trainPathColor, height: ((w.disp) + \"px\") })})])}),0)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Train from \"@/data/Train\";\n\n@Component\nexport default class TrackNameInput extends Vue {\n  @InjectReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  $refs!: {\n    trainInfoEditorBox: HTMLElement,\n    trainNameInput: HTMLInputElement,\n    colorPickerTrigger: HTMLElement,\n    lineWidthPickerTrigger: HTMLElement,\n  };\n\n  private pickerMode: \"none\" | \"color\" | \"lineWidth\" = \"none\";\n\n  private get targetTrain(): Train | Record<string, never> {\n    return this.viewState.trainInfoEditorTarget?.train ?? {};\n  }\n\n  private get trainInfoEditorBoxTop(): number {\n    const state = this.viewState.trainInfoEditorTarget;\n    return state ?\n      state.y + (state.verticalAlign == \"bottom\" ? -this.$refs.trainInfoEditorBox.clientHeight ?? 0 : 0) :\n      this.viewState.viewHeight;\n  }\n\n  private get trainInfoEditorBoxStyle(): unknown {\n    const state = this.viewState.trainInfoEditorTarget;\n    return state ?\n      {\n        left: `${state.x}px`,\n        top: `${this.trainInfoEditorBoxTop}px`,\n      } : {\n        top: `${this.viewState.viewHeight}px`\n      };\n  }\n\n  private get trainNameInputStyle(): unknown {\n    return this.viewState.trainInfoEditorTarget ?\n      {\n        lineHeight: `${this.viewConfig.stationLabelFontSize}px`,\n        fontSize: `${this.viewConfig.stationLabelFontSize}px`,\n      } : {};\n  }\n\n  private get colorPickerBoxStyle(): unknown {\n    const state = this.viewState.trainInfoEditorTarget;\n    return state && this.pickerMode == \"color\" ?\n      {\n        left: `calc(${state.x + this.$refs.colorPickerTrigger.offsetLeft}px - 0.5rem)`,\n        top: `${this.trainInfoEditorBoxTop + this.$refs.trainInfoEditorBox.clientHeight}px`,\n      } : {\n        top: `${this.viewState.viewHeight}px`\n      };\n  }\n\n  private get colorPickerColors() {\n    return [\n      \"#ce1a34\",\n      \"#dd7d15\",\n      \"#ceae0f\",\n      \"#298e30\",\n      \"#2d75bc\",\n      \"#790894\",\n    ];\n  }\n\n  private get lineWidthPickerBoxStyle(): unknown {\n    const state = this.viewState.trainInfoEditorTarget;\n    return state && this.pickerMode == \"lineWidth\" ?\n      {\n        left: `calc(${state.x + this.$refs.lineWidthPickerTrigger.offsetLeft}px - 0.5rem)`,\n        top: `${this.trainInfoEditorBoxTop + this.$refs.trainInfoEditorBox.clientHeight}px`,\n      } : {\n        top: `${this.viewState.viewHeight}px`\n      };\n  }\n\n  private getDispLineWidthByValue(value: number) {\n    return this.lineWidthPickerValues.find(e => e.value == value)?.disp ?? value;\n  }\n\n  private get lineWidthPickerValues() {\n    return [ { value: 1, disp: 0.75 }, { value: 2, disp: 2.25 } ];\n  }\n\n  onComplete(): void {\n    this.onBlur();\n    this.viewState.trainInfoEditorTarget = null;\n    this.pickerMode = \"none\";\n  }\n\n  private onBlur(): void {\n    const state = this.viewState.trainInfoEditorTarget;\n    if (state) {\n      const targetTrain = this.targetTrain;\n      const name0 = state.train.name;\n      const name = this.$refs.trainNameInput.value;\n      if (name != name0) {\n        state.train.name = name;\n        this.context.history.push({\n          this: this,\n          undo: () => { targetTrain.name = name0; },\n          redo: () => { targetTrain.name = name; }\n        });\n      }\n    }\n  }\n\n  private onColorPickerTriggerClick(): void {\n    this.pickerMode = this.pickerMode == \"color\" ? \"none\" : \"color\";\n  }\n\n  private onLineWidthPickerTriggerClick(): void {\n    this.pickerMode = this.pickerMode == \"lineWidth\" ? \"none\" : \"lineWidth\";\n  }\n\n  private onColorPickerClick(color: string): void {\n    const targetTrain = this.targetTrain;\n    const color0 = targetTrain.color;\n    targetTrain.color = color;\n    this.context.history.push({\n      this: this,\n      undo: () => { targetTrain.color = color0; },\n      redo: () => { targetTrain.color = color; }\n    });\n  }\n\n  private onLineWidthPickerClick(lineWidth: number): void {\n    const targetTrain = this.targetTrain;\n    const lineWidth0 = targetTrain.lineWidth;\n    targetTrain.lineWidth = lineWidth;\n    this.context.history.push({\n      this: this,\n      undo: () => { targetTrain.lineWidth = lineWidth0; },\n      redo: () => { targetTrain.lineWidth = lineWidth; }\n    });\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainInfoEditor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainInfoEditor.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainInfoEditor.vue?vue&type=template&id=0986c1e1&scoped=true&\"\nimport script from \"./TrainInfoEditor.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainInfoEditor.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./TrainInfoEditor.vue?vue&type=style&index=0&id=0986c1e1&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0986c1e1\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, ProvideReactive, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"@/data/DiagramViewContext\";\nimport Stage from \"./Stage.vue\";\nimport StationAddTrackButton from \"./StationAddTrackButton.vue\";\nimport StationExpandButton from \"./StationExpandButton.vue\";\nimport StationNameInput from \"./StationNameInput.vue\";\nimport StationRemoveButton from \"./StationRemoveButton.vue\";\nimport StationRemoveTrackButton from \"./StationRemoveTrackButton.vue\";\nimport TrackNameInput from \"./TrackNameInput.vue\";\nimport TrainInfoEditor from \"./TrainInfoEditor.vue\";\n\n@Component({\n  components: {\n    Stage, \n    StationAddTrackButton, \n    StationExpandButton, \n    StationNameInput, \n    StationRemoveButton, \n    StationRemoveTrackButton, \n    TrackNameInput,\n    TrainInfoEditor\n  },\n})\nexport default class DiagramView extends Vue {\n  @Prop({ default: new DiagramViewContext() }) @ProvideReactive() private context!: DiagramViewContext;\n  private get diagram() { return this.context.diagram; }\n  private get viewConfig() { return this.context.config; }\n  private get viewState() { return this.context.state; }\n\n  $refs!: { \n    stationNameInput: StationNameInput,  \n    trackNameInput: TrackNameInput,\n    trainInfoEditor: TrainInfoEditor,\n  };\n\n  private mounted(): void {\n    const resizeObserver = new ResizeObserver(this.updateViewSize);\n    resizeObserver.observe(this.$el);\n  }\n\n  private onStationNameInputStart(): void {\n    this.$nextTick(() => this.$refs.stationNameInput.$el.focus());\n  }\n\n  private onTrackNameInputStart(): void {\n    this.$nextTick(() => this.$refs.trackNameInput.$el.focus());\n  }\n\n  private onTrainInfoEditStart(): void {\n    this.$nextTick(() => this.$refs.trainInfoEditor.$refs.trainNameInput.focus());\n  }\n\n  private onTrainInfoEditEnd(): void {\n    this.$refs.trainInfoEditor.onComplete();\n  }\n\n  private updateViewSize(): void {\n    if (this.$el) {\n      this.viewState.viewWidth = this.$el.clientWidth;\n      this.viewState.viewHeight = this.$el.clientHeight;\n        this.diagram.config.scrollX = \n          Math.max(this.diagram.config.minPlotTime * this.diagram.config.xScale - this.viewConfig.plotPanePadding, \n            Math.min(this.diagram.config.maxPlotTime * this.diagram.config.xScale - (this.viewState.viewWidth - this.diagram.config.leftPaneWidth - this.viewConfig.plotPanePadding),\n              this.diagram.config.scrollX));\n        this.diagram.config.scrollY = \n          Math.max(0, Math.min(this.context.getYByRelY(this.diagram.maxRelY), \n            this.diagram.config.scrollY));\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DiagramView.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DiagramView.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./DiagramView.vue?vue&type=template&id=4cefd6dc&scoped=true&\"\nimport script from \"./DiagramView.vue?vue&type=script&lang=ts&\"\nexport * from \"./DiagramView.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./DiagramView.vue?vue&type=style&index=0&id=4cefd6dc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4cefd6dc\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-carousel',{attrs:{\"autoplay\":false,\"indicator-inside\":false}},[_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_add_new_station.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewStationTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewStationBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_add_new_train.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewTrainTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewTrainBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_select_train.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.selectTrainTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.selectTrainBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_edit_train.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTrainTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTrainBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_edit_time.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTimeTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTimeBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_tips.png\")}}),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.tipsTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.tipsBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.contactTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.contactBody'))}})])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\n\n@Component\nexport default class HelpPane extends Vue {\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HelpView.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HelpView.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./HelpView.vue?vue&type=template&id=ec83cbc6&scoped=true&\"\nimport script from \"./HelpView.vue?vue&type=script&lang=ts&\"\nexport * from \"./HelpView.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./HelpView.vue?vue&type=style&index=0&id=ec83cbc6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ec83cbc6\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\nimport DiagramViewContext from \"./data/DiagramViewContext\";\nimport Diagram from \"./data/Diagram\";\nimport DiagramView from \"./components/DiagramView.vue\";\nimport HelpView from \"./components/HelpView.vue\";\n\n@Component({\n  components: {\n    DiagramView, HelpView\n  },\n})\nexport default class App extends Vue {\n  private context = new DiagramViewContext();\n\n  private diagramFileName = \"diagram.json\";\n  private enableSwitchEditMode = window.screen.width >= 640;\n  private subView: \"none\" | \"help\" = \"none\";\n\n  private mounted(): void {\n    this.context.state.editMode = this.enableSwitchEditMode;\n    fetch(\"sample-diagram.json\").then(async result => {\n      const json = await result.json();\n      this.context.diagram = Diagram.fromJSON(json);\n      this.diagramFileName = \"sample-diagram.json\";\n    });\n  }\n\n  private onEditButtonClick(): void {\n    this.context.state.editMode = !this.context.state.editMode;\n  }\n\n  private onUndoButtonClick(): void {\n    this.context.history.undo();\n  }\n\n  private onRedoButtonClick(): void {\n    this.context.history.redo();\n  }\n\n  private onVanishButtonClick(): void {\n    if (Object.keys(this.context.diagram.trains).length > 0) {\n      const trains = this.context.diagram.trains;\n      this.context.history.push({\n        this: this,\n        undo: () => { this.context.diagram.trains = trains; },\n        redo: () => { this.context.diagram.trains = {}; }\n      });\n      this.context.diagram.trains = {}; \n    } else {\n      const diagram = this.context.diagram;\n      this.context.history.push({\n        this: this,\n        undo: () => { this.context.diagram = diagram; },\n        redo: () => { this.context.diagram = Diagram.fromJSON({ stations: {}, trains: {} }); }\n      });\n      this.context.diagram = Diagram.fromJSON({ stations: {}, trains: {} }); \n    }\n  }\n\n  private onUploadButtonClick(): void {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \".json, application/json\";\n    input.onchange = () => {\n      const reader = new FileReader();\n      if (input.files && input.files.length > 0) {\n        const file = input.files[0];\n        reader.readAsText(file);\n        reader.onload = () => {\n          if (typeof(reader.result) == \"string\") {\n            try {\n              const data = JSON.parse(reader.result);\n              this.context.diagram = Diagram.fromJSON(data);\n              this.diagramFileName = file.name;\n              this.context.history.clear();\n            } catch (e) {\n              this.$buefy.notification.open({\n                type: \"is-danger\",\n                message: `${this.$t(\"message.failedToLoadJSON\").toString()}<br>${file.name}`,\n              });\n            }\n          }\n        };\n      }\n    };\n    input.click();\n  }\n\n  private onDownloadButtonClick(): void {\n    const json = JSON.stringify(this.context.diagram);\n    const blob = new Blob([ json ], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = this.diagramFileName;\n    a.click();\n  }\n\n  private onHelpButtonClick(): void {\n    this.subView = this.subView == \"help\" ? \"none\" : \"help\";\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=0b443b07&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\n    ja: {\n        message: {\n            failedToLoadJSON: \"ファイルの読み込みに失敗しました。\",\n            editButtonTooltip: \"編集モード\",\n            undoButtonTooltip: \"元に戻す\",\n            redoButtonTooltip: \"やり直す\",\n            vanishTrainsButtonTooltip: \"列車をクリア\",\n            vanishStationsButtonTooltip: \"駅をクリア\",\n            uploadButtonTooltip: \"ダイヤファイルを読み込む\",\n            downloadButtonTooltip: \"ダイヤファイルを保存する\",\n            helpButtonTooltip: \"操作方法\",\n            help: {\n                addNewStationTitle: \"駅を追加する\",\n                addNewStationBody: \n                    \"<p>左側の駅名エリアをダブルクリックすると、新しい駅を追加できます。</p>\" +\n                    \"<ul><li>駅名をドラッグすると、駅線の位置を調整できます。\" +\n                    \"<li>駅名をクリックすると、駅名を編集できます。\" +\n                    \"<li>駅右側の<i class='mdi mdi-close'></i>アイコンをクリックすると、駅を削除できます。</ul>\",\n                addNewTrainTitle: \"列車を追加する\",\n                addNewTrainBody:\n                    \"<p>駅線の上でダブルクリックすると、新しい列車を追加できます。駅線を続けてクリックして、停車駅を順に追加できます。</p>\" +\n                    \"<ul><li>列車線の編集を終了するには、もう一度ダブルクリックします。\" +\n                    \"<li>Altキーを押しながらカーソルを動かすと、秒単位で時刻を指定できます。\" +\n                    \"<li>右クリックすると、追加した停車駅を順に削除します。</ul>\",\n                selectTrainTitle: \"列車を選択する\",\n                selectTrainBody:\n                    \"<p>列車線をクリックすると、列車を選択できます。</p>\" +\n                    \"<ul><li>Shiftキーを押しながら別の列車線をクリックすると、複数列車を選択できます。\" +\n                    \"<li>列車を選択した状態でさらにクリックすると、特定の駅または駅間を選択できます。<br>Shiftキーを押しながらクリックすると、複数駅間を選択できます。</ul>\",\n                editTrainTitle: \"列車を編集する\",\n                editTrainBody:\n                    \"<p>列車を選択した状態では、さまざまな方法で列車を編集できます。</p>\" +\n                    \"<ul><li>列車線と駅線の交点をダブルクリックすると、停車駅を追加できます。\" +\n                    \"<li>列車線の始端・終端をダブルクリックすると、列車線を延長できます。\" +\n                    \"<li>Deleteキーを押すと、選択した区間の列車線を削除できます。</ul>\",\n                editTimeTitle: \"着発時刻を変更する\",\n                editTimeBody: \n                    \"<p>列車を選択した状態で列車線をドラッグすると、着発時刻を変更できます。</p>\" +\n                    \"<ul><li>Altキーを押しながらカーソルを動かすと、秒単位で時刻を指定できます。\" +\n                    \"<li>番線線上の列車線をドラッグすると、着発番線を変更できます。\" +\n                    \"<li>Ctrlキーを押しながらドラッグすると、着発時刻を変更する代わりに、<br>列車線をコピーして新しい列車を作成できます。</ul>\",\n                tipsTitle: \"アイコンメニュー\",\n                tipsBody: \n                    \"<ul><li><i class='mdi mdi-undo'></i><i class='mdi mdi-redo'></i>ボタンで、操作の取り消し・やり直しができます。\" +\n                    \"<li><i class='mdi mdi-vanish'></i>ボタンで、列車・駅の一括削除ができます。\" +\n                    \"<li><i class='mdi mdi-upload'></i><i class='mdi mdi-download'></i>ボタンで、データの読み込み・保存ができます。</ul>\",\n                contactTitle: \"不明点・不具合などを見つけたら\",\n                contactBody:\n                    \"<p>不明点・不具合などがありましたら、<a href='https://twitter.com/nosrithe'>@nosrithe</a> までお知らせください。</p>\" +\n                    \"<ul><li>お問い合わせの際は、操作の目的や再現手順を具体的にお伝えください。\" +\n                    \"<li>不具合などの修正は <a href='https://github.com/nosrith/diafreaks/issues'>GitHub プロジェクト</a> で管理しています。<br>既知の不具合についてはこちらをご確認ください。</ul>\"\n            },\n        },\n    },\n};\n","import Vue from \"vue\";\nimport Buefy from \"buefy\";\nimport \"buefy/dist/buefy.css\";\nimport VueI18n from \"vue-i18n\";\nimport VueKonva from \"vue-konva\";\nimport App from \"./App.vue\";\nimport messages from \"./messages\";\n\nVue.config.productionTip = false\nVue.use(Buefy, {\n  defaultNotificationDuration: 5000,\n  defaultNotificationPosition: \"is-bottom-right\",\n});\nVue.use(VueI18n);\nVue.use(VueKonva);\n\nconst i18n = new VueI18n({\n  locale: \"ja\",\n  messages,\n});\n\nnew Vue({\n  render: h => h(App),\n  i18n,\n}).$mount(\"#app\");\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HelpView.vue?vue&type=style&index=0&id=ec83cbc6&lang=scss&scoped=true&\""],"sourceRoot":""}