{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/assets/help_edit_train.png","webpack:///./src/assets/help_select_train.png","webpack:///./src/App.vue?c650","webpack:///./src/assets/help_tips.png","webpack:///./src/components/HelpPane.vue?cfbd","webpack:///./src/assets/help_edit_time.png","webpack:///./src/components/DiagramView.vue?8ddd","webpack:///./src/assets/help_add_new_train.png","webpack:///./src/assets/help_add_new_station.png","webpack:///./src/App.vue?a0b4","webpack:///./src/HistoryManager.ts","webpack:///./src/data/DiagramConfig.ts","webpack:///./src/data/Track.ts","webpack:///./src/data/Station.ts","webpack:///./src/data/StopEvent.ts","webpack:///./src/data/Train.ts","webpack:///./src/data/Diagram.ts","webpack:///./src/data/ViewConfig.ts","webpack:///./src/components/DiagramView.vue?aa10","webpack:///./src/data/ViewState.ts","webpack:///./src/components/Stage.vue?5ff3","webpack:///./src/components/BackLayer.vue?ea83","webpack:///./src/components/StationGroup.vue?ea6b","webpack:///./src/components/TrackGroup.vue?2b0b","webpack:///./src/components/TrackGroup.vue","webpack:///./src/components/TrackGroup.vue?80ea","webpack:///./src/components/TrackGroup.vue?a194","webpack:///./src/components/StationGroup.vue","webpack:///./src/components/StationGroup.vue?f322","webpack:///./src/components/StationGroup.vue?1b58","webpack:///./src/components/BackLayer.vue","webpack:///./src/components/BackLayer.vue?3b1f","webpack:///./src/components/BackLayer.vue?c43c","webpack:///./src/components/Pointer.vue?432d","webpack:///./src/utils.ts","webpack:///./src/components/Pointer.vue","webpack:///./src/components/Pointer.vue?63e5","webpack:///./src/components/Pointer.vue?a4a9","webpack:///./src/components/TrainPathLayer.vue?2624","webpack:///./src/components/TrainPathGroup.vue?bd05","webpack:///./src/components/TrainPathMarker.vue?5598","webpack:///./src/components/TrainPathMarker.vue","webpack:///./src/components/TrainPathMarker.vue?ce7d","webpack:///./src/components/TrainPathMarker.vue?a47c","webpack:///./src/components/TrainPathGroup.vue","webpack:///./src/components/TrainPathGroup.vue?c604","webpack:///./src/components/TrainPathGroup.vue?fe26","webpack:///./src/components/TrainPathLayer.vue","webpack:///./src/components/TrainPathLayer.vue?75af","webpack:///./src/components/TrainPathLayer.vue?44a2","webpack:///./src/components/Stage.vue","webpack:///./src/components/Stage.vue?091d","webpack:///./src/components/Stage.vue?d206","webpack:///./src/components/StationAddTrackButton.vue?bd44","webpack:///./src/components/StationAddTrackButton.vue","webpack:///./src/components/StationAddTrackButton.vue?f328","webpack:///./src/components/StationAddTrackButton.vue?b738","webpack:///./src/components/StationExpandButton.vue?becf","webpack:///./src/components/StationExpandButton.vue","webpack:///./src/components/StationExpandButton.vue?8892","webpack:///./src/components/StationExpandButton.vue?e10d","webpack:///./src/components/StationNameInput.vue?1acc","webpack:///./src/components/StationNameInput.vue","webpack:///./src/components/StationNameInput.vue?fcac","webpack:///./src/components/StationNameInput.vue?9ce9","webpack:///./src/components/StationRemoveButton.vue?0e3a","webpack:///./src/components/StationRemoveButton.vue","webpack:///./src/components/StationRemoveButton.vue?6092","webpack:///./src/components/StationRemoveButton.vue?7287","webpack:///./src/components/StationRemoveTrackButton.vue?6665","webpack:///./src/components/StationRemoveTrackButton.vue","webpack:///./src/components/StationRemoveTrackButton.vue?2de7","webpack:///./src/components/StationRemoveTrackButton.vue?c700","webpack:///./src/components/TrackNameInput.vue?56bb","webpack:///./src/components/TrackNameInput.vue","webpack:///./src/components/TrackNameInput.vue?2a59","webpack:///./src/components/TrackNameInput.vue?4243","webpack:///./src/components/DiagramView.vue","webpack:///./src/components/DiagramView.vue?0f5f","webpack:///./src/components/DiagramView.vue?613b","webpack:///./src/components/HelpPane.vue?8df7","webpack:///./src/components/HelpPane.vue","webpack:///./src/components/HelpPane.vue?3172","webpack:///./src/components/HelpPane.vue?a5ad","webpack:///./src/App.vue","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/messages.ts","webpack:///./src/main.ts","webpack:///./src/assets/logo.png"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","diagram","viewConfig","historyManager","_e","_m","staticClass","$t","class","editMode","on","onEditButtonClick","undoable","onUndoButtonClick","redoable","onRedoButtonClick","keys","trains","onVanishButtonClick","onUploadButtonClick","onDownloadButtonClick","helpPaneVisible","onHelpButtonClick","staticRenderFns","capacity","undos","redos","elem","pop","undo","redo","minimumTimeUnit","fontFamily","topPaneHeight","hourlyLabelBottomMargin","hourlyLabelFontSize","hourlyLabelColor","hourlyGridLineWidth","hourlyGridLineColor","majorMinutelyGridLineSpan","majorMinutelyGridLineWidth","majorMinutelyGridLineColor","minorMinutelyGridLineSpan","minorMinutelyGridLineWidth","minorMinutelyGridLineColor","leftPaneWidth","stationLabelLeftMargin","stationLabelRightMargin","stationLabelFontSize","stationLabelColor","stationLineWidth","stationLineColor","plotPaneVerticalPadding","trackLabelLeftMargin","trackLabelFontSize","trackLabelColor","trackLineWidth","trackLineColor","trackLineSpan","scrollX","scrollY","xScale","yScale","trainPathWidth","trainPathColor","dc","DiagramConfig","assign","station","id","relY","Track","mileage","expanded","topRelY","bottomRelY","tracks","track","index","indexOf","Array","isArray","Station","map","fromJSON","forEach","train","time","privateId","StopEvent","maxPrivateId","stevs","undefined","stations","stationId","trackId","arrTime","depTime","find","stev","stevRange","inRange","from","to","stops","lastStop","Train","flatMap","fromJSONStop","config","maxId","maxRelY","y","x","values","sort","a","b","set","delete","getStationsInMileageOrder","initialMileage","lastMileage","fromEntries","Diagram","Math","max","updateY","minHitWidth","pointerWidth","pointerColor","pointerLabelFontSize","pointerPrecisePixelPerTimeUnit","selectedTrackLabelColor","selectedTrackLineColor","selectedTrainPathColor","selectedTrainPathWidthScale","selectedTrainPathMarkerWidth","selectedTrainPathMarkerColor","unselectedTrainPathOpacity","markerLabelMaxDistance","markerLabelColor","markerLabelFontSize","markerLabelLineHeight","wheelScale","onStationNameInputStart","onTrackNameInputStart","ref","_l","viewWidth","viewHeight","trainSelections","pointerScreenX","pointerTime","pointerY","pointerTargetTrainPath","pointerTargetLine","pointerPreciseState","drawingState","trainPathDragState","stationNameInputTarget","trackNameInputTarget","controlKeyPressed","inputEnabled","directives","rawName","expression","arg","stageConfig","onStageMouseDown","onStageMouseMove","onStageClick","onStageDoubleClick","onStageMouseWheel","onContextMenu","_g","$listeners","lineConfig","labelConfig","topLineConfig","labelRectConfig","onStationLabelClick","onStationLabelMouseDown","isBottomLineIntersectingPlotPane","bottomLineConfig","onLabelClick","onLabelMouseDown","dragState","points","getYByRelY","viewState","stroke","strokeWidth","listening","width","height","text","fontSize","fill","align","verticalAlign","busy","$emit","konvaEvent","sy0","evt","screenY","index0","dragging","addEventListener","onWindowMouseMove","onWindowMouseUp","event","abs","currentIndex","findIndex","mouseRelY","getRelYByY","clientY","newIndex","removeEventListener","index1","removeTrack","addNewTrack","component","widthForChars","charSpan","mileage0","mileage1","components","TrackGroup","lines","scrollLeftTime","ceil","StationGroup","rectConfig","getTimeText","forceSec","hStr","floor","mmStr","padStart","ssStr","getXByTime","layerConfig","filter","regularTrainPathConfig","onTrainPathClick","onTrainPathMouseMove","selectedTrainPathConfig","onSelectedTrainPathClick","onSelectedTrainPathDoubleClick","onSelectedTrainPathMouseDown","onSelectedTrainPathMouseMove","onMarkerClick","onMarkerMouseDown","$event","trainPathNode","onRectMouseMove","onRectDoubleClick","phase","labelPosition","getLabelPosition","thisStev","prevStev","prev","nextStev","next","thisRelY","prevRelY","lastStev","direction","stableEnd","floating","regularTrainPathNodes","opacity","hitStrokeWidth","getTrainPathNodes","selectedTrainPathNodes","sel","getStopEventsInRange","shiftEnabled","targets","shiftTime","timeShift","shiftRange","inShiftRange","getPointedStevRange","clientX","clickedStopRange","changeTrainSelections","clickedStevRange","clickSelected","ctrlKey","selectedStevRange","selStart","selEnd","changed","$delete","$set","leftX","rightX","topY","min","bottomY","targetTime","nearestStation","getNearestStation","nearestStev","getNearestStopEvent","newStev","addNewStopEvent","minSta","minDist","minStop","minTimeShift","maxTimeShift","changeTrackTargets","firstNode","t0","y0","sx0","screenX","track0","changeTimeTargets","node","hypot","targetStation","mouseTrack","track1","newTrains","srcTrain","srcStevs","newTrain","addNewTrain","genId","srcStev","trainId","removeTrain","TrainPathMarker","clip","TrainPathGroup","stageDragState","document","onKeyDown","onKeyUp","dUnit","round","getTimeByX","findPointerTargetLine","target","currentTarget","targetTrack","stationPointedOnTop","stationsInMileageOrder","stationPointedOnBottom","pointedTrack","button","sign","triple","newLastStev","stableIndex","addedStevs","e","concat","targetLine","prevSta","reverse","startDrag","center","scrollX0","scrollY0","x0","moveDrag","endDrag","f","pow","deltaY","preventDefault","repeat","deletingTrains","deletingStevs","fromIndex","toIndex","size","removeStopEvent","BackLayer","Pointer","TrainPathLayer","style","nativeOn","onClick","left","top","newTrack","icon","domProps","type","_k","keyCode","onComplete","paddingTop","lineHeight","border","name0","name1","$el","isTopLineIntersectingPlotPane","removingTrains","removingStevs","isLineIntersectingPlotPane","trackIndex","resizeObserver","ResizeObserver","updateViewSize","observe","$nextTick","$refs","stationNameInput","focus","trackNameInput","clientWidth","clientHeight","default","Stage","StationAddTrackButton","StationExpandButton","StationNameInput","StationRemoveButton","StationRemoveTrackButton","TrackNameInput","_s","diagramFileName","fetch","then","json","input","createElement","accept","onchange","reader","FileReader","files","file","readAsText","onload","JSON","parse","clear","$buefy","notification","open","message","toString","click","stringify","blob","Blob","url","URL","createObjectURL","href","download","DiagramView","HelpPane","ja","confirmRemoveStationRefered","confirmRemoveTrackRefered","failedToLoadJSON","editButtonTooltip","undoButtonTooltip","redoButtonTooltip","vanishTrainsButtonTooltip","vanishStationsButtonTooltip","uploadButtonTooltip","downloadButtonTooltip","helpButtonTooltip","help","addNewStationTitle","addNewStationBody","addNewTrainTitle","addNewTrainBody","selectTrainTitle","selectTrainBody","editTrainTitle","editTrainBody","editTimeTitle","editTimeBody","tipsTitle","tipsBody","productionTip","use","defaultNotificationDuration","defaultNotificationPosition","i18n","locale","messages","render","h","$mount"],"mappings":"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","file":"js/app.cb04fc4d.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = __webpack_public_path__ + \"img/help_edit_train.67395182.png\";","module.exports = __webpack_public_path__ + \"img/help_select_train.6cd1d819.png\";","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","module.exports = __webpack_public_path__ + \"img/help_tips.12f4142e.png\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HelpPane.vue?vue&type=style&index=0&id=da68d834&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/help_edit_time.25aa545d.png\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DiagramView.vue?vue&type=style&index=0&id=d5ac33d8&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/help_add_new_train.0fab88c8.png\";","module.exports = __webpack_public_path__ + \"img/help_add_new_station.d55b6e32.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('diagram-view',{attrs:{\"id\":\"diagram-view\",\"diagram\":_vm.diagram,\"viewConfig\":_vm.viewConfig,\"historyManager\":_vm.historyManager}}),(_vm.helpPaneVisible)?_c('help-pane',{attrs:{\"id\":\"help-pane\"}}):_vm._e(),_c('div',{attrs:{\"id\":\"nav-pane\"}},[_vm._m(0),_c('span',{attrs:{\"id\":\"nav-pane-buttons\"}},[_c('span',{attrs:{\"id\":\"nav-pane-buttons-left\"}},[_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.editButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{class:_vm.viewConfig.editMode ? 'is-selected': '',attrs:{\"icon-left\":\"pencil-outline\",\"size\":\"medium\"},on:{\"click\":_vm.onEditButtonClick}})],1)],1),_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.undoButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"undo\",\"size\":\"medium\",\"disabled\":!_vm.historyManager.undoable},on:{\"click\":_vm.onUndoButtonClick}})],1)],1),_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.redoButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"redo\",\"size\":\"medium\",\"disabled\":!_vm.historyManager.redoable},on:{\"click\":_vm.onRedoButtonClick}})],1)],1),_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":Object.keys(_vm.diagram.trains).length > 0 ? _vm.$t('message.vanishTrainsButtonTooltip') : _vm.$t('message.vanishStationsButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"vanish\",\"size\":\"medium\"},on:{\"click\":_vm.onVanishButtonClick}})],1)],1),_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.uploadButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"upload\",\"size\":\"medium\"},on:{\"click\":_vm.onUploadButtonClick}})],1)],1),_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.downloadButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"download\",\"size\":\"medium\"},on:{\"click\":_vm.onDownloadButtonClick}})],1)],1)]),_c('span',{attrs:{\"id\":\"nav-pane-buttons-spacer\"}}),_c('span',{attrs:{\"id\":\"nav-pane-buttons-right\"}},[_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.helpButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{class:_vm.helpPaneVisible ? 'is-selected': '',attrs:{\"icon-left\":\"help\",\"size\":\"medium\"},on:{\"click\":_vm.onHelpButtonClick}})],1)],1)])])])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"nav-pane-item\",attrs:{\"id\":\"nav-pane-logo\"}},[_c('img',{attrs:{\"src\":require(\"@/assets/logo.png\")}})])}]\n\nexport { render, staticRenderFns }","interface HistoryElement {\n    undo: () => void;\n    redo: () => void;\n}\n\nexport default class HistoryManager {\n    constructor(public capacity: number) {}\n    private undos: HistoryElement[] = [];\n    private redos: HistoryElement[] = [];\n\n    get undoable(): boolean { return this.undos.length > 0; }\n    get redoable(): boolean { return this.redos.length > 0; }\n\n    push(elem: HistoryElement): void {\n        if (this.undos.length >= this.capacity) {\n            this.undos.splice(0, this.undos.length - this.capacity + 1);\n        }\n        this.undos.push(elem);\n        this.redos.splice(0);\n    }\n\n    clear(): void {\n        this.undos.splice(0);\n        this.redos.splice(0);\n    }\n\n    undo(): void {\n        const elem = this.undos.pop();\n        if (elem) {\n            this.redos.push(elem);\n            elem.undo();\n        }\n    }\n\n    redo(): void {\n        const elem = this.redos.pop();\n        if (elem) {\n            this.undos.push(elem);\n            elem.redo();\n        }\n    }\n}\n","export default class DiagramConfig {\n    minimumTimeUnit = 5;\n    fontFamily = \"Verdana, sans-serif\";\n    topPaneHeight = 32;\n    hourlyLabelBottomMargin = 4;\n    hourlyLabelFontSize = 16;\n    hourlyLabelColor = \"rgb(128, 192, 128)\";\n    hourlyGridLineWidth = 2.25;\n    hourlyGridLineColor = \"rgb(128, 192, 128)\";\n    majorMinutelyGridLineSpan = 10 * 60;\n    majorMinutelyGridLineWidth = 1.5;\n    majorMinutelyGridLineColor = \"rgb(128, 192, 128)\";\n    minorMinutelyGridLineSpan = 2 * 60;\n    minorMinutelyGridLineWidth = 0.75;\n    minorMinutelyGridLineColor = \"rgb(128, 192, 128)\";\n    leftPaneWidth = 160;\n    stationLabelLeftMargin = 16;\n    stationLabelRightMargin = 16;\n    stationLabelFontSize = 16;\n    stationLabelColor = \"rgb(128, 192, 128)\";\n    stationLineWidth = 1;\n    stationLineColor = \"rgb(128, 192, 128)\";\n    plotPaneVerticalPadding = 4;\n    trackLabelLeftMargin = 10;\n    trackLabelFontSize = 12;\n    trackLabelColor = \"rgb(128, 192, 128)\";\n    trackLineWidth = 0.75;\n    trackLineColor = \"rgb(128, 192, 128)\";\n    trackLineSpan = 12;\n    scrollX = 6 * 3600 * 0.08;\n    scrollY = 0;\n    xScale = 0.08;\n    yScale = 10;\n    trainPathWidth = 1;\n    trainPathColor = \"rgb(0, 0, 0)\";\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any): DiagramConfig {\n        if (!(o && typeof o == \"object\")) {\n            throw \"Invalid JSON\";\n        }\n        const dc = new DiagramConfig();\n        Object.assign(dc, o);\n        return dc;\n    }\n}","import Station from \"./Station\";\n\nexport default class Track {\n    constructor(\n        public readonly station: Station,\n        public readonly id: number, \n        public name: string,\n        public relY = 0,\n    ) {}\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any, station: Station): Track {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && o.id != null)) {\n            throw \"Invalid JSON @ Track\";\n        }\n        return new Track(station, o.id, o.name, o.relY);\n    }\n\n    toJSON(): unknown {\n        return {\n            id: this.id,\n            name: this.name,\n        };\n    }\n}","import Track from \"./Track\";\n\nexport default class Station {\n    constructor(\n        public readonly id: number, \n        public name: string,\n        public mileage: number,\n        public expanded = false,\n        public topRelY = 0,\n        public bottomRelY = 0\n    ) {}\n    readonly tracks: Track[] = [];\n\n    addNewTrack(track: Track, index: number = this.tracks.length): Track {\n        this.tracks.splice(index, 0, track);\n        return this.tracks[index];\n    }\n\n    removeTrack(t: Track): void {\n        const index = this.tracks.indexOf(t);\n        if (index >= 0) this.tracks.splice(index, 1);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any): Station {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && o.id != null && o.name != null && o.mileage != null && Array.isArray(o.tracks))) {\n            throw \"Invalid JSON @ Station\"\n        }\n        const station = new Station(o.id, o.name, o.mileage, o.expanded);\n        (o.tracks as any[]).map((t: any) => Track.fromJSON(t, station))\n            .forEach(t => station.tracks.push(t));\n        return station;\n    }\n\n    toJSON(): unknown {\n        return {\n            id: this.id,\n            name: this.name,\n            mileage: this.mileage,\n            tracks: this.tracks,\n            expanded: this.expanded,\n        };\n    }\n}\n","import Station from \"./Station\";\nimport Track from \"./Track\";\nimport Train from \"./Train\";\n\nexport default class StopEvent {\n    constructor(\n        public readonly train: Train,\n        public track: Track,\n        public time: number\n    ) {}\n    privateId: number = ++StopEvent.maxPrivateId;\n    static maxPrivateId = 0;\n\n    get station(): Station {\n        return this.track.station;\n    }\n    get next(): StopEvent | undefined {\n        const index = this.train.stevs.indexOf(this);\n        return index >= 0 ? this.train.stevs[index + 1] : undefined;\n    }\n    get prev(): StopEvent | undefined {\n        const index = this.train.stevs.indexOf(this);\n        return index >= 0 ? this.train.stevs[index - 1] : undefined;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSONStop(o: any, train: Train, stations: { [id: number]: Station }): StopEvent[] {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && o.stationId != null && o.trackId != null && o.arrTime != null && o.depTime != null)) {\n            throw \"Invalid JSON @ Stop\";\n        }\n        const station = stations[o.stationId];\n        const track = station && station.tracks.find(t => t.id == o.trackId);\n        if (!(station && track)) {\n            throw \"Invalid data @ Stop\";\n        }\n        return o.arrTime == o.depTime ?\n            [ new StopEvent(train, track, o.arrTime) ] :\n            [ new StopEvent(train, track, o.arrTime), new StopEvent(train, track, o.depTime) ];\n    }\n}\n\nexport interface StopEventRange {\n    from: StopEvent;\n    to: StopEvent;\n}\n","import Station from \"./Station\";\nimport StopEvent, { StopEventRange } from \"./StopEvent\";\n\nexport default class Train {\n    constructor(\n        public readonly id: number, \n        public name: string,\n    ) {}\n    stevs: StopEvent[] = [];\n\n    addNewStopEvent(stev: StopEvent, index: number = this.stevs.length): StopEvent {\n        this.stevs.splice(index, 0, stev);\n        return this.stevs[index];\n    }\n\n    removeStopEvent(stev: StopEvent): void {\n        const index = this.stevs.indexOf(stev);\n        if (index >= 0) this.stevs.splice(index, 1);\n    }\n\n    getStopEventsInRange(stevRange: StopEventRange): StopEvent[] {\n        const result = [];\n        let inRange = false;\n        for (const stev of this.stevs) {\n            if (stev == stevRange.from) inRange = true;\n            if (inRange) result.push(stev);\n            if (stev == stevRange.to) inRange = false;\n        }\n        return result;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any, stations: { [id: number]: Station }): Train {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && o.id != null && o.name != null && Array.isArray(o.stops))) {\n            throw \"Invalid JSON @ Train\";\n        }\n        const train = new Train(o.id, o.name);\n        (o.stops as any[]).flatMap((s: any) => StopEvent.fromJSONStop(s, train, stations))\n            .forEach(stev => train.stevs.push(stev));\n        return train;\n    }\n\n    toJSON(): unknown {\n        const stops: { stationId: number, trackId: number, arrTime: number, depTime: number }[] = [];\n        for (const stev of this.stevs) {\n            const lastStop = stops[stops.length - 1];\n            if (lastStop && lastStop.trackId == stev.track.id && lastStop.arrTime == lastStop.depTime) {\n                lastStop.depTime = stev.time;\n            } else {\n                stops.push({ \n                    stationId: stev.station.id, \n                    trackId: stev.track.id, \n                    arrTime: stev.time, \n                    depTime: stev.time \n                });\n            }\n        }\n        return {\n            id: this.id,\n            name: this.name,\n            stops: stops\n        };\n    }\n}\n","import Vue from \"vue\";\nimport DiagramConfig from \"./DiagramConfig\";\nimport Station from \"./Station\";\nimport Train from \"./Train\";\n\nexport default class Diagram {\n    constructor(\n        public config: DiagramConfig,\n        public stations: { [id: number]: Station },\n        public trains: { [id: number]: Train },\n    ) {}\n    maxId = 0;\n    maxRelY = 0;\n    \n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any): Diagram {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && typeof o.stations == \"object\" && typeof o.trains == \"object\")) {\n            throw \"Invalid JSON\";\n        }\n        const config = DiagramConfig.fromJSON(o.config || {});\n        const stations: { [id: number]: Station } = Object.fromEntries(Object.values(o.stations).map((s: any) => [ s.id, Station.fromJSON(s) ]));\n        const trains: { [id: number]: Train } = Object.fromEntries(Object.values(o.trains).map((t: any) => [ t.id, Train.fromJSON(t, stations) ]));\n        const diagram = new Diagram(config, stations, trains);\n\n        let maxId = o.maxId ? Math.max(o.maxId, 0) : 0;\n        for (const s of Object.values(stations)) {\n            maxId = Math.max(s.id, maxId);\n            for (const t of s.tracks) {\n                maxId = Math.max(t.id, maxId);\n            }\n        }\n        for (const t of Object.values(trains)) {\n            maxId = Math.max(t.id, maxId);\n        }\n        diagram.maxId = maxId;\n\n        diagram.updateY();\n\n        return diagram;\n    }\n\n    getYByRelY(relY: number): number {\n        return relY + this.config.topPaneHeight - this.config.scrollY;\n    }\n    getRelYByY(y: number): number {\n        return y - this.config.topPaneHeight + this.config.scrollY;\n    }\n    getXByTime(time: number): number {\n        return time * this.config.xScale + this.config.leftPaneWidth - this.config.scrollX;\n    }\n    getTimeByX(x: number): number {\n        return (x - this.config.leftPaneWidth + this.config.scrollX) / this.config.xScale;\n    }\n\n    getStationsInMileageOrder(): Station[] {\n        return Object.values(this.stations).sort((a, b) => a.mileage - b.mileage);\n    }\n\n    genId(): number {\n        return ++this.maxId;\n    }\n    releaseId(id: number): void {\n        if (id == this.maxId) --this.maxId;\n    }\n\n    addNewStation(station: Station): Station {\n        return Vue.set(this.stations, station.id, station);\n    }\n    removeStation(station: Station): void {\n        Vue.delete(this.stations, station.id);\n    }\n    addNewTrain(train: Train): Train {\n        return Vue.set(this.trains, train.id, train);\n    }\n    removeTrain(train: Train): void {\n        Vue.delete(this.trains, train.id);\n    }\n\n    updateY(): void {\n        if (Object.keys(this.stations).length == 0) {\n            this.maxRelY = 0;\n            return;\n        }\n\n        const stations = this.getStationsInMileageOrder();\n    \n        const initialMileage = stations[0].mileage;\n        for (const s of stations) {\n          s.mileage = s.mileage - initialMileage;\n        }\n    \n        let y = this.config.plotPaneVerticalPadding;\n        let lastMileage = 0;\n        for (const s of stations) {\n          y += (s.mileage - lastMileage) * this.config.yScale;\n          s.topRelY = y;\n          if (s.expanded) {\n            s.tracks.forEach((t, i) => {\n              t.relY = y + (i + 1) * this.config.trackLineSpan;\n            });\n            s.bottomRelY = y + (s.tracks.length + 1) * this.config.trackLineSpan;\n            y += (s.tracks.length + 1) * this.config.trackLineSpan;\n          } else {\n            Object.values(s.tracks).forEach(t => t.relY = y);\n            s.bottomRelY = y;\n          }\n          lastMileage = s.mileage;\n        }\n    \n        this.maxRelY = stations[stations.length - 1].bottomRelY + this.config.plotPaneVerticalPadding;\n      }\n    \n    toJSON(): unknown {\n        return {\n            config: this.config,\n            stations: this.stations,\n            trains: this.trains,\n        };\n    }\n}","export default class ViewConfig {\n    minHitWidth = 3;\n    pointerWidth = 3;\n    pointerColor = \"rgb(0, 0, 0)\";\n    pointerLabelFontSize = 12;\n    pointerPrecisePixelPerTimeUnit = 5;\n    selectedTrackLabelColor = \"rgb(255, 0, 0)\";\n    selectedTrackLineColor = \"rgb(255, 0, 0)\";\n    selectedTrainPathColor = \"rgb(255, 0, 0)\";\n    selectedTrainPathWidthScale = 1.5;\n    selectedTrainPathMarkerWidth = 5;\n    selectedTrainPathMarkerColor = \"rgb(255, 0, 0)\";\n    unselectedTrainPathOpacity = 0.5;\n    markerLabelMaxDistance = 20;\n    markerLabelColor = \"rgb(255, 0, 0)\";\n    markerLabelFontSize = 12;\n    markerLabelLineHeight = 16;\n    wheelScale = 1;\n    editMode = true;\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"diagram-view\"},[_c('stage',{staticClass:\"diagram-view-stage\",on:{\"updateY\":_vm.updateY,\"stationNameInputStart\":_vm.onStationNameInputStart,\"trackNameInputStart\":_vm.onTrackNameInputStart}}),_c('div',{staticClass:\"diagram-view-ui\"},[_c('station-name-input',{ref:\"stationNameInput\"}),_c('track-name-input',{ref:\"trackNameInput\"}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-expand-button',{key:(\"station-expand-button-\" + (s.id)),attrs:{\"station\":s},on:{\"updateY\":_vm.updateY,\"trackNameInputStart\":_vm.onTrackNameInputStart}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-remove-button',{key:(\"station-remove-button-\" + (s.id)),attrs:{\"station\":s},on:{\"updateY\":_vm.updateY}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-add-track-button',{key:(\"station-add-track-button-\" + (s.id)),attrs:{\"station\":s},on:{\"updateY\":_vm.updateY,\"trackNameInputStart\":_vm.onTrackNameInputStart}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _vm._l((s.tracks),function(t){return _c('station-remove-track-button',{key:(\"station-remove-track-button-\" + (s.id) + \"-\" + (t.id)),attrs:{\"station\":s,\"track\":t},on:{\"updateY\":_vm.updateY}})})})],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Station from \"./Station\";\nimport StopEvent, { StopEventRange } from \"./StopEvent\";\nimport Track from \"./Track\";\nimport Train from \"./Train\";\n\nexport interface TrainSelectionState {\n    train: Train;\n    stevRange: StopEventRange | null;\n}\n\nexport default class ViewState {\n    viewWidth = 0;\n    viewHeight = 0;\n    trainSelections: { [trainId: number]: TrainSelectionState } = {};\n    pointerScreenX = 0;\n    pointerTime = 0;\n    pointerY = 0;\n    pointerTargetTrainPath: { train: Train, stevRange: StopEventRange } | null = null;\n    pointerTargetLine: { station: Station, track: Track | null, relY: number } | null = null;\n    pointerPreciseState: { sx0: number, t0: number } | null = null;\n    drawingState: {\n        train: Train,\n        lastStev: StopEvent,\n        direction: number,\n        stableEnd: StopEvent | null,\n        floating: StopEvent | null\n    } | null = null;\n    trainPathDragState: { \n        dragging: boolean,\n        targets: { [trainId: number]: TrainSelectionState },\n        timeShift: number \n    } | null = null;\n    stationNameInputTarget: Station | null = null;\n    trackNameInputTarget: Track | null = null;\n    controlKeyPressed = false;\n\n    get busy(): boolean {\n        return this.drawingState != null || \n            this.trainPathDragState != null ||\n            this.inputEnabled;\n    }\n\n    get inputEnabled(): boolean {\n        return this.stationNameInputTarget != null || this.trackNameInputTarget != null;\n    }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"hammer\",rawName:\"v-hammer:panstart\",value:(_vm.onPanStart),expression:\"onPanStart\",arg:\"panstart\"},{name:\"hammer\",rawName:\"v-hammer:panmove\",value:(_vm.onPanMove),expression:\"onPanMove\",arg:\"panmove\"},{name:\"hammer\",rawName:\"v-hammer:panend\",value:(_vm.onPanEnd),expression:\"onPanEnd\",arg:\"panend\"}]},[(_vm.diagram)?_c('v-stage',{attrs:{\"config\":_vm.stageConfig},on:{\"mousedown\":_vm.onStageMouseDown,\"mousemove\":_vm.onStageMouseMove,\"click\":_vm.onStageClick,\"dblclick\":_vm.onStageDoubleClick,\"wheel\":_vm.onStageMouseWheel,\"contextmenu\":_vm.onContextMenu}},[_c('back-layer',_vm._g({},_vm.$listeners)),_c('train-path-layer'),_c('v-layer',[_c('pointer')],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-layer',{attrs:{\"id\":\"back-layer\"}},[_vm._l((_vm.timeGridLines),function(t){return _c('v-group',{key:t.key},[_c('v-line',{attrs:{\"config\":t.lineConfig}}),(t.labelConfig)?_c('v-text',{attrs:{\"config\":t.labelConfig}}):_vm._e()],1)}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-group',_vm._g({key:(\"station-\" + (s.id)),attrs:{\"station\":s}},_vm.$listeners))})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[(_vm.isTopLineIntersectingPlotPane)?_c('v-group',[_c('v-line',{attrs:{\"config\":_vm.topLineConfig}}),_vm._l((_vm.labelCharacters),function(c){return _c('v-text',{key:c.key,attrs:{\"config\":c}})}),_c('v-rect',{attrs:{\"config\":_vm.labelRectConfig},on:{\"click\":_vm.onStationLabelClick,\"mousedown\":_vm.onStationLabelMouseDown}})],2):_vm._e(),(_vm.station.expanded && _vm.isBottomLineIntersectingPlotPane)?_c('v-line',{attrs:{\"config\":_vm.bottomLineConfig}}):_vm._e(),(_vm.station.expanded)?_vm._l((_vm.station.tracks),function(t){return _c('track-group',_vm._g({key:(\"track-\" + (_vm.station.id) + \"-\" + (t.id)),attrs:{\"station\":_vm.station,\"track\":t}},_vm.$listeners))}):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isLineIntersectingPlotPane)?_c('v-group',[_c('v-line',{attrs:{\"config\":_vm.lineConfig}}),_c('v-text',{attrs:{\"config\":_vm.labelConfig},on:{\"click\":_vm.onLabelClick,\"mousedown\":_vm.onLabelMouseDown}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport Station from \"@/data/Station\";\nimport Track from \"@/data/Track\";\nimport { KonvaEventObject } from \"konva/types/Node\";\n\n@Component\nexport default class TrackGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n  @Prop() track!: Track;\n\n  dragState: { sy0: number, index0: number, dragging: boolean } | null = null;\n\n  get lineConfig(): unknown {\n    return {\n      points: [\n        this.diagram.config.stationLabelLeftMargin + this.diagram.config.trackLabelLeftMargin, \n        this.diagram.getYByRelY(this.track.relY), \n        this.viewState.viewWidth, \n        this.diagram.getYByRelY(this.track.relY)\n      ],\n      stroke: this.diagram.config.trackLineColor,\n      strokeWidth: this.diagram.config.trackLineWidth,\n      listening: false,\n    }\n  }\n\n  get labelConfig(): unknown {\n    return {\n      id: `track-label-${this.station.id}-${this.track.id}`,\n      x: this.diagram.config.stationLabelLeftMargin + this.diagram.config.trackLabelLeftMargin,\n      y: this.diagram.getYByRelY(this.track.relY) - this.diagram.config.trackLabelFontSize,\n      width: this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.trackLabelLeftMargin - this.diagram.config.stationLabelRightMargin,\n      height: this.diagram.config.trackLabelFontSize,\n      text: this.track.name,\n      fontSize: this.diagram.config.trackLabelFontSize,\n      fontFamily: this.diagram.config.fontFamily,\n      fill: this.diagram.config.trackLabelColor,\n      align: \"left\",\n      verticalAlign: \"bottom\",\n    }\n  }\n\n  get isLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.track.relY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.track.relY) < this.viewState.viewHeight;\n  }\n\n  onLabelClick(): void {\n    if (this.viewConfig.editMode && !this.viewState.busy) {\n      this.viewState.trackNameInputTarget = this.track;\n      this.$emit(\"trackNameInputStart\");\n    }\n  }\n\n  onLabelMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewConfig.editMode) {\n      this.dragState = { \n        sy0: konvaEvent.evt.screenY, \n        index0: this.station.tracks.indexOf(this.track), \n        dragging: false \n      };\n      window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    }\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState) {\n      if (Math.abs(event.screenY - this.dragState.sy0) > 1) {\n        this.dragState.dragging = true;\n      }\n      if (this.dragState.dragging) {\n        const currentIndex = this.station.tracks.findIndex(t => t.id == this.track.id);\n        this.station.tracks.splice(currentIndex, 1);\n\n        const mouseRelY = this.diagram.getRelYByY(event.clientY);\n        const newIndex = this.station.tracks.findIndex(t => mouseRelY < t.relY);\n        if (newIndex < 0) {\n          this.station.tracks.push(this.track);\n        } else {\n          this.station.tracks.splice(newIndex, 0, this.track);\n        }\n        this.$emit(\"updateY\");\n      }\n    }\n  }\n\n  onWindowMouseUp(event: MouseEvent): void {\n    if (this.dragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      this.onWindowMouseMove(event);\n\n      const index0 = this.dragState.index0;\n      const index1 = this.station.tracks.indexOf(this.track);\n      if (index0 != index1) {\n        this.historyManager.push({\n          undo: () => { \n            this.station.removeTrack(this.track); \n            this.station.addNewTrack(this.track, index0); \n          },\n          redo: () => {\n            this.station.removeTrack(this.track); \n            this.station.addNewTrack(this.track, index1); \n          }\n        });\n      }\n\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrackGroup.vue?vue&type=template&id=04365208&scoped=true&\"\nimport script from \"./TrackGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrackGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"04365208\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport TrackGroup from \"./TrackGroup.vue\";\nimport { KonvaEventObject } from \"konva/types/Node\";\n\n@Component({\n  components: {\n    TrackGroup\n  },\n})\nexport default class StationGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n\n  dragState: { sy0: number, mileage0: number, dragging: boolean } | null = null;\n\n  get topLineConfig(): unknown {\n    return {\n      points: [\n        0, \n        this.diagram.getYByRelY(this.station.topRelY), \n        this.viewState.viewWidth, \n        this.diagram.getYByRelY(this.station.topRelY)\n      ],\n      stroke: this.diagram.config.stationLineColor,\n      strokeWidth: this.diagram.config.stationLineWidth,\n      listening: false,\n    }\n  }\n\n  get bottomLineConfig(): unknown {\n    return {\n      points: [\n        0, \n        this.diagram.getYByRelY(this.station.bottomRelY), \n        this.viewState.viewWidth, \n        this.diagram.getYByRelY(this.station.bottomRelY)\n      ],\n      stroke: this.diagram.config.stationLineColor,\n      strokeWidth: this.diagram.config.stationLineWidth,\n      listening: false,\n    }\n  }\n\n  get labelRectConfig(): unknown {\n    return {\n      id: `station-label-${this.station.id}`,\n      x: this.diagram.config.stationLabelLeftMargin,\n      y: this.diagram.getYByRelY(this.station.topRelY) - this.diagram.config.stationLabelFontSize,\n      width: this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.stationLabelRightMargin,\n      height: this.diagram.config.stationLabelFontSize,\n    };\n  }\n\n  get labelCharacters(): unknown {\n    const widthForChars = this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.stationLabelRightMargin - this.diagram.config.stationLabelFontSize;\n    const charSpan = this.station.name.length > 1 ? widthForChars / (this.station.name.length - 1) : 0;\n    return Array.from(this.station.name).map((c, index) => {\n      return {\n        key: `station-label-${this.station.id}-${index}`,\n        x: this.station.name.length > 1 ? \n            this.diagram.config.stationLabelLeftMargin + index * charSpan :\n            this.diagram.config.stationLabelLeftMargin + widthForChars * 0.5,\n        y: this.diagram.getYByRelY(this.station.topRelY) - this.diagram.config.stationLabelFontSize,\n        height: this.diagram.config.stationLabelFontSize,\n        text: c,\n        fontSize: this.diagram.config.stationLabelFontSize,\n        fontFamily: this.diagram.config.fontFamily,\n        fill: this.diagram.config.stationLabelColor,\n        align: \"left\",\n        verticalAlign: \"bottom\",\n      }\n    });\n  }\n\n  get isTopLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.topRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.topRelY) < this.viewState.viewHeight;\n  }\n\n  get isBottomLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.bottomRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  onStationLabelClick(): void {\n    if (this.viewConfig.editMode && !this.viewState.busy) {\n      this.viewState.stationNameInputTarget = this.station;\n      this.$emit(\"stationNameInputStart\");\n    }\n  }\n\n  onStationLabelMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewConfig.editMode && !this.viewState.inputEnabled) {\n      this.dragState = {\n        sy0: konvaEvent.evt.screenY,\n        mileage0: this.station.mileage,\n        dragging: false,\n      };\n      window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    }\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState) {\n      if (Math.abs(event.screenY - this.dragState.sy0) > 1) {\n        this.dragState.dragging = true;\n      }\n      if (this.dragState.dragging) {\n        this.station.mileage = this.dragState.mileage0 + (event.screenY - this.dragState.sy0) / this.diagram.config.yScale;\n        this.$emit(\"updateY\");\n      }\n    }\n  }\n\n  onWindowMouseUp(event: MouseEvent): void {\n    if (this.dragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      this.onWindowMouseMove(event);\n\n      if (this.dragState.dragging) {\n        const mileage0 = this.dragState.mileage0;\n        const mileage1 = this.station.mileage;\n        this.historyManager.push({\n          undo: () => { this.station.mileage = mileage0; },\n          redo: () => { this.station.mileage = mileage1; }\n        });\n      }\n\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationGroup.vue?vue&type=template&id=73c79956&scoped=true&\"\nimport script from \"./StationGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"73c79956\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewState from \"@/data/ViewState\";\nimport StationGroup from \"./StationGroup.vue\";\n\n@Component({\n  components: {\n    StationGroup\n  },\n})\nexport default class BackLayer extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  get timeGridLines(): unknown {\n    const lines = [];\n    const scrollLeftTime = this.diagram.config.scrollX / this.diagram.config.xScale;\n    let t = Math.ceil(scrollLeftTime / this.diagram.config.minorMinutelyGridLineSpan) * this.diagram.config.minorMinutelyGridLineSpan;\n    let x = t * this.diagram.config.xScale - this.diagram.config.scrollX + this.diagram.config.leftPaneWidth;\n    while (x < this.viewState.viewWidth) {\n      lines.push({\n        key: `time-grid-line-${lines.length}`,\n        lineConfig: {\n          points: [\n            x,\n            this.diagram.config.topPaneHeight,\n            x,\n            this.viewState.viewHeight\n          ],\n          stroke:\n            t % 3600 == 0 ? this.diagram.config.hourlyGridLineColor :\n            t % this.diagram.config.majorMinutelyGridLineSpan == 0 ? this.diagram.config.majorMinutelyGridLineColor :\n            this.diagram.config.minorMinutelyGridLineColor,\n          strokeWidth: \n            t % 3600 == 0 ? this.diagram.config.hourlyGridLineWidth :\n            t % this.diagram.config.majorMinutelyGridLineSpan == 0 ? this.diagram.config.majorMinutelyGridLineWidth :\n            this.diagram.config.minorMinutelyGridLineWidth,\n          listening: false,\n        },\n        labelConfig: t % 3600 != 0 ? null : {\n          x: x - this.diagram.config.hourlyLabelFontSize,\n          y: this.diagram.config.topPaneHeight - this.diagram.config.hourlyLabelBottomMargin - this.diagram.config.hourlyLabelFontSize,\n          width: this.diagram.config.hourlyLabelFontSize * 2,\n          height: this.diagram.config.hourlyLabelFontSize,\n          text: `${ t / 3600 % 24 }`,\n          fontSize: this.diagram.config.hourlyLabelFontSize,\n          fontFamily: this.diagram.config.fontFamily,\n          fill: this.diagram.config.hourlyLabelColor,\n          align: \"center\",\n          verticalAlign: \"bottom\",\n        }\n      });\n      t += this.diagram.config.minorMinutelyGridLineSpan;\n      x = t * this.diagram.config.xScale - this.diagram.config.scrollX + this.diagram.config.leftPaneWidth;\n    }\n    return lines;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BackLayer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BackLayer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./BackLayer.vue?vue&type=template&id=654ee79b&scoped=true&\"\nimport script from \"./BackLayer.vue?vue&type=script&lang=ts&\"\nexport * from \"./BackLayer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"654ee79b\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.pointerEnabled)?_c('v-group',[_c('v-rect',{attrs:{\"config\":_vm.rectConfig}}),_c('v-text',{attrs:{\"config\":_vm.labelConfig}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export function getTimeText(time: number, forceSec?: boolean): string {\n    const hStr = `${Math.floor(time / 3600)}`;\n    const mmStr = `${Math.floor(time / 60) % 60}`.padStart(2, \"0\");\n    const ssStr = `${time % 60}`.padStart(2, \"0\");\n    return time % 60 != 0 || forceSec ? `${hStr}:${mmStr}:${ssStr}` : `${hStr}:${mmStr}`;\n}\n","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport { getTimeText } from \"@/utils\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class TrainPathGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  get pointerEnabled(): unknown {\n    return this.viewState.pointerTargetLine && !this.viewState.pointerTargetTrainPath &&\n      !this.viewState.trainPathDragState && !this.viewState.drawingState;\n  }\n\n  get rectConfig(): unknown {\n    const width = this.viewState.drawingState ? this.viewConfig.selectedTrainPathMarkerWidth : this.viewConfig.pointerWidth;\n    return {\n      x: this.diagram.getXByTime(this.viewState.pointerTime) - width * 0.5,\n      y: this.viewState.pointerY - width * 0.5,\n      width: width,\n      height: width,\n      fill: this.viewConfig.pointerColor,\n      listening: false,\n    };\n  }\n\n  get labelConfig(): unknown {\n    const time = this.viewState.pointerTime >= 0 ? \n      this.viewState.pointerTime : \n      this.viewState.pointerTime + Math.ceil(-this.viewState.pointerTime / 3600) * 3600;\n    return {\n      x: this.diagram.getXByTime(this.viewState.pointerTime),\n      y: this.viewState.pointerY - this.viewConfig.pointerLabelFontSize,\n      height: this.viewConfig.pointerLabelFontSize,\n      text: getTimeText(time, this.viewState.pointerPreciseState != null),\n      fontSize: this.viewConfig.pointerLabelFontSize,\n      fontFamily: this.diagram.config.fontFamily,\n      fill: this.viewConfig.pointerColor,\n      align: \"left\",\n      verticalAlign: \"bottom\",\n      listening: false,\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pointer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pointer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Pointer.vue?vue&type=template&id=3766b4d0&scoped=true&\"\nimport script from \"./Pointer.vue?vue&type=script&lang=ts&\"\nexport * from \"./Pointer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3766b4d0\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-layer',{ref:\"trainPathLayer\",attrs:{\"id\":\"train-path-layer\",\"config\":_vm.layerConfig}},[_vm._l((Object.values(_vm.diagram.trains).filter(function (t) { return !_vm.viewState.trainSelections[t.id]; })),function(t){return _c('train-path-group',{key:(\"train-\" + (t.id)),attrs:{\"train\":t}})}),_vm._l((Object.values(_vm.diagram.trains).filter(function (t) { return _vm.viewState.trainSelections[t.id]; })),function(t){return _c('train-path-group',{key:(\"train-\" + (t.id)),attrs:{\"train\":t}})})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[_c('v-line',{attrs:{\"config\":_vm.regularTrainPathConfig},on:{\"click\":_vm.onTrainPathClick,\"mousemove\":_vm.onTrainPathMouseMove}}),(_vm.selectedTrainPathEnabled)?[_c('v-line',{attrs:{\"config\":_vm.selectedTrainPathConfig},on:{\"click\":_vm.onSelectedTrainPathClick,\"dblclick\":_vm.onSelectedTrainPathDoubleClick,\"mousedown\":_vm.onSelectedTrainPathMouseDown,\"mousemove\":_vm.onSelectedTrainPathMouseMove}}),_vm._l((_vm.selectedTrainPathNodes),function(n){return _c('train-path-marker',{key:(\"marker-\" + (_vm.train.id) + \"-\" + (n.stev.privateId) + \"-\" + (n.phase)),attrs:{\"trainPathNode\":n},on:{\"click\":_vm.onMarkerClick,\"mousedown\":_vm.onMarkerMouseDown}})})]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[_c('v-rect',{attrs:{\"config\":_vm.rectConfig},on:{\"click\":function($event){return _vm.$emit('click', $event, _vm.trainPathNode)},\"mousemove\":_vm.onRectMouseMove,\"mousedown\":function($event){return _vm.$emit('mousedown', $event, _vm.trainPathNode)},\"dblclick\":_vm.onRectDoubleClick}}),(_vm.labelEnabled)?_c('v-text',{attrs:{\"config\":_vm.labelConfig}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport { getTimeText } from \"@/utils\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport TrainPathNode from \"@/data/TrainPathNode\";\n\n@Component\nexport default class TrainPathMarker extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() trainPathNode!: TrainPathNode;\n\n  get rectConfig(): unknown {\n    return {\n      x: this.diagram.getXByTime(this.trainPathNode.time) - this.viewConfig.selectedTrainPathMarkerWidth * 0.5,\n      y: this.diagram.getYByRelY(this.trainPathNode.relY) - this.viewConfig.selectedTrainPathMarkerWidth * 0.5,\n      width: this.viewConfig.selectedTrainPathMarkerWidth,\n      height: this.viewConfig.selectedTrainPathMarkerWidth,\n      fill: this.viewConfig.selectedTrainPathMarkerColor,\n    };\n  }\n\n  get labelEnabled(): boolean {\n    return this.trainPathNode.phase == \"track\";\n  }\n\n  get labelConfig(): unknown {\n    const labelPosition = this.getLabelPosition();\n    return {\n      x: this.diagram.getXByTime(this.trainPathNode.time) + labelPosition.x - this.viewConfig.markerLabelFontSize * 8,\n      y: this.diagram.getYByRelY(this.trainPathNode.relY) + labelPosition.y - this.viewConfig.markerLabelLineHeight,\n      width: this.viewConfig.markerLabelFontSize * 8,\n      height: this.viewConfig.markerLabelLineHeight,\n      text: getTimeText(this.trainPathNode.time, this.viewState.pointerPreciseState != null),\n      fontSize: this.viewConfig.pointerLabelFontSize,\n      fontFamily: this.diagram.config.fontFamily,\n      fill: this.viewConfig.markerLabelColor,\n      align: \"right\",\n      verticalAlign: \"bottom\",\n      listening: false,\n    }\n  }\n\n  getLabelPosition(): { x: number, y: number } {\n    const thisStev = this.trainPathNode.stev;\n    const prevStev = thisStev.prev;\n    const nextStev = thisStev.next;\n    if (prevStev && prevStev.track != thisStev.track && (!nextStev || nextStev.track == thisStev.track)) {\n      const thisRelY = prevStev.station.mileage < thisStev.station.mileage ? thisStev.station.topRelY : thisStev.station.bottomRelY;\n      const prevRelY = prevStev.station.mileage < thisStev.station.mileage ? prevStev.station.bottomRelY : prevStev.station.topRelY;\n      const x = thisRelY == prevRelY ? 0:\n        -this.viewConfig.markerLabelLineHeight *\n        ((thisStev.time - prevStev.time) * this.diagram.config.xScale) /\n        Math.abs(thisRelY - prevRelY);\n      return {\n        x: Math.max(x, -this.viewConfig.markerLabelMaxDistance),\n        y: prevStev.station.mileage < thisStev.station.mileage ? 0 : this.viewConfig.markerLabelLineHeight\n      };\n    }\n\n    return {\n      x: 0,\n      y: nextStev && nextStev.station.mileage < thisStev.station.mileage || prevStev && prevStev.station.mileage > thisStev.station.mileage ? 0 : this.viewConfig.markerLabelLineHeight,\n    };\n  }\n\n  onRectMouseMove(): void {\n    this.viewState.pointerTargetTrainPath = {\n      train: this.trainPathNode.stev.train,\n      stevRange: { from: this.trainPathNode.stev, to: this.trainPathNode.stev }\n    };\n  }\n\n  onRectDoubleClick(): void {\n    if (this.viewConfig.editMode) {\n      if (!this.viewState.drawingState) {\n        const n = this.trainPathNode;\n        if (!n.stev.prev) {\n          this.viewState.drawingState = {\n            train: n.stev.train,\n            lastStev: n.stev,\n            direction: -1,\n            stableEnd: n.stev,\n            floating: null\n          };\n          this.viewState.trainSelections[n.stev.train.id].stevRange = null;\n        } else if (!n.stev.next) {\n          this.viewState.drawingState = {\n            train: n.stev.train,\n            lastStev: n.stev,\n            direction: 1,\n            stableEnd: n.stev,\n            floating: null\n          };\n          this.viewState.trainSelections[n.stev.train.id].stevRange = null;\n        }\n      } else {\n        this.viewState.drawingState = null;\n        this.viewState.trainSelections = {};\n      }\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathMarker.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathMarker.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathMarker.vue?vue&type=template&id=40df1b93&scoped=true&\"\nimport script from \"./TrainPathMarker.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathMarker.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"40df1b93\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport StopEvent, { StopEventRange } from \"@/data/StopEvent\";\nimport Track from \"@/data/Track\";\nimport TrainPathNode from \"@/data/TrainPathNode\";\nimport Train from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport TrainPathMarker from \"./TrainPathMarker.vue\";\n\n@Component({\n  components: {\n    TrainPathMarker\n  },\n})\nexport default class TrainPathGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() train!: Train;\n\n  dragState: { \n    t0: number, \n    y0: number,\n    sx0: number, \n    sy0: number,\n    track0: Track | null,\n    minTimeShift: number,\n    maxTimeShift: number,\n    changeTimeTargets: StopEvent[] | null,\n    changeTrackTargets: StopEvent[] | null,\n  } | null = null;\n\n  get regularTrainPathConfig(): unknown {\n    return {\n      points: this.regularTrainPathNodes.flatMap(n => [this.diagram.getXByTime(n.time), this.diagram.getYByRelY(n.relY)]),\n      stroke: this.diagram.config.trainPathColor,\n      opacity: Object.keys(this.viewState.trainSelections).length > 0 ? this.viewConfig.unselectedTrainPathOpacity : 1,\n      strokeWidth: this.diagram.config.trainPathWidth,\n      hitStrokeWidth: Math.max(this.diagram.config.trainPathWidth, this.viewConfig.minHitWidth * 2),\n    }\n  }\n\n  get regularTrainPathNodes(): TrainPathNode[] {\n    return this.getTrainPathNodes(\"regular\");\n  }\n\n  get selectedTrainPathEnabled(): boolean {\n    return this.viewState.trainSelections[this.train.id] != null;\n  }\n\n  get selectedTrainPathConfig(): unknown {\n    return {\n      points: this.selectedTrainPathNodes.flatMap(n => [this.diagram.getXByTime(n.time), this.diagram.getYByRelY(n.relY)]),\n      stroke: this.viewConfig.selectedTrainPathColor,\n      strokeWidth: this.diagram.config.trainPathWidth * this.viewConfig.selectedTrainPathWidthScale,\n      hitStrokeWidth: Math.max(this.diagram.config.trainPathWidth * this.viewConfig.selectedTrainPathWidthScale, this.viewConfig.minHitWidth * 2)\n    };\n  }\n\n  get selectedTrainPathNodes(): TrainPathNode[] {\n    return this.getTrainPathNodes(\"selected\");\n  }\n\n  getTrainPathNodes(mode: \"regular\" | \"selected\"): TrainPathNode[] {\n    const sel = this.viewState.trainSelections[this.train.id];\n    const stevs = mode == \"selected\" && sel.stevRange != null ? \n      this.train.getStopEventsInRange(sel.stevRange) : this.train.stevs;\n\n    const shiftEnabled = this.viewState.trainPathDragState?.targets[this.train.id] && (mode == \"selected\" || !this.viewState.controlKeyPressed);\n    const shiftTime = this.viewState.trainPathDragState?.timeShift ?? 0;\n    const shiftRange = this.viewState.trainPathDragState?.targets[this.train.id]?.stevRange;\n    let inShiftRange = shiftEnabled && !shiftRange;\n\n    const result: TrainPathNode[] = [];\n    for (const stev of stevs) {\n      if (shiftEnabled && stev == shiftRange?.from) inShiftRange = true;\n      const time = inShiftRange ? stev.time + shiftTime : stev.time;\n      if (stev.station.expanded && stev.prev && stev.prev.station != stev.station) {\n        result.push({ \n          stev, \n          phase: \"arr\",\n          time, \n          relY: stev.prev.station.mileage < stev.station.mileage ? stev.station.topRelY : stev.station.bottomRelY\n        });\n      }\n      result.push({\n        stev,\n        phase: \"track\",\n        time,\n        relY: stev.track.relY\n      });\n      if (stev.station.expanded && stev.next && stev.next.station != stev.station) {\n        result.push({ \n          stev, \n          phase: \"dep\",\n          time, \n          relY: stev.next.station.mileage < stev.station.mileage ? stev.station.topRelY : stev.station.bottomRelY\n        });\n      }\n      if (shiftEnabled && stev == shiftRange?.to) inShiftRange = false;\n    }\n    return result;\n  }\n\n  onTrainPathMouseMove(): void {\n    this.viewState.pointerTargetTrainPath = null;\n  }\n\n  onSelectedTrainPathMouseMove(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    this.viewState.pointerTargetTrainPath = { \n      train: this.train, \n      stevRange: this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY)\n    };\n  }\n\n  onTrainPathClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const clickedStopRange = this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    this.changeTrainSelections(konvaEvent, clickedStopRange, false);\n  }\n\n  onSelectedTrainPathClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const clickedStopRange = this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    this.changeTrainSelections(konvaEvent, clickedStopRange, true);\n  }\n\n  onMarkerClick(konvaEvent: KonvaEventObject<MouseEvent>, trainPathNode: TrainPathNode): void {\n    const clickedStevRange = { from: trainPathNode.stev, to: trainPathNode.stev };\n    this.changeTrainSelections(konvaEvent, clickedStevRange, true);\n  }\n\n  changeTrainSelections(konvaEvent: KonvaEventObject<MouseEvent>, clickedStevRange: StopEventRange, clickSelected: boolean): void {\n    if (!this.viewState.trainPathDragState?.dragging && !this.viewState.drawingState) {\n      const sel = this.viewState.trainSelections[this.train.id];\n\n      // Remove other trains if ctrl not pressed\n      if (!konvaEvent.evt.ctrlKey) {\n        this.viewState.trainSelections = sel ? { [this.train.id]: sel } : {};\n      }\n\n      if (!sel) {\n        this.$set(this.viewState.trainSelections, this.train.id, { train: this.train, stevRange: null });\n      } else {\n        const selectedStevRange = sel.stevRange;\n        if (!selectedStevRange) {\n          sel.stevRange = clickedStevRange;\n        } else if (!konvaEvent.evt.ctrlKey) {\n          sel.stevRange = clickSelected ? clickedStevRange : null;\n        } else {\n          let selStart = false, selEnd = false, changed = false;\n          for (const stev of this.train.stevs) {\n            if (!selStart && stev == clickedStevRange.from) {\n              selectedStevRange.from = clickedStevRange.from;\n              changed = true;\n            }\n            if (stev == selectedStevRange.from) selStart = true;\n            if (stev == selectedStevRange.to) selEnd = true;\n            if (selEnd && stev == clickedStevRange.to) {\n              selectedStevRange.to = clickedStevRange.to;\n              changed = true;\n            }\n          }\n          if (!changed) {\n            this.$delete(this.viewState.trainSelections, this.train.id);\n          }\n        }\n      }\n    }\n  }\n\n  getPointedStevRange(x: number, y: number): StopEventRange {\n    if (this.train.stevs.length <= 2) {\n      return { from: this.train.stevs[0], to: this.train.stevs[this.train.stevs.length - 1] };\n    }\n\n    // TODO: more precise detection\n    for (let i = 0; i < this.train.stevs.length - 1; ++i) {\n      const thisStev = this.train.stevs[i];\n      const nextStev = this.train.stevs[i + 1];\n      const leftX = this.diagram.getXByTime(thisStev.time) - this.viewConfig.minHitWidth;\n      const rightX = this.diagram.getXByTime(nextStev.time) + this.viewConfig.minHitWidth;\n      const topY = this.diagram.getYByRelY(Math.min(thisStev.track.relY, nextStev.track.relY)) - this.viewConfig.minHitWidth;\n      const bottomY = this.diagram.getYByRelY(Math.max(thisStev.track.relY, nextStev.track.relY)) + this.viewConfig.minHitWidth;\n      if (leftX < x && x < rightX && topY < y && y < bottomY) {\n        return { from: thisStev, to: nextStev };\n      }\n    }\n    return { from: this.train.stevs[0], to: this.train.stevs[this.train.stevs.length - 1] };\n  }\n\n  onSelectedTrainPathDoubleClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewConfig.editMode && !this.viewState.drawingState) {\n      const targetTime = this.viewState.pointerTime;\n      const nearestStation = this.getNearestStation(konvaEvent.evt.clientY);\n      const nearestStev = this.getNearestStopEvent(targetTime);\n      if (!(nearestStation == nearestStev.station && (nearestStev.prev?.track == nearestStev.track || nearestStev.next?.track == nearestStev.track))) {\n        const index = this.train.stevs.findIndex(s => s.time > targetTime);\n        const newStev = this.train.addNewStopEvent(new StopEvent(this.train, nearestStation.tracks[0], targetTime), index);\n        this.viewState.trainSelections = { \n          [this.train.id]: {\n            train: this.train,\n            stevRange: { from: newStev, to: newStev }\n          } \n        };\n      }\n    }\n  }\n\n  getNearestStation(y: number): Station {\n    const stations = this.diagram.getStationsInMileageOrder();\n    const relY = this.diagram.getRelYByY(y);\n    let minSta = stations[0];\n    let minDist = Math.abs(relY - minSta.bottomRelY);\n    for (const s of stations) {\n      if (Math.abs(relY - s.topRelY) < minDist) {\n        minSta = s;\n        minDist = Math.abs(relY - s.topRelY);\n      }\n      if (Math.abs(relY - s.bottomRelY) < minDist) {\n        minSta = s;\n        minDist = Math.abs(relY - s.bottomRelY);\n      }\n    }\n    return minSta;\n  }\n\n  getNearestStopEvent(time: number): StopEvent {\n    let minStop = this.train.stevs[0];\n    let minDist = Math.abs(time - minStop.time);\n    for (const s of this.train.stevs) {\n      if (Math.abs(time - s.time) < minDist) {\n        minStop = s;\n        minDist = Math.abs(time - s.time);\n      }\n    }\n    return minStop;\n  }\n\n  onSelectedTrainPathMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (!this.viewConfig.editMode) {\n      return;\n    }\n\n    let minTimeShift = -86400;\n    let maxTimeShift = 86400;\n    for (const sel of Object.values(this.viewState.trainSelections)) {\n      const stevRange = sel.stevRange;\n      if (stevRange) {\n        if (stevRange.from.prev) {\n          minTimeShift = Math.max(minTimeShift, stevRange.from.prev.time - stevRange.from.time);\n        }\n        if (stevRange.to.next) {\n          maxTimeShift = Math.min(maxTimeShift, stevRange.to.next.time - stevRange.to.time);\n        }\n      }\n    }\n\n    const clickedStevRange = this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    const changeTrackTargets = \n      clickedStevRange.from == clickedStevRange.to ? [ clickedStevRange.from ] : \n      clickedStevRange.from.track == clickedStevRange.to.track ? [ clickedStevRange.from, clickedStevRange.to ] :\n      null;\n\n    const firstNode = this.selectedTrainPathNodes[0];\n    this.dragState = { \n      t0: firstNode.time, \n      y0: this.diagram.getYByRelY(firstNode.relY),\n      sx0: konvaEvent.evt.screenX, \n      sy0: konvaEvent.evt.screenY,\n      track0: changeTrackTargets ? changeTrackTargets[0].track : null,\n      minTimeShift: minTimeShift,\n      maxTimeShift: maxTimeShift,\n      changeTimeTargets: null,\n      changeTrackTargets: changeTrackTargets ?? null\n    };\n    this.viewState.trainPathDragState = {\n      dragging: false,\n      targets: this.viewState.trainSelections,\n      timeShift: 0\n    };\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n  }\n\n  onMarkerMouseDown(konvaEvent: KonvaEventObject<MouseEvent>, node: TrainPathNode): void {\n    if (!this.viewConfig.editMode) {\n      return;\n    }\n\n    this.dragState = {\n      t0: node.time,\n      y0: this.diagram.getYByRelY(node.relY),\n      track0: node.stev.track,\n      sx0: konvaEvent.evt.screenX,\n      sy0: konvaEvent.evt.screenY,\n      minTimeShift: node.stev.prev ? node.stev.prev.time - node.time : -86400,\n      maxTimeShift: node.stev.next ? node.stev.next.time - node.time : 86400,\n      changeTimeTargets: [ node.stev ],\n      changeTrackTargets: [ node.stev ]\n    };\n    this.viewState.trainPathDragState = {\n      dragging: false,\n      targets: { [node.stev.train.id]: { train: node.stev.train, stevRange: { from: node.stev, to: node.stev } } },\n      timeShift: 0\n    };\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState && this.viewState.trainPathDragState) {\n      if (!this.viewState.trainPathDragState.dragging && Math.hypot(event.clientX - this.dragState.sx0, event.clientY - this.dragState.sy0) > 1) {\n        this.viewState.trainPathDragState.dragging = true;\n        this.viewState.pointerY = this.dragState.y0;\n      }\n      if (this.viewState.trainPathDragState.dragging) {\n        if (!this.viewState.pointerPreciseState) {\n          this.viewState.pointerTime = this.dragState.t0 + Math.floor((event.screenX - this.dragState.sx0) / this.diagram.config.xScale / 60) * 60;\n        }\n        this.viewState.trainPathDragState.timeShift = \n          !this.viewState.controlKeyPressed ?\n            Math.min(this.dragState.maxTimeShift, Math.max(this.dragState.minTimeShift, this.viewState.pointerTime - this.dragState.t0)) :\n            this.viewState.pointerTime - this.dragState.t0;\n        if (this.dragState.changeTrackTargets) {\n          const mouseRelY = this.diagram.getRelYByY(event.clientY);\n          const targetStation = this.dragState.changeTrackTargets[0].station;\n          const mouseTrack = targetStation.tracks.find(t => Math.abs(t.relY - mouseRelY) < this.viewConfig.minHitWidth);\n          if (mouseTrack) {\n            for (const stev of this.dragState.changeTrackTargets) {\n              stev.track = mouseTrack;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  onWindowMouseUp(): void {\n    if (this.dragState && this.viewState.trainPathDragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      if (this.viewState.trainPathDragState.dragging) {\n        if (this.dragState.changeTrackTargets && this.dragState.track0) {\n          const targets = this.dragState.changeTrackTargets;\n          const track0 = this.dragState.track0;\n          const track1 = this.dragState.changeTrackTargets[0].track;\n          if (track0 != track1) {\n            this.historyManager.push({\n              undo: () => { targets.forEach(stev => stev.track = track0); },\n              redo: () => { targets.forEach(stev => stev.track = track1); }\n            });\n          }\n        }\n\n        const timeShift = this.viewState.trainPathDragState.timeShift;\n        if (timeShift != 0) {\n          if (!this.viewState.controlKeyPressed) {\n            const targets = \n              this.dragState.changeTimeTargets ??\n              Object.values(this.viewState.trainSelections).flatMap(sel => {\n                return sel.stevRange ? sel.train.getStopEventsInRange(sel.stevRange) : sel.train.stevs;\n              });\n            targets.forEach(stev => stev.time += timeShift);\n            this.historyManager.push({\n              undo: () => { targets.forEach(stev => stev.time -= timeShift); },\n              redo: () => { targets.forEach(stev => stev.time += timeShift); }\n            });\n          } else {\n            const newTrains = Object.values(this.viewState.trainSelections).map(sel => {\n              const srcTrain = sel.train;\n              const srcStevs = sel.stevRange ? srcTrain.getStopEventsInRange(sel.stevRange) : srcTrain.stevs;\n              const newTrain = this.diagram.addNewTrain(new Train(this.diagram.genId(), \"\"));\n              for (const srcStev of srcStevs) {\n                newTrain.addNewStopEvent(new StopEvent(newTrain, srcStev.track, srcStev.time + timeShift));\n              }\n              this.$delete(this.viewState.trainSelections, sel.train.id);\n              this.$set(this.viewState.trainSelections, newTrain.id, { trainId: newTrain.id, stevRange: null });\n              return newTrain;\n            });\n            this.historyManager.push({\n              undo: () => { newTrains.forEach(train => this.diagram.removeTrain(train)); },\n              redo: () => { newTrains.forEach(train => this.diagram.addNewTrain(train)); }\n            });\n          }\n        }\n      }\n      this.viewState.trainPathDragState = null;\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathGroup.vue?vue&type=template&id=b89abab4&scoped=true&\"\nimport script from \"./TrainPathGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b89abab4\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewState from \"@/data/ViewState\";\nimport TrainPathGroup from \"./TrainPathGroup.vue\";\n\n@Component({\n  components: {\n    TrainPathGroup\n  },\n})\nexport default class BackLayer extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  // mounted(): void {\n  //   const hitCanvas = (this.$refs.trainPathLayer as any).getNode().hitCanvas._canvas;\n  //   document.body.appendChild(hitCanvas);\n  // }\n\n  get layerConfig(): unknown {\n    return {\n      clip: {\n        x: this.diagram.config.leftPaneWidth,\n        y: this.diagram.config.topPaneHeight,\n        width: this.viewState.viewWidth - this.diagram.config.leftPaneWidth,\n        height: this.viewState.viewHeight - this.diagram.config.topPaneHeight,\n      }\n    };\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathLayer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathLayer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathLayer.vue?vue&type=template&id=2f6cdf07&scoped=true&\"\nimport script from \"./TrainPathLayer.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathLayer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2f6cdf07\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Inject, InjectReactive, Vue } from \"vue-property-decorator\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport StopEvent from \"@/data/StopEvent\";\nimport Track from \"@/data/Track\";\nimport Train from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport BackLayer from \"./BackLayer.vue\";\nimport Pointer from \"./Pointer.vue\";\nimport TrainPathLayer from \"./TrainPathLayer.vue\";\n\n@Component({\n  components: {\n    BackLayer, Pointer, TrainPathLayer\n  },\n})\nexport default class Stage extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n\n  stageDragState: { scrollX0: number, scrollY0: number, x0: number, y0: number, dragging: boolean } | null = null;\n\n  get stageConfig(): unknown {\n    return {\n      width: this.viewState.viewWidth,\n      height: this.viewState.viewHeight\n    };\n  }\n\n  get stationsInMileageOrder(): Station[] {\n    return this.diagram.getStationsInMileageOrder();\n  }\n\n  mounted(): void {\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    document.addEventListener(\"keydown\", this.onKeyDown);\n    document.addEventListener(\"keyup\", this.onKeyUp);\n  }\n\n  unmounted(): void {\n    window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n    document.removeEventListener(\"keydown\", this.onKeyDown);\n    document.removeEventListener(\"keyup\", this.onKeyUp);\n  }\n\n  onStageMouseMove(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const event = konvaEvent.evt;\n\n    // Update pointer state\n    this.viewState.pointerScreenX = event.screenX;\n    if (this.viewState.pointerPreciseState) {\n      const dUnit = Math.round((event.screenX - this.viewState.pointerPreciseState.sx0) / this.viewConfig.pointerPrecisePixelPerTimeUnit);\n      this.viewState.pointerTime = dUnit * this.diagram.config.minimumTimeUnit + this.viewState.pointerPreciseState.t0;\n    } else if (!this.viewState.trainPathDragState?.dragging) {\n      this.viewState.pointerTime = Math.round(this.diagram.getTimeByX(event.clientX) / 60) * 60;\n      if (event.clientX >= this.diagram.config.leftPaneWidth) {\n        const pointerTargetLine = this.findPointerTargetLine(event.clientY);\n        if (pointerTargetLine) {\n          this.viewState.pointerTargetLine = pointerTargetLine ?? null;\n          this.viewState.pointerY = this.diagram.getYByRelY(pointerTargetLine.relY);\n        } else {\n          this.viewState.pointerTargetLine = null;\n        }\n      } else {\n        this.viewState.pointerTargetLine = null;\n      }\n    }\n    if (konvaEvent.target == konvaEvent.currentTarget) {\n      this.viewState.pointerTargetTrainPath = null;\n    }\n\n    // Update drawing floating\n    const drawingState = this.viewState.drawingState;\n    if (drawingState) {\n      if (drawingState.direction > 0) {\n        this.viewState.pointerTime = Math.max(this.viewState.pointerTime, drawingState.lastStev.time);\n      } else if (drawingState.direction < 0) {\n        this.viewState.pointerTime = Math.min(this.viewState.pointerTime, drawingState.lastStev.time);\n      }\n\n      if (drawingState.floating) {\n        drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.floating), 1);\n        drawingState.floating = null;\n      }\n\n      const pointerTargetLine = event.clientX >= this.diagram.config.leftPaneWidth ?\n        this.findPointerTargetLine(event.clientY) : undefined;\n      if (pointerTargetLine) {\n        const targetTrack = pointerTargetLine.track ?? pointerTargetLine.station.tracks[0];\n        const newStev = drawingState.train.addNewStopEvent(\n          new StopEvent(\n            drawingState.train,\n            targetTrack,\n            this.viewState.pointerTime\n          ),\n          drawingState.direction > 0 || (drawingState.direction == 0 && this.viewState.pointerTime >= drawingState.lastStev.time) ? undefined : 0\n        );\n        drawingState.floating = newStev;\n      }\n    }\n  }\n\n  findPointerTargetLine(y: number): { station: Station, track: Track | null, relY: number } | undefined {\n    const stationPointedOnTop = this.stationsInMileageOrder.find(s => \n      Math.abs(this.diagram.getYByRelY(s.topRelY) - y) < Math.max(this.diagram.config.stationLineWidth * 0.5, this.viewConfig.minHitWidth));\n    if (stationPointedOnTop) {\n      return { station: stationPointedOnTop, track: null, relY: stationPointedOnTop.topRelY };\n    }\n\n    const stationPointedOnBottom = this.stationsInMileageOrder.find(s =>\n      Math.abs(this.diagram.getYByRelY(s.bottomRelY) - y) < Math.max(this.diagram.config.stationLineWidth * 0.5, this.viewConfig.minHitWidth));\n    if (stationPointedOnBottom) {\n      return { station: stationPointedOnBottom, track: null, relY: stationPointedOnBottom.bottomRelY };\n    }\n\n    const station = this.stationsInMileageOrder.find(s => \n      this.diagram.getYByRelY(s.topRelY) + this.diagram.config.trackLineSpan - Math.max(this.diagram.config.trackLineWidth * 0.5, this.viewConfig.minHitWidth) < y &&\n      this.diagram.getYByRelY(s.bottomRelY) - this.diagram.config.trackLineSpan + Math.max(this.diagram.config.trackLineWidth * 0.5, this.viewConfig.minHitWidth) > y\n    );\n    if (station) {\n      const pointedTrack = station.tracks.find(t => Math.abs(this.diagram.getYByRelY(t.relY) - y) < Math.max(this.diagram.config.trackLineWidth * 0.5, this.viewConfig.minHitWidth));\n      if (pointedTrack) {\n        return { station, track: pointedTrack, relY: pointedTrack.relY };\n      }\n    }\n  }\n\n  onStageClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const drawingState = this.viewState.drawingState;\n    if (drawingState) {\n      if (konvaEvent.evt.button == 0 && this.viewState.pointerTargetLine) {\n        if (drawingState.direction == 0) {\n          drawingState.direction = Math.sign(this.viewState.pointerTime - drawingState.lastStev.time);\n        }\n        if (drawingState.floating){\n          const triple = drawingState.floating.track == drawingState.lastStev.track && (\n            drawingState.direction > 0 && drawingState.lastStev.track == drawingState.lastStev.prev?.track ||\n            drawingState.direction < 0 && drawingState.lastStev.track == drawingState.lastStev.next?.track\n          );\n          if (triple) {\n            drawingState.lastStev.time = this.viewState.pointerTime;\n            drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.floating), 1);\n          } else {\n            drawingState.lastStev = drawingState.floating;\n          }\n          drawingState.floating = null;\n        }\n      }\n      if (konvaEvent.evt.button == 2) {\n        if (drawingState.lastStev == drawingState.stableEnd) {\n          if (drawingState.floating) {\n            drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.floating), 1);\n          }\n          this.viewState.drawingState = null;\n        } else {\n          const newLastStev = drawingState.direction > 0 ? drawingState.lastStev.prev : drawingState.lastStev.next;\n          if (newLastStev) {\n            drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.lastStev), 1);\n            drawingState.lastStev = newLastStev;\n          } else {\n            this.$delete(this.diagram.trains, drawingState.train.id);\n            this.viewState.drawingState = null;\n          }\n        }\n      }\n    }\n\n    if (konvaEvent.target == konvaEvent.currentTarget && \n        !konvaEvent.evt.ctrlKey && \n        !this.stageDragState?.dragging && \n        !this.viewState.trainPathDragState?.dragging && \n        !this.viewState.drawingState) {\n      this.viewState.trainSelections = {};\n    }\n  }\n\n  onStageDoubleClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget && this.viewState.drawingState) {\n      const drawingState = this.viewState.drawingState;\n      if (drawingState.floating) {\n        drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.floating), 1);\n      }\n      if (drawingState.train.stevs.length <= 1) {\n        this.$delete(this.diagram.trains, drawingState.train.id);\n      } else {\n        const stableEnd = drawingState.stableEnd;\n        if (stableEnd) {\n          const stableIndex = drawingState.train.stevs.indexOf(stableEnd);\n          const addedStevs = drawingState.direction > 0 ? \n            drawingState.train.stevs.filter((e, i) => i > stableIndex) : drawingState.train.stevs.filter((e, i) => i < stableIndex);\n          if (drawingState.direction > 0) {\n            this.historyManager.push({\n              undo: () => { drawingState.train.stevs.splice(stableIndex + 1); },\n              redo: () => { addedStevs.forEach(stev => drawingState.train.stevs.push(stev)); }\n            });\n          } else {\n            this.historyManager.push({\n              undo: () => { drawingState.train.stevs.splice(0, stableIndex); },\n              redo: () => { drawingState.train.stevs = addedStevs.concat(drawingState.train.stevs); }\n            });\n          }\n        } else {\n          this.historyManager.push({\n            undo: () => { this.$delete(this.diagram.trains, drawingState.train.id); },\n            redo: () => { this.$set(this.diagram.trains, drawingState.train.id, drawingState.train) }\n          });\n        }\n      }\n      this.viewState.drawingState = null;\n      this.viewState.trainSelections = {};\n    } else if (konvaEvent.target == konvaEvent.currentTarget && this.viewConfig.editMode) {\n      if (konvaEvent.evt.clientX >= this.diagram.config.leftPaneWidth) {\n        const targetLine = this.viewState.pointerTargetLine;\n        if (targetLine && (targetLine.track || !targetLine.station.expanded)) {\n          const track = targetLine.track ?? targetLine.station.tracks[0];\n          const train = this.diagram.addNewTrain(new Train(this.diagram.genId(), \"\"));\n          train.addNewStopEvent(new StopEvent(train, track, this.viewState.pointerTime));\n          this.viewState.trainSelections = { [train.id]: { train: train, stevRange: null } };\n          this.viewState.drawingState = {\n            train: this.diagram.trains[train.id],\n            lastStev: this.diagram.trains[train.id].stevs[0],\n            direction: 0,\n            stableEnd: null,\n            floating: null\n          };\n        }\n      } else {\n        const relY = this.diagram.getRelYByY(konvaEvent.evt.clientY);\n        const prevSta = this.stationsInMileageOrder.reverse().find(s => s.topRelY < relY);\n        const mileage = prevSta ?\n          (relY - prevSta.bottomRelY) / this.diagram.config.yScale + prevSta.mileage :\n          relY / this.diagram.config.yScale;\n        const station = Station.fromJSON({\n          id: this.diagram.genId(),\n          name: \"\",\n          mileage,\n          tracks: [ { id: this.diagram.genId(), name: \"\" } ],\n        });\n        this.$set(this.diagram.stations, station.id, station);\n        this.historyManager.push({\n          undo: () => { this.$delete(this.diagram.stations, station.id) },\n          redo: () => { this.$set(this.diagram.stations, station.id, station) }\n        });\n        this.$emit(\"updateY\");\n\n        this.viewState.stationNameInputTarget = station;\n        this.$emit(\"stationNameInputStart\");\n      }\n    }\n  }\n\n  onStageMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget) {\n      this.startDrag(konvaEvent.evt.screenX, konvaEvent.evt.screenY);\n    }\n  }\n\n  onPanStart(event: { center: { x: number, y: number } }): void {\n    this.startDrag(event.center.x, event.center.y);\n  }\n\n  startDrag(x: number, y: number): void {\n    this.stageDragState = {\n      scrollX0: this.diagram.config.scrollX,\n      scrollY0: this.diagram.config.scrollY,\n      x0: x,\n      y0: y,\n      dragging: false,\n    };\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    this.moveDrag(event.screenX, event.screenY);\n  }\n\n  onPanMove(event: { center: { x: number, y: number } }): void {\n    this.moveDrag(event.center.x, event.center.y);\n  }\n\n  moveDrag(x: number, y: number): void {\n    if (this.stageDragState) {\n      if (Math.hypot(x - this.stageDragState.x0, y - this.stageDragState.y0) > 1) {\n        this.stageDragState.dragging = true;\n      }\n      if (this.stageDragState.dragging) {\n        this.stageDragState.dragging = true;\n        this.diagram.config.scrollX = this.stageDragState.scrollX0 - (x - this.stageDragState.x0);\n        this.diagram.config.scrollY = \n          Math.max(0, Math.min(this.diagram.maxRelY + this.diagram.config.topPaneHeight - this.viewState.viewHeight, \n            this.stageDragState.scrollY0 - (y - this.stageDragState.y0)));\n      }\n    }\n  }\n\n  onWindowMouseUp(event: MouseEvent): void {\n    this.endDrag(event.screenX, event.screenY);\n  }\n\n  onPanEnd(event: { center: { x: number, y: number } }): void {\n    this.endDrag(event.center.x, event.center.y);\n  }\n\n  endDrag(x: number, y: number): void {\n    if (this.stageDragState) {\n      this.moveDrag(x, y);\n      this.stageDragState = null;\n    }\n  }\n\n  onStageMouseWheel(konvaEvent: KonvaEventObject<WheelEvent>): void {\n    const f = Math.pow(2, -konvaEvent.evt.deltaY * this.viewConfig.wheelScale * 0.001);\n    this.diagram.config.scrollX += (f - 1) * (konvaEvent.evt.clientX - this.diagram.config.leftPaneWidth + this.diagram.config.scrollX);\n    this.diagram.config.scrollY = \n      Math.max(0, Math.min(this.diagram.maxRelY + this.diagram.config.topPaneHeight - this.viewState.viewHeight,\n      this.diagram.config.scrollY + (f - 1) * (konvaEvent.evt.clientY - this.diagram.config.topPaneHeight + this.diagram.config.scrollY)));\n    this.diagram.config.xScale *= f;\n    this.diagram.config.yScale *= f;\n    this.$emit(\"updateY\");\n    konvaEvent.evt.preventDefault();\n  }\n\n  onKeyDown(event: KeyboardEvent): void {\n    if (!event.repeat) {\n      if (event.key == \"Shift\") {\n        this.viewState.pointerPreciseState = {\n          sx0: this.viewState.pointerScreenX,\n          t0: this.viewState.pointerTime\n        };\n      }\n      if (event.key == \"Control\") {\n        this.viewState.controlKeyPressed = true;\n      }\n      if (event.key == \"Delete\" && this.viewConfig.editMode && !this.viewState.busy) {\n        const deletingTrains: Train[] = [];\n        const deletingStevs: { stev: StopEvent, index: number }[] = [];\n        for (const sel of Object.values(this.viewState.trainSelections)) {\n          if (!sel.stevRange) {\n            deletingTrains.push(sel.train);\n          } else {\n            const fromIndex = sel.train.stevs.indexOf(sel.stevRange.from);\n            const toIndex = sel.train.stevs.indexOf(sel.stevRange.to);\n            const size = toIndex - fromIndex + 1;\n            if (size >= sel.train.stevs.length - 1) {\n              deletingTrains.push(sel.train);\n            } else {\n              for (let i = fromIndex; i <= toIndex; ++i) {\n                deletingStevs.push({ stev: sel.train.stevs[i], index: i });\n              }\n            }\n          }\n        }\n        deletingTrains.forEach(train => this.$delete(this.diagram.trains, train.id));\n        deletingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n        this.historyManager.push({\n          undo: () => {\n            deletingStevs.forEach(e => e.stev.train.addNewStopEvent(e.stev, e.index));\n            deletingTrains.forEach(train => this.$set(this.diagram.trains, train.id, train));\n          },\n          redo: () => {\n            deletingTrains.forEach(train => this.$delete(this.diagram.trains, train.id));\n            deletingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n          }\n        });\n        this.viewState.trainSelections = {};\n      }\n    }\n  }\n\n  onKeyUp(event: KeyboardEvent): void {\n    if (event.key == \"Shift\") {\n      this.viewState.pointerPreciseState = null;\n    }\n    if (event.key == \"Control\") {\n      this.viewState.controlKeyPressed = false;\n    }\n  }\n\n  onContextMenu(konvaEvent: KonvaEventObject<MouseEvent>): boolean {\n    konvaEvent.evt.preventDefault();\n    return false;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Stage.vue?vue&type=template&id=58055f2f&scoped=true&\"\nimport script from \"./Stage.vue?vue&type=script&lang=ts&\"\nexport * from \"./Stage.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"58055f2f\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.viewConfig.editMode && _vm.station.expanded && _vm.isBottomLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":\"plus\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport Track from \"@/data/Track\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationAddTrackButton extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelRightMargin}px`,\n      top: `${this.diagram.getYByRelY(this.station.bottomRelY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isBottomLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.bottomRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.inputEnabled) {\n      const newTrack = this.station.addNewTrack(new Track(this.station, this.diagram.genId(), \"\"));\n      this.historyManager.push({\n        undo: () => { this.station.removeTrack(newTrack); },\n        redo: () => { this.station.addNewTrack(newTrack); }\n      });\n      this.$emit(\"updateY\");\n\n      this.viewState.trackNameInputTarget = newTrack;\n      this.$emit(\"trackNameInputStart\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationAddTrackButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationAddTrackButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationAddTrackButton.vue?vue&type=template&id=5b8586aa&scoped=true&\"\nimport script from \"./StationAddTrackButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationAddTrackButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5b8586aa\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isBottomLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":_vm.icon,\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationExpandButton extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() station!: Station;\n\n  get icon(): string {\n    return this.station.expanded ? \"chevron-up\" : \"chevron-down\";\n  }\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.stationLabelLeftMargin}px`,\n      top: `${this.diagram.getYByRelY(this.station.bottomRelY)}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isBottomLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.bottomRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.inputEnabled) {\n      this.$set(this.station, \"expanded\", !this.station.expanded);\n      this.$emit(\"updateY\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationExpandButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationExpandButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationExpandButton.vue?vue&type=template&id=154aa5d4&scoped=true&\"\nimport script from \"./StationExpandButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationExpandButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"154aa5d4\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.stationNameInputTarget),expression:\"viewState.stationNameInputTarget\"}],style:(_vm.style),domProps:{\"value\":_vm.targetStation.name},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onComplete($event)},\"blur\":_vm.onComplete}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationNameInput extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n\n  get targetStation(): Station | Record<string, never> {\n    return this.viewState.stationNameInputTarget ?? {};\n  }\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.stationLabelLeftMargin}px`,\n      top: `${this.diagram.getYByRelY(this.targetStation.topRelY) - this.diagram.config.stationLabelFontSize - 4}px`,\n      width: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.stationLabelRightMargin}px`,\n      height: `${this.diagram.config.stationLabelFontSize + 4}px`,\n      paddingTop: \"2px\",\n      lineHeight: `${this.diagram.config.stationLabelFontSize}px`,\n      border: \"none\",\n      fontSize: `${this.diagram.config.stationLabelFontSize}px`,\n    };\n  }\n\n  onComplete(): void {\n    const targetStation = this.targetStation;\n    const name0 = this.targetStation.name;\n    const name1 = (this.$el as HTMLInputElement).value;\n    targetStation.name = name1;\n    this.historyManager.push({\n      undo: () => { targetStation.name = name0; },\n      redo: () => { targetStation.name = name1; }\n    });\n    this.viewState.stationNameInputTarget = null;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationNameInput.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationNameInput.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationNameInput.vue?vue&type=template&id=9f0b4232&scoped=true&\"\nimport script from \"./StationNameInput.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationNameInput.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9f0b4232\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.viewConfig.editMode && _vm.isTopLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":\"close\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport StopEvent from \"@/data/StopEvent\";\nimport Train from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationRemoveButton extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelRightMargin}px`,\n      top: `${this.diagram.getYByRelY(this.station.topRelY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isTopLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.topRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.topRelY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.busy) {\n      const removingTrains: Train[] = [];\n      const removingStevs: { stev: StopEvent, index: number }[] = [];\n      for (const train of Object.values(this.diagram.trains)) {\n        for (let i = train.stevs.length - 1; i >= 0; --i) {\n          const stev = train.stevs[i];\n          if (stev.station == this.station) {\n            train.removeStopEvent(stev);\n            removingStevs.push({ stev, index: i });\n            if (train.stevs.length <= 1) {\n              this.diagram.removeTrain(train);\n              removingTrains.push(train);\n            }\n          }\n        }\n      }\n\n      this.$delete(this.diagram.stations, this.station.id);\n\n      this.historyManager.push({\n        undo: () => { \n          this.$set(this.diagram.stations, this.station.id, this.station);\n          removingTrains.forEach(train => this.diagram.addNewTrain(train)); \n          removingStevs.forEach(e => e.stev.train.addNewStopEvent(e.stev, e.index));\n        },\n        redo: () => { \n          removingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n          removingTrains.forEach(train => this.diagram.removeTrain(train)); \n          this.$delete(this.diagram.stations, this.station.id); \n        }\n      });\n      this.$emit(\"updateY\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationRemoveButton.vue?vue&type=template&id=234953ee&scoped=true&\"\nimport script from \"./StationRemoveButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationRemoveButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"234953ee\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.viewConfig.editMode && _vm.station.expanded && Object.values(_vm.station.tracks).length > 1 && _vm.isLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":\"close\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport StopEvent from \"@/data/StopEvent\";\nimport Track from \"@/data/Track\";\nimport Train from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationRemoveTrackButton extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n  @Prop() track!: Track;\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelRightMargin}px`,\n      top: `${this.diagram.getYByRelY(this.track.relY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.track.relY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.track.relY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.busy) {\n      const removingTrains: Train[] = [];\n      const removingStevs: { stev: StopEvent, index: number }[] = [];\n      for (const train of Object.values(this.diagram.trains)) {\n        for (let i = train.stevs.length - 1; i >= 0; --i) {\n          const stev = train.stevs[i];\n          if (stev.track == this.track) {\n            train.removeStopEvent(stev);\n            removingStevs.push({ stev, index: i });\n            if (train.stevs.length <= 1) {\n              this.diagram.removeTrain(train);\n              removingTrains.push(train);\n            }\n          }\n        }\n      }\n      removingStevs.reverse();\n      const trackIndex = this.station.tracks.indexOf(this.track);\n\n      this.station.removeTrack(this.track);\n\n      this.historyManager.push({\n        undo: () => { \n          this.station.addNewTrack(this.track, trackIndex); \n          removingTrains.forEach(train => this.diagram.addNewTrain(train)); \n          removingStevs.forEach(e => e.stev.train.addNewStopEvent(e.stev, e.index));\n        },\n        redo: () => { \n          removingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n          removingTrains.forEach(train => this.diagram.removeTrain(train)); \n          this.station.removeTrack(this.track);\n        }\n      });\n      this.$emit(\"updateY\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationRemoveTrackButton.vue?vue&type=template&id=457c01f8&scoped=true&\"\nimport script from \"./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"457c01f8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.trackNameInputTarget),expression:\"viewState.trackNameInputTarget\"}],style:(_vm.style),domProps:{\"value\":_vm.targetTrack.name},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onComplete($event)},\"blur\":_vm.onComplete}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Track from \"@/data/Track\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class TrackNameInput extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n\n  get targetTrack(): Track | Record<string, never> {\n    return this.viewState.trackNameInputTarget ?? {};\n  }\n\n  get style(): unknown {\n    return this.viewState.trackNameInputTarget ?\n      {\n        left: `${this.diagram.config.stationLabelLeftMargin + this.diagram.config.trackLabelLeftMargin}px`,\n        top: `${this.diagram.getYByRelY(this.targetTrack.relY) - this.diagram.config.stationLabelFontSize - 4}px`,\n        width: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.trackLabelLeftMargin - this.diagram.config.stationLabelRightMargin}px`,\n        height: `${this.diagram.config.stationLabelFontSize + 4}px`,\n        paddingTop: \"2px\",\n        lineHeight: `${this.diagram.config.stationLabelFontSize}px`,\n        border: \"none\",\n        fontSize: `${this.diagram.config.stationLabelFontSize}px`,\n      } : {};\n  }\n\n  onComplete(): void {\n    const targetTrack = this.targetTrack;\n    const name0 = targetTrack.name;\n    const name1 = (this.$el as HTMLInputElement).value;\n    targetTrack.name = name1;\n    this.historyManager.push({\n      undo: () => { targetTrack.name = name0; },\n      redo: () => { targetTrack.name = name1; }\n    });\n    this.viewState.trackNameInputTarget = null;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackNameInput.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackNameInput.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrackNameInput.vue?vue&type=template&id=652c3fab&scoped=true&\"\nimport script from \"./TrackNameInput.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrackNameInput.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"652c3fab\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Provide, ProvideReactive, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport Stage from \"./Stage.vue\";\nimport StationAddTrackButton from \"./StationAddTrackButton.vue\";\nimport StationExpandButton from \"./StationExpandButton.vue\";\nimport StationNameInput from \"./StationNameInput.vue\";\nimport StationRemoveButton from \"./StationRemoveButton.vue\";\nimport StationRemoveTrackButton from \"./StationRemoveTrackButton.vue\";\nimport TrackNameInput from \"./TrackNameInput.vue\";\n\n@Component({\n  components: {\n    Stage, StationAddTrackButton, StationExpandButton, StationNameInput, StationRemoveButton, StationRemoveTrackButton, TrackNameInput\n  },\n})\nexport default class DiagramView extends Vue {\n  @Prop({ default: () => Diagram.fromJSON({ stations: [], trains: [] }) }) @ProvideReactive() diagram!: Diagram;\n  @Prop({ default: new ViewConfig() }) @ProvideReactive() viewConfig!: ViewConfig;\n  @Prop() @Provide() historyManager!: HistoryManager;\n  @ProvideReactive() viewState = new ViewState();\n\n  mounted(): void {\n    const resizeObserver = new ResizeObserver(this.updateViewSize);\n    resizeObserver.observe(this.$el);\n  }\n\n  onStationNameInputStart(): void {\n    this.$nextTick(() => ((this.$refs.stationNameInput as Vue).$el as HTMLInputElement).focus());\n  }\n\n  onTrackNameInputStart(): void {\n    this.$nextTick(() => ((this.$refs.trackNameInput as Vue).$el as HTMLInputElement).focus());\n  }\n\n  updateViewSize(): void {\n    if (this.$el) {\n      this.viewState.viewWidth = this.$el.clientWidth;\n      this.viewState.viewHeight = this.$el.clientHeight;\n    }\n  }\n\n  updateY(): void {\n    this.diagram.updateY();\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DiagramView.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DiagramView.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./DiagramView.vue?vue&type=template&id=d5ac33d8&scoped=true&\"\nimport script from \"./DiagramView.vue?vue&type=script&lang=ts&\"\nexport * from \"./DiagramView.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./DiagramView.vue?vue&type=style&index=0&id=d5ac33d8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d5ac33d8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-carousel',{attrs:{\"autoplay\":false,\"indicator-inside\":false}},[_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_add_new_station.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewStationTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewStationBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_add_new_train.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewTrainTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewTrainBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_select_train.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.selectTrainTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.selectTrainBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_edit_train.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTrainTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTrainBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_edit_time.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTimeTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTimeBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_tips.png\")}}),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.tipsTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.tipsBody'))}})])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\n\n@Component\nexport default class HelpPane extends Vue {\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HelpPane.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HelpPane.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./HelpPane.vue?vue&type=template&id=da68d834&scoped=true&\"\nimport script from \"./HelpPane.vue?vue&type=script&lang=ts&\"\nexport * from \"./HelpPane.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./HelpPane.vue?vue&type=style&index=0&id=da68d834&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"da68d834\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"./HistoryManager\";\nimport Diagram from \"./data/Diagram\";\nimport ViewConfig from \"./data/ViewConfig\";\nimport DiagramView from \"./components/DiagramView.vue\";\nimport HelpPane from \"./components/HelpPane.vue\";\n\n@Component({\n  components: {\n    DiagramView, HelpPane \n  },\n})\nexport default class App extends Vue {\n  diagramFileName = \"diagram.json\";\n  diagram = Diagram.fromJSON({ stations: [], trains: [] });\n  viewConfig = new ViewConfig();\n  historyManager = new HistoryManager(100);\n  helpPaneVisible = false;\n\n  mounted(): void {\n    fetch(\"sample-diagram.json\").then(async result => {\n      const json = await result.json();\n      this.diagram = Diagram.fromJSON(json);\n      this.diagramFileName = \"sample-diagram.json\";\n    });\n  }\n\n  onEditButtonClick(): void {\n    this.viewConfig.editMode = !this.viewConfig.editMode;\n  }\n\n  onUndoButtonClick(): void {\n    this.historyManager.undo();\n  }\n\n  onRedoButtonClick(): void {\n    this.historyManager.redo();\n  }\n\n  onVanishButtonClick(): void {\n    if (Object.keys(this.diagram.trains).length > 0) {\n      const trains = this.diagram.trains;\n      this.historyManager.push({\n        undo: () => { this.diagram.trains = trains; },\n        redo: () => { this.diagram.trains = {}; }\n      });\n      this.diagram.trains = {}; \n    } else {\n      const diagram = this.diagram;\n      this.historyManager.push({\n        undo: () => { this.diagram = diagram; },\n        redo: () => { this.diagram = Diagram.fromJSON({ stations: {}, trains: {} }); }\n      });\n      this.diagram = Diagram.fromJSON({ stations: {}, trains: {} }); \n    }\n  }\n\n  onUploadButtonClick(): void {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \".json, application/json\";\n    input.onchange = () => {\n      const reader = new FileReader();\n      if (input.files && input.files.length > 0) {\n        const file = input.files[0];\n        reader.readAsText(file);\n        reader.onload = () => {\n          if (typeof(reader.result) == \"string\") {\n            try {\n              const data = JSON.parse(reader.result);\n              this.diagram = Diagram.fromJSON(data);\n              this.diagramFileName = file.name;\n              this.historyManager.clear();\n            } catch (e) {\n              this.$buefy.notification.open({\n                type: \"is-danger\",\n                message: `${this.$t(\"message.failedToLoadJSON\").toString()}<br>${file.name}`,\n              });\n            }\n          }\n        };\n      }\n    };\n    input.click();\n  }\n\n  onDownloadButtonClick(): void {\n    const json = JSON.stringify(this.diagram);\n    const blob = new Blob([ json ], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = this.diagramFileName;\n    a.click();\n  }\n\n  onHelpButtonClick(): void {\n    this.helpPaneVisible = !this.helpPaneVisible;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=1ff41357&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\n    ja: {\n        message: {\n            confirmRemoveStationRefered: \"この駅を使用している列車があります。駅を削除すると、列車の時刻情報も削除されます。よろしいですか？\",\n            confirmRemoveTrackRefered: \"この番線を使用している列車があります。番線を削除すると、列車の時刻情報も削除されます。よろしいですか？\",\n            failedToLoadJSON: \"ファイルの読み込みに失敗しました。\",\n            editButtonTooltip: \"編集モード\",\n            undoButtonTooltip: \"元に戻す\",\n            redoButtonTooltip: \"やり直す\",\n            vanishTrainsButtonTooltip: \"列車をクリア\",\n            vanishStationsButtonTooltip: \"駅をクリア\",\n            uploadButtonTooltip: \"ダイヤファイルを読み込む\",\n            downloadButtonTooltip: \"ダイヤファイルを保存する\",\n            helpButtonTooltip: \"操作方法\",\n            help: {\n                addNewStationTitle: \"駅を追加する\",\n                addNewStationBody: \n                    \"<p>左側の駅名エリアをダブルクリックすると、新しい駅を追加できます。</p>\" +\n                    \"<ul><li>駅名をドラッグすると、駅線の位置を調整できます。\" +\n                    \"<li>駅名をクリックすると、駅名を編集できます。\" +\n                    \"<li>駅右側の<i class='mdi mdi-close'></i>アイコンをクリックすると、駅を削除できます。</ul>\",\n                addNewTrainTitle: \"列車を追加する\",\n                addNewTrainBody:\n                    \"<p>駅線の上でダブルクリックすると、新しい列車を追加できます。駅線を続けてクリックして、停車駅を順に追加できます。</p>\" +\n                    \"<ul><li>列車線の編集を終了するには、もう一度ダブルクリックします。\" +\n                    \"<li>Shiftキーを押しながらカーソルを動かすと、秒単位で時刻を指定できます。\" +\n                    \"<li>右クリックすると、追加した停車駅を順に削除します。</ul>\",\n                selectTrainTitle: \"列車を選択する\",\n                selectTrainBody:\n                    \"<p>列車線をクリックすると、列車を選択できます。</p>\" +\n                    \"<ul><li>Ctrlキーを押しながら別の列車線クリックすると、複数列車を選択できます。\" +\n                    \"<li>列車を選択した状態でさらにクリックすると、特定の駅または駅間を選択できます。<br>Ctrlキーを押しながらクリックすると、複数駅間を選択できます。</ul>\",\n                editTrainTitle: \"列車を編集する\",\n                editTrainBody:\n                    \"<p>列車を選択した状態では、さまざまな方法で列車を編集できます。</p>\" +\n                    \"<ul><li>列車線と駅線の交点をダブルクリックすると、停車駅を追加できます。\" +\n                    \"<li>列車線の始端・終端をダブルクリックすると、列車を延長できます。\" +\n                    \"<li>Deleteキーを押すと、選択した区間を削除できます。</ul>\",\n                editTimeTitle: \"着発時刻を編集する\",\n                editTimeBody: \n                    \"<p>列車を選択した状態では、さまざまな方法で時刻を編集できます。</p>\" +\n                    \"<ul><li>列車線をドラッグすると、選択した区間の時刻を変更できます。\" +\n                    \"<li>Shiftキーを押しながらカーソルを動かすと、秒単位で時刻を指定できます。\" +\n                    \"<li>番線を開いた状態でドラッグすることで、着発番線を変更できます。\",\n                tipsTitle: \"便利な機能\",\n                tipsBody: \n                    \"<p>その他にも、さまざまな便利な機能があります。</p>\" +\n                    \"<ul><li>列車線を選択した状態でCtrlキーを押しながらドラッグすると、列車線をコピーできます。\" +\n                    \"<li><i class='mdi mdi-upload'></i>ボタンを押すと、ローカルファイルのダイヤデータをロードできます。\" +\n                    \"<li><i class='mdi mdi-download'></i>ボタンを押すと、ダイヤデータをローカルファイルに保存できます。\"\n            },\n        },\n    },\n};\n","import Vue from \"vue\";\nimport Buefy from \"buefy\";\nimport \"buefy/dist/buefy.css\";\nimport VueI18n from \"vue-i18n\";\nimport VueKonva from \"vue-konva\";\nimport { VueHammer } from \"vue2-hammer\";\nimport App from \"./App.vue\";\nimport messages from \"./messages\";\n\nVue.config.productionTip = false\nVue.use(Buefy, {\n  defaultNotificationDuration: 5000,\n  defaultNotificationPosition: \"is-bottom-right\",\n});\nVue.use(VueI18n);\nVue.use(VueKonva);\nVue.use(VueHammer);\n\nconst i18n = new VueI18n({\n  locale: \"ja\",\n  messages,\n});\n\nnew Vue({\n  render: h => h(App),\n  i18n,\n}).$mount(\"#app\");\n","module.exports = __webpack_public_path__ + \"img/logo.b1deff45.png\";"],"sourceRoot":""}