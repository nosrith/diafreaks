{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/assets/help_edit_train.png","webpack:///./src/assets/help_select_train.png","webpack:///./src/App.vue?c650","webpack:///./src/assets/help_tips.png","webpack:///./src/components/HelpPane.vue?cfbd","webpack:///./src/assets/help_edit_time.png","webpack:///./src/components/DiagramView.vue?8ddd","webpack:///./src/assets/help_add_new_train.png","webpack:///./src/assets/help_add_new_station.png","webpack:///./src/App.vue?e71b","webpack:///./src/HistoryManager.ts","webpack:///./src/data/DiagramConfig.ts","webpack:///./src/data/Track.ts","webpack:///./src/data/Station.ts","webpack:///./src/data/StopEvent.ts","webpack:///./src/data/Train.ts","webpack:///./src/data/Diagram.ts","webpack:///./src/data/ViewConfig.ts","webpack:///./src/components/DiagramView.vue?aa10","webpack:///./src/data/ViewState.ts","webpack:///./src/components/Stage.vue?c4af","webpack:///./src/components/BackLayer.vue?ea83","webpack:///./src/components/StationGroup.vue?ea6b","webpack:///./src/components/TrackGroup.vue?2b0b","webpack:///./src/components/TrackGroup.vue","webpack:///./src/components/TrackGroup.vue?80ea","webpack:///./src/components/TrackGroup.vue?a194","webpack:///./src/components/StationGroup.vue","webpack:///./src/components/StationGroup.vue?f322","webpack:///./src/components/StationGroup.vue?1b58","webpack:///./src/components/BackLayer.vue","webpack:///./src/components/BackLayer.vue?3b1f","webpack:///./src/components/BackLayer.vue?c43c","webpack:///./src/components/Pointer.vue?432d","webpack:///./src/utils.ts","webpack:///./src/components/Pointer.vue","webpack:///./src/components/Pointer.vue?63e5","webpack:///./src/components/Pointer.vue?a4a9","webpack:///./src/components/TrainPathLayer.vue?2624","webpack:///./src/components/TrainPathGroup.vue?bd05","webpack:///./src/components/TrainPathMarker.vue?5598","webpack:///./src/components/TrainPathMarker.vue","webpack:///./src/components/TrainPathMarker.vue?ce7d","webpack:///./src/components/TrainPathMarker.vue?a47c","webpack:///./src/components/TrainPathGroup.vue","webpack:///./src/components/TrainPathGroup.vue?c604","webpack:///./src/components/TrainPathGroup.vue?fe26","webpack:///./src/components/TrainPathLayer.vue","webpack:///./src/components/TrainPathLayer.vue?75af","webpack:///./src/components/TrainPathLayer.vue?44a2","webpack:///./src/components/Stage.vue","webpack:///./src/components/Stage.vue?091d","webpack:///./src/components/Stage.vue?d206","webpack:///./src/components/StationAddTrackButton.vue?bd44","webpack:///./src/components/StationAddTrackButton.vue","webpack:///./src/components/StationAddTrackButton.vue?f328","webpack:///./src/components/StationAddTrackButton.vue?b738","webpack:///./src/components/StationExpandButton.vue?becf","webpack:///./src/components/StationExpandButton.vue","webpack:///./src/components/StationExpandButton.vue?8892","webpack:///./src/components/StationExpandButton.vue?e10d","webpack:///./src/components/StationNameInput.vue?1acc","webpack:///./src/components/StationNameInput.vue","webpack:///./src/components/StationNameInput.vue?fcac","webpack:///./src/components/StationNameInput.vue?9ce9","webpack:///./src/components/StationRemoveButton.vue?0e3a","webpack:///./src/components/StationRemoveButton.vue","webpack:///./src/components/StationRemoveButton.vue?6092","webpack:///./src/components/StationRemoveButton.vue?7287","webpack:///./src/components/StationRemoveTrackButton.vue?6665","webpack:///./src/components/StationRemoveTrackButton.vue","webpack:///./src/components/StationRemoveTrackButton.vue?2de7","webpack:///./src/components/StationRemoveTrackButton.vue?c700","webpack:///./src/components/TrackNameInput.vue?56bb","webpack:///./src/components/TrackNameInput.vue","webpack:///./src/components/TrackNameInput.vue?2a59","webpack:///./src/components/TrackNameInput.vue?4243","webpack:///./src/components/DiagramView.vue","webpack:///./src/components/DiagramView.vue?0f5f","webpack:///./src/components/DiagramView.vue?613b","webpack:///./src/components/HelpPane.vue?8df7","webpack:///./src/components/HelpPane.vue","webpack:///./src/components/HelpPane.vue?3172","webpack:///./src/components/HelpPane.vue?a5ad","webpack:///./src/App.vue","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/messages.ts","webpack:///./src/main.ts","webpack:///./src/assets/logo.png"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","diagram","viewConfig","historyManager","_e","_m","staticClass","$t","class","editMode","on","onEditButtonClick","directives","rawName","expression","undoable","onUndoButtonClick","redoable","onRedoButtonClick","keys","trains","onVanishButtonClick","onUploadButtonClick","onDownloadButtonClick","helpPaneVisible","onHelpButtonClick","staticRenderFns","capacity","undos","redos","elem","pop","undo","redo","minimumTimeUnit","fontFamily","topPaneHeight","hourlyLabelBottomMargin","hourlyLabelFontSize","hourlyLabelColor","hourlyGridLineWidth","hourlyGridLineColor","majorMinutelyGridLineSpan","majorMinutelyGridLineWidth","majorMinutelyGridLineColor","minorMinutelyGridLineSpan","minorMinutelyGridLineWidth","minorMinutelyGridLineColor","leftPaneWidth","stationLabelLeftMargin","stationLabelRightMargin","stationLabelFontSize","stationLabelColor","stationLineWidth","stationLineColor","plotPaneVerticalPadding","trackLabelLeftMargin","trackLabelFontSize","trackLabelColor","trackLineWidth","trackLineColor","trackLineSpan","scrollX","scrollY","xScale","yScale","trainPathWidth","trainPathColor","dc","DiagramConfig","assign","station","id","relY","Track","mileage","expanded","topRelY","bottomRelY","tracks","track","index","indexOf","Array","isArray","Station","map","fromJSON","forEach","train","time","privateId","StopEvent","maxPrivateId","stevs","undefined","stations","stationId","trackId","arrTime","depTime","find","stev","stevRange","inRange","from","to","stops","lastStop","Train","flatMap","fromJSONStop","config","maxId","maxRelY","y","x","values","sort","a","b","set","delete","getStationsInMileageOrder","initialMileage","lastMileage","fromEntries","Diagram","Math","max","updateY","minHitWidth","pointerWidth","pointerColor","pointerLabelFontSize","pointerPrecisePixelPerTimeUnit","selectedTrackLabelColor","selectedTrackLineColor","selectedTrainPathColor","selectedTrainPathWidthScale","selectedTrainPathMarkerWidth","selectedTrainPathMarkerColor","unselectedTrainPathOpacity","markerLabelMaxDistance","markerLabelColor","markerLabelFontSize","markerLabelLineHeight","wheelScale","onStationNameInputStart","onTrackNameInputStart","ref","_l","viewWidth","viewHeight","trainSelections","pointerScreenX","pointerTime","pointerY","pointerTargetTrainPath","pointerTargetLine","pointerPreciseState","drawingState","trainPathDragState","stationNameInputTarget","trackNameInputTarget","controlKeyPressed","inputEnabled","arg","stageConfig","onStageMouseDown","onStageMouseMove","onStageClick","onStageDoubleClick","onStageMouseWheel","onContextMenu","_g","$listeners","lineConfig","labelConfig","topLineConfig","labelRectConfig","onStationLabelClick","onStationLabelMouseDown","isBottomLineIntersectingPlotPane","bottomLineConfig","onLabelClick","onLabelMouseDown","dragState","points","getYByRelY","viewState","stroke","strokeWidth","listening","width","height","text","fontSize","fill","align","verticalAlign","busy","$emit","konvaEvent","sy0","evt","screenY","index0","dragging","addEventListener","onWindowMouseMove","onWindowMouseUp","event","abs","currentIndex","findIndex","mouseRelY","getRelYByY","clientY","newIndex","removeEventListener","index1","removeTrack","addNewTrack","component","widthForChars","charSpan","mileage0","mileage1","components","TrackGroup","lines","scrollLeftTime","ceil","StationGroup","rectConfig","getTimeText","forceSec","hStr","floor","mmStr","padStart","ssStr","getXByTime","layerConfig","filter","regularTrainPathConfig","onTrainPathClick","onTrainPathMouseMove","selectedTrainPathConfig","onSelectedTrainPathClick","onSelectedTrainPathDoubleClick","onSelectedTrainPathMouseDown","onSelectedTrainPathMouseMove","onMarkerClick","onMarkerMouseDown","$event","trainPathNode","onRectMouseMove","onRectDoubleClick","phase","labelPosition","getLabelPosition","thisStev","prevStev","prev","nextStev","next","thisRelY","prevRelY","lastStev","direction","stableEnd","floating","regularTrainPathNodes","opacity","hitStrokeWidth","getTrainPathNodes","selectedTrainPathNodes","sel","getStopEventsInRange","shiftEnabled","targets","shiftTime","timeShift","shiftRange","inShiftRange","getPointedStevRange","clientX","clickedStopRange","changeTrainSelections","clickedStevRange","clickSelected","ctrlKey","selectedStevRange","selStart","selEnd","changed","$delete","$set","leftX","rightX","topY","min","bottomY","targetTime","nearestStation","getNearestStation","nearestStev","getNearestStopEvent","newStev","addNewStopEvent","minSta","minDist","minStop","minTimeShift","maxTimeShift","changeTrackTargets","firstNode","t0","y0","sx0","screenX","track0","changeTimeTargets","node","hypot","targetStation","mouseTrack","track1","newTrains","srcTrain","srcStevs","newTrain","addNewTrain","genId","srcStev","trainId","removeTrain","TrainPathMarker","clip","TrainPathGroup","stageDragState","pinchState","console","log","document","onKeyDown","onKeyUp","dUnit","round","getTimeByX","findPointerTargetLine","target","currentTarget","targetTrack","stationPointedOnTop","stationsInMileageOrder","stationPointedOnBottom","pointedTrack","button","sign","triple","newLastStev","stableIndex","addedStevs","e","concat","targetLine","prevSta","reverse","startDrag","moveDrag","endDrag","onPanMove","onPanStart","isLast","onPanEnd","center","scrollX0","scrollY0","x0","f","pow","deltaY","preventDefault","scaleX0","scaleY0","scale","repeat","deletingTrains","deletingStevs","fromIndex","toIndex","size","removeStopEvent","BackLayer","Pointer","TrainPathLayer","style","nativeOn","onClick","left","top","newTrack","icon","domProps","type","_k","keyCode","onComplete","paddingTop","lineHeight","border","name0","name1","$el","isTopLineIntersectingPlotPane","removingTrains","removingStevs","isLineIntersectingPlotPane","trackIndex","resizeObserver","ResizeObserver","updateViewSize","observe","$nextTick","$refs","stationNameInput","focus","trackNameInput","clientWidth","clientHeight","default","Stage","StationAddTrackButton","StationExpandButton","StationNameInput","StationRemoveButton","StationRemoveTrackButton","TrackNameInput","_s","diagramFileName","body","fetch","then","json","input","createElement","accept","onchange","reader","FileReader","files","file","readAsText","onload","JSON","parse","clear","$buefy","notification","open","message","toString","click","stringify","blob","Blob","url","URL","createObjectURL","href","download","DiagramView","HelpPane","ja","confirmRemoveStationRefered","confirmRemoveTrackRefered","failedToLoadJSON","editButtonTooltip","undoButtonTooltip","redoButtonTooltip","vanishTrainsButtonTooltip","vanishStationsButtonTooltip","uploadButtonTooltip","downloadButtonTooltip","helpButtonTooltip","help","addNewStationTitle","addNewStationBody","addNewTrainTitle","addNewTrainBody","selectTrainTitle","selectTrainBody","editTrainTitle","editTrainBody","editTimeTitle","editTimeBody","tipsTitle","tipsBody","productionTip","use","defaultNotificationDuration","defaultNotificationPosition","i18n","locale","messages","render","h","$mount"],"mappings":"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","file":"js/app.39252094.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = __webpack_public_path__ + \"img/help_edit_train.67395182.png\";","module.exports = __webpack_public_path__ + \"img/help_select_train.6cd1d819.png\";","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","module.exports = __webpack_public_path__ + \"img/help_tips.12f4142e.png\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HelpPane.vue?vue&type=style&index=0&id=da68d834&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/help_edit_time.25aa545d.png\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DiagramView.vue?vue&type=style&index=0&id=d5ac33d8&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/help_add_new_train.0fab88c8.png\";","module.exports = __webpack_public_path__ + \"img/help_add_new_station.d55b6e32.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('diagram-view',{attrs:{\"id\":\"diagram-view\",\"diagram\":_vm.diagram,\"viewConfig\":_vm.viewConfig,\"historyManager\":_vm.historyManager}}),(_vm.helpPaneVisible)?_c('help-pane',{attrs:{\"id\":\"help-pane\"}}):_vm._e(),_c('div',{attrs:{\"id\":\"nav-pane\"}},[_vm._m(0),_c('span',{attrs:{\"id\":\"nav-pane-buttons\"}},[_c('span',{attrs:{\"id\":\"nav-pane-buttons-left\"}},[_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.editButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{class:_vm.viewConfig.editMode ? 'is-selected': '',attrs:{\"icon-left\":\"pencil-outline\",\"size\":\"medium\"},on:{\"click\":_vm.onEditButtonClick}})],1)],1),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewConfig.editMode),expression:\"viewConfig.editMode\"}],staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.undoButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"undo\",\"size\":\"medium\",\"disabled\":!_vm.historyManager.undoable},on:{\"click\":_vm.onUndoButtonClick}})],1)],1),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewConfig.editMode),expression:\"viewConfig.editMode\"}],staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.redoButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"redo\",\"size\":\"medium\",\"disabled\":!_vm.historyManager.redoable},on:{\"click\":_vm.onRedoButtonClick}})],1)],1),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewConfig.editMode),expression:\"viewConfig.editMode\"}],staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":Object.keys(_vm.diagram.trains).length > 0 ? _vm.$t('message.vanishTrainsButtonTooltip') : _vm.$t('message.vanishStationsButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"vanish\",\"size\":\"medium\"},on:{\"click\":_vm.onVanishButtonClick}})],1)],1),_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.uploadButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"upload\",\"size\":\"medium\"},on:{\"click\":_vm.onUploadButtonClick}})],1)],1),_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.downloadButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{attrs:{\"icon-left\":\"download\",\"size\":\"medium\"},on:{\"click\":_vm.onDownloadButtonClick}})],1)],1)]),_c('span',{attrs:{\"id\":\"nav-pane-buttons-spacer\"}}),_c('span',{attrs:{\"id\":\"nav-pane-buttons-right\"}},[_c('span',{staticClass:\"nav-pane-item\"},[_c('b-tooltip',{attrs:{\"label\":_vm.$t('message.helpButtonTooltip'),\"type\":\"is-light\"}},[_c('b-button',{class:_vm.helpPaneVisible ? 'is-selected': '',attrs:{\"icon-left\":\"help\",\"size\":\"medium\"},on:{\"click\":_vm.onHelpButtonClick}})],1)],1)])])])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',{staticClass:\"nav-pane-item\",attrs:{\"id\":\"nav-pane-logo\"}},[_c('img',{attrs:{\"src\":require(\"@/assets/logo.png\")}})])}]\n\nexport { render, staticRenderFns }","interface HistoryElement {\n    undo: () => void;\n    redo: () => void;\n}\n\nexport default class HistoryManager {\n    constructor(public capacity: number) {}\n    private undos: HistoryElement[] = [];\n    private redos: HistoryElement[] = [];\n\n    get undoable(): boolean { return this.undos.length > 0; }\n    get redoable(): boolean { return this.redos.length > 0; }\n\n    push(elem: HistoryElement): void {\n        if (this.undos.length >= this.capacity) {\n            this.undos.splice(0, this.undos.length - this.capacity + 1);\n        }\n        this.undos.push(elem);\n        this.redos.splice(0);\n    }\n\n    clear(): void {\n        this.undos.splice(0);\n        this.redos.splice(0);\n    }\n\n    undo(): void {\n        const elem = this.undos.pop();\n        if (elem) {\n            this.redos.push(elem);\n            elem.undo();\n        }\n    }\n\n    redo(): void {\n        const elem = this.redos.pop();\n        if (elem) {\n            this.undos.push(elem);\n            elem.redo();\n        }\n    }\n}\n","export default class DiagramConfig {\n    minimumTimeUnit = 5;\n    fontFamily = \"Verdana, sans-serif\";\n    topPaneHeight = 32;\n    hourlyLabelBottomMargin = 4;\n    hourlyLabelFontSize = 16;\n    hourlyLabelColor = \"rgb(128, 192, 128)\";\n    hourlyGridLineWidth = 2.25;\n    hourlyGridLineColor = \"rgb(128, 192, 128)\";\n    majorMinutelyGridLineSpan = 10 * 60;\n    majorMinutelyGridLineWidth = 1.5;\n    majorMinutelyGridLineColor = \"rgb(128, 192, 128)\";\n    minorMinutelyGridLineSpan = 2 * 60;\n    minorMinutelyGridLineWidth = 0.75;\n    minorMinutelyGridLineColor = \"rgb(128, 192, 128)\";\n    leftPaneWidth = 160;\n    stationLabelLeftMargin = 16;\n    stationLabelRightMargin = 16;\n    stationLabelFontSize = 16;\n    stationLabelColor = \"rgb(128, 192, 128)\";\n    stationLineWidth = 1;\n    stationLineColor = \"rgb(128, 192, 128)\";\n    plotPaneVerticalPadding = 4;\n    trackLabelLeftMargin = 10;\n    trackLabelFontSize = 12;\n    trackLabelColor = \"rgb(128, 192, 128)\";\n    trackLineWidth = 0.75;\n    trackLineColor = \"rgb(128, 192, 128)\";\n    trackLineSpan = 12;\n    scrollX = 6 * 3600 * 0.08;\n    scrollY = 0;\n    xScale = 0.08;\n    yScale = 10;\n    trainPathWidth = 1;\n    trainPathColor = \"rgb(0, 0, 0)\";\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any): DiagramConfig {\n        if (!(o && typeof o == \"object\")) {\n            throw \"Invalid JSON\";\n        }\n        const dc = new DiagramConfig();\n        Object.assign(dc, o);\n        return dc;\n    }\n}","import Station from \"./Station\";\n\nexport default class Track {\n    constructor(\n        public readonly station: Station,\n        public readonly id: number, \n        public name: string,\n        public relY = 0,\n    ) {}\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any, station: Station): Track {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && o.id != null)) {\n            throw \"Invalid JSON @ Track\";\n        }\n        return new Track(station, o.id, o.name, o.relY);\n    }\n\n    toJSON(): unknown {\n        return {\n            id: this.id,\n            name: this.name,\n        };\n    }\n}","import Track from \"./Track\";\n\nexport default class Station {\n    constructor(\n        public readonly id: number, \n        public name: string,\n        public mileage: number,\n        public expanded = false,\n        public topRelY = 0,\n        public bottomRelY = 0\n    ) {}\n    readonly tracks: Track[] = [];\n\n    addNewTrack(track: Track, index: number = this.tracks.length): Track {\n        this.tracks.splice(index, 0, track);\n        return this.tracks[index];\n    }\n\n    removeTrack(t: Track): void {\n        const index = this.tracks.indexOf(t);\n        if (index >= 0) this.tracks.splice(index, 1);\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any): Station {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && o.id != null && o.name != null && o.mileage != null && Array.isArray(o.tracks))) {\n            throw \"Invalid JSON @ Station\"\n        }\n        const station = new Station(o.id, o.name, o.mileage, o.expanded);\n        (o.tracks as any[]).map((t: any) => Track.fromJSON(t, station))\n            .forEach(t => station.tracks.push(t));\n        return station;\n    }\n\n    toJSON(): unknown {\n        return {\n            id: this.id,\n            name: this.name,\n            mileage: this.mileage,\n            tracks: this.tracks,\n            expanded: this.expanded,\n        };\n    }\n}\n","import Station from \"./Station\";\nimport Track from \"./Track\";\nimport Train from \"./Train\";\n\nexport default class StopEvent {\n    constructor(\n        public readonly train: Train,\n        public track: Track,\n        public time: number\n    ) {}\n    privateId: number = ++StopEvent.maxPrivateId;\n    static maxPrivateId = 0;\n\n    get station(): Station {\n        return this.track.station;\n    }\n    get next(): StopEvent | undefined {\n        const index = this.train.stevs.indexOf(this);\n        return index >= 0 ? this.train.stevs[index + 1] : undefined;\n    }\n    get prev(): StopEvent | undefined {\n        const index = this.train.stevs.indexOf(this);\n        return index >= 0 ? this.train.stevs[index - 1] : undefined;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSONStop(o: any, train: Train, stations: { [id: number]: Station }): StopEvent[] {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && o.stationId != null && o.trackId != null && o.arrTime != null && o.depTime != null)) {\n            throw \"Invalid JSON @ Stop\";\n        }\n        const station = stations[o.stationId];\n        const track = station && station.tracks.find(t => t.id == o.trackId);\n        if (!(station && track)) {\n            throw \"Invalid data @ Stop\";\n        }\n        return o.arrTime == o.depTime ?\n            [ new StopEvent(train, track, o.arrTime) ] :\n            [ new StopEvent(train, track, o.arrTime), new StopEvent(train, track, o.depTime) ];\n    }\n}\n\nexport interface StopEventRange {\n    from: StopEvent;\n    to: StopEvent;\n}\n","import Station from \"./Station\";\nimport StopEvent, { StopEventRange } from \"./StopEvent\";\n\nexport default class Train {\n    constructor(\n        public readonly id: number, \n        public name: string,\n    ) {}\n    stevs: StopEvent[] = [];\n\n    addNewStopEvent(stev: StopEvent, index: number = this.stevs.length): StopEvent {\n        this.stevs.splice(index, 0, stev);\n        return this.stevs[index];\n    }\n\n    removeStopEvent(stev: StopEvent): void {\n        const index = this.stevs.indexOf(stev);\n        if (index >= 0) this.stevs.splice(index, 1);\n    }\n\n    getStopEventsInRange(stevRange: StopEventRange): StopEvent[] {\n        const result = [];\n        let inRange = false;\n        for (const stev of this.stevs) {\n            if (stev == stevRange.from) inRange = true;\n            if (inRange) result.push(stev);\n            if (stev == stevRange.to) inRange = false;\n        }\n        return result;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any, stations: { [id: number]: Station }): Train {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && o.id != null && o.name != null && Array.isArray(o.stops))) {\n            throw \"Invalid JSON @ Train\";\n        }\n        const train = new Train(o.id, o.name);\n        (o.stops as any[]).flatMap((s: any) => StopEvent.fromJSONStop(s, train, stations))\n            .forEach(stev => train.stevs.push(stev));\n        return train;\n    }\n\n    toJSON(): unknown {\n        const stops: { stationId: number, trackId: number, arrTime: number, depTime: number }[] = [];\n        for (const stev of this.stevs) {\n            const lastStop = stops[stops.length - 1];\n            if (lastStop && lastStop.trackId == stev.track.id && lastStop.arrTime == lastStop.depTime) {\n                lastStop.depTime = stev.time;\n            } else {\n                stops.push({ \n                    stationId: stev.station.id, \n                    trackId: stev.track.id, \n                    arrTime: stev.time, \n                    depTime: stev.time \n                });\n            }\n        }\n        return {\n            id: this.id,\n            name: this.name,\n            stops: stops\n        };\n    }\n}\n","import Vue from \"vue\";\nimport DiagramConfig from \"./DiagramConfig\";\nimport Station from \"./Station\";\nimport Train from \"./Train\";\n\nexport default class Diagram {\n    constructor(\n        public config: DiagramConfig,\n        public stations: { [id: number]: Station },\n        public trains: { [id: number]: Train },\n    ) {}\n    maxId = 0;\n    maxRelY = 0;\n    \n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n    static fromJSON(o: any): Diagram {\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        if (!(o && typeof o == \"object\" && typeof o.stations == \"object\" && typeof o.trains == \"object\")) {\n            throw \"Invalid JSON\";\n        }\n        const config = DiagramConfig.fromJSON(o.config || {});\n        const stations: { [id: number]: Station } = Object.fromEntries(Object.values(o.stations).map((s: any) => [ s.id, Station.fromJSON(s) ]));\n        const trains: { [id: number]: Train } = Object.fromEntries(Object.values(o.trains).map((t: any) => [ t.id, Train.fromJSON(t, stations) ]));\n        const diagram = new Diagram(config, stations, trains);\n\n        let maxId = o.maxId ? Math.max(o.maxId, 0) : 0;\n        for (const s of Object.values(stations)) {\n            maxId = Math.max(s.id, maxId);\n            for (const t of s.tracks) {\n                maxId = Math.max(t.id, maxId);\n            }\n        }\n        for (const t of Object.values(trains)) {\n            maxId = Math.max(t.id, maxId);\n        }\n        diagram.maxId = maxId;\n\n        diagram.updateY();\n\n        return diagram;\n    }\n\n    getYByRelY(relY: number): number {\n        return relY + this.config.topPaneHeight - this.config.scrollY;\n    }\n    getRelYByY(y: number): number {\n        return y - this.config.topPaneHeight + this.config.scrollY;\n    }\n    getXByTime(time: number): number {\n        return time * this.config.xScale + this.config.leftPaneWidth - this.config.scrollX;\n    }\n    getTimeByX(x: number): number {\n        return (x - this.config.leftPaneWidth + this.config.scrollX) / this.config.xScale;\n    }\n\n    getStationsInMileageOrder(): Station[] {\n        return Object.values(this.stations).sort((a, b) => a.mileage - b.mileage);\n    }\n\n    genId(): number {\n        return ++this.maxId;\n    }\n    releaseId(id: number): void {\n        if (id == this.maxId) --this.maxId;\n    }\n\n    addNewStation(station: Station): Station {\n        return Vue.set(this.stations, station.id, station);\n    }\n    removeStation(station: Station): void {\n        Vue.delete(this.stations, station.id);\n    }\n    addNewTrain(train: Train): Train {\n        return Vue.set(this.trains, train.id, train);\n    }\n    removeTrain(train: Train): void {\n        Vue.delete(this.trains, train.id);\n    }\n\n    updateY(): void {\n        if (Object.keys(this.stations).length == 0) {\n            this.maxRelY = 0;\n            return;\n        }\n\n        const stations = this.getStationsInMileageOrder();\n    \n        const initialMileage = stations[0].mileage;\n        for (const s of stations) {\n          s.mileage = s.mileage - initialMileage;\n        }\n    \n        let y = this.config.plotPaneVerticalPadding;\n        let lastMileage = 0;\n        for (const s of stations) {\n          y += (s.mileage - lastMileage) * this.config.yScale;\n          s.topRelY = y;\n          if (s.expanded) {\n            s.tracks.forEach((t, i) => {\n              t.relY = y + (i + 1) * this.config.trackLineSpan;\n            });\n            s.bottomRelY = y + (s.tracks.length + 1) * this.config.trackLineSpan;\n            y += (s.tracks.length + 1) * this.config.trackLineSpan;\n          } else {\n            Object.values(s.tracks).forEach(t => t.relY = y);\n            s.bottomRelY = y;\n          }\n          lastMileage = s.mileage;\n        }\n    \n        this.maxRelY = stations[stations.length - 1].bottomRelY + this.config.plotPaneVerticalPadding;\n      }\n    \n    toJSON(): unknown {\n        return {\n            config: this.config,\n            stations: this.stations,\n            trains: this.trains,\n        };\n    }\n}","export default class ViewConfig {\n    minHitWidth = 3;\n    pointerWidth = 3;\n    pointerColor = \"rgb(0, 0, 0)\";\n    pointerLabelFontSize = 12;\n    pointerPrecisePixelPerTimeUnit = 5;\n    selectedTrackLabelColor = \"rgb(255, 0, 0)\";\n    selectedTrackLineColor = \"rgb(255, 0, 0)\";\n    selectedTrainPathColor = \"rgb(255, 0, 0)\";\n    selectedTrainPathWidthScale = 1.5;\n    selectedTrainPathMarkerWidth = 5;\n    selectedTrainPathMarkerColor = \"rgb(255, 0, 0)\";\n    unselectedTrainPathOpacity = 0.5;\n    markerLabelMaxDistance = 20;\n    markerLabelColor = \"rgb(255, 0, 0)\";\n    markerLabelFontSize = 12;\n    markerLabelLineHeight = 16;\n    wheelScale = 1;\n    editMode = true;\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"diagram-view\"},[_c('stage',{staticClass:\"diagram-view-stage\",on:{\"updateY\":_vm.updateY,\"stationNameInputStart\":_vm.onStationNameInputStart,\"trackNameInputStart\":_vm.onTrackNameInputStart}}),_c('div',{staticClass:\"diagram-view-ui\"},[_c('station-name-input',{ref:\"stationNameInput\"}),_c('track-name-input',{ref:\"trackNameInput\"}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-expand-button',{key:(\"station-expand-button-\" + (s.id)),attrs:{\"station\":s},on:{\"updateY\":_vm.updateY,\"trackNameInputStart\":_vm.onTrackNameInputStart}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-remove-button',{key:(\"station-remove-button-\" + (s.id)),attrs:{\"station\":s},on:{\"updateY\":_vm.updateY}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-add-track-button',{key:(\"station-add-track-button-\" + (s.id)),attrs:{\"station\":s},on:{\"updateY\":_vm.updateY,\"trackNameInputStart\":_vm.onTrackNameInputStart}})}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _vm._l((s.tracks),function(t){return _c('station-remove-track-button',{key:(\"station-remove-track-button-\" + (s.id) + \"-\" + (t.id)),attrs:{\"station\":s,\"track\":t},on:{\"updateY\":_vm.updateY}})})})],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Station from \"./Station\";\nimport StopEvent, { StopEventRange } from \"./StopEvent\";\nimport Track from \"./Track\";\nimport Train from \"./Train\";\n\nexport interface TrainSelectionState {\n    train: Train;\n    stevRange: StopEventRange | null;\n}\n\nexport default class ViewState {\n    viewWidth = 0;\n    viewHeight = 0;\n    trainSelections: { [trainId: number]: TrainSelectionState } = {};\n    pointerScreenX = 0;\n    pointerTime = 0;\n    pointerY = 0;\n    pointerTargetTrainPath: { train: Train, stevRange: StopEventRange } | null = null;\n    pointerTargetLine: { station: Station, track: Track | null, relY: number } | null = null;\n    pointerPreciseState: { sx0: number, t0: number } | null = null;\n    drawingState: {\n        train: Train,\n        lastStev: StopEvent,\n        direction: number,\n        stableEnd: StopEvent | null,\n        floating: StopEvent | null\n    } | null = null;\n    trainPathDragState: { \n        dragging: boolean,\n        targets: { [trainId: number]: TrainSelectionState },\n        timeShift: number \n    } | null = null;\n    stationNameInputTarget: Station | null = null;\n    trackNameInputTarget: Track | null = null;\n    controlKeyPressed = false;\n\n    get busy(): boolean {\n        return this.drawingState != null || \n            this.trainPathDragState != null ||\n            this.inputEnabled;\n    }\n\n    get inputEnabled(): boolean {\n        return this.stationNameInputTarget != null || this.trackNameInputTarget != null;\n    }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"hammer\",rawName:\"v-hammer:pan\",value:(_vm.onPan),expression:\"onPan\",arg:\"pan\"},{name:\"hammer\",rawName:\"v-hammer:pinch\",value:(_vm.onPinch),expression:\"onPinch\",arg:\"pinch\"}]},[(_vm.diagram)?_c('v-stage',{attrs:{\"config\":_vm.stageConfig},on:{\"mousedown\":_vm.onStageMouseDown,\"mousemove\":_vm.onStageMouseMove,\"click\":_vm.onStageClick,\"dblclick\":_vm.onStageDoubleClick,\"wheel\":_vm.onStageMouseWheel,\"contextmenu\":_vm.onContextMenu}},[_c('back-layer',_vm._g({},_vm.$listeners)),_c('train-path-layer'),_c('v-layer',[_c('pointer')],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-layer',{attrs:{\"id\":\"back-layer\"}},[_vm._l((_vm.timeGridLines),function(t){return _c('v-group',{key:t.key},[_c('v-line',{attrs:{\"config\":t.lineConfig}}),(t.labelConfig)?_c('v-text',{attrs:{\"config\":t.labelConfig}}):_vm._e()],1)}),_vm._l((Object.values(_vm.diagram.stations)),function(s){return _c('station-group',_vm._g({key:(\"station-\" + (s.id)),attrs:{\"station\":s}},_vm.$listeners))})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[(_vm.isTopLineIntersectingPlotPane)?_c('v-group',[_c('v-line',{attrs:{\"config\":_vm.topLineConfig}}),_vm._l((_vm.labelCharacters),function(c){return _c('v-text',{key:c.key,attrs:{\"config\":c}})}),_c('v-rect',{attrs:{\"config\":_vm.labelRectConfig},on:{\"click\":_vm.onStationLabelClick,\"mousedown\":_vm.onStationLabelMouseDown}})],2):_vm._e(),(_vm.station.expanded && _vm.isBottomLineIntersectingPlotPane)?_c('v-line',{attrs:{\"config\":_vm.bottomLineConfig}}):_vm._e(),(_vm.station.expanded)?_vm._l((_vm.station.tracks),function(t){return _c('track-group',_vm._g({key:(\"track-\" + (_vm.station.id) + \"-\" + (t.id)),attrs:{\"station\":_vm.station,\"track\":t}},_vm.$listeners))}):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isLineIntersectingPlotPane)?_c('v-group',[_c('v-line',{attrs:{\"config\":_vm.lineConfig}}),_c('v-text',{attrs:{\"config\":_vm.labelConfig},on:{\"click\":_vm.onLabelClick,\"mousedown\":_vm.onLabelMouseDown}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport Station from \"@/data/Station\";\nimport Track from \"@/data/Track\";\nimport { KonvaEventObject } from \"konva/types/Node\";\n\n@Component\nexport default class TrackGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n  @Prop() track!: Track;\n\n  dragState: { sy0: number, index0: number, dragging: boolean } | null = null;\n\n  get lineConfig(): unknown {\n    return {\n      points: [\n        this.diagram.config.stationLabelLeftMargin + this.diagram.config.trackLabelLeftMargin, \n        this.diagram.getYByRelY(this.track.relY), \n        this.viewState.viewWidth, \n        this.diagram.getYByRelY(this.track.relY)\n      ],\n      stroke: this.diagram.config.trackLineColor,\n      strokeWidth: this.diagram.config.trackLineWidth,\n      listening: false,\n    }\n  }\n\n  get labelConfig(): unknown {\n    return {\n      id: `track-label-${this.station.id}-${this.track.id}`,\n      x: this.diagram.config.stationLabelLeftMargin + this.diagram.config.trackLabelLeftMargin,\n      y: this.diagram.getYByRelY(this.track.relY) - this.diagram.config.trackLabelFontSize,\n      width: this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.trackLabelLeftMargin - this.diagram.config.stationLabelRightMargin,\n      height: this.diagram.config.trackLabelFontSize,\n      text: this.track.name,\n      fontSize: this.diagram.config.trackLabelFontSize,\n      fontFamily: this.diagram.config.fontFamily,\n      fill: this.diagram.config.trackLabelColor,\n      align: \"left\",\n      verticalAlign: \"bottom\",\n    }\n  }\n\n  get isLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.track.relY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.track.relY) < this.viewState.viewHeight;\n  }\n\n  onLabelClick(): void {\n    if (this.viewConfig.editMode && !this.viewState.busy) {\n      this.viewState.trackNameInputTarget = this.track;\n      this.$emit(\"trackNameInputStart\");\n    }\n  }\n\n  onLabelMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewConfig.editMode) {\n      this.dragState = { \n        sy0: konvaEvent.evt.screenY, \n        index0: this.station.tracks.indexOf(this.track), \n        dragging: false \n      };\n      window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    }\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState) {\n      if (Math.abs(event.screenY - this.dragState.sy0) > 1) {\n        this.dragState.dragging = true;\n      }\n      if (this.dragState.dragging) {\n        const currentIndex = this.station.tracks.findIndex(t => t.id == this.track.id);\n        this.station.tracks.splice(currentIndex, 1);\n\n        const mouseRelY = this.diagram.getRelYByY(event.clientY);\n        const newIndex = this.station.tracks.findIndex(t => mouseRelY < t.relY);\n        if (newIndex < 0) {\n          this.station.tracks.push(this.track);\n        } else {\n          this.station.tracks.splice(newIndex, 0, this.track);\n        }\n        this.$emit(\"updateY\");\n      }\n    }\n  }\n\n  onWindowMouseUp(event: MouseEvent): void {\n    if (this.dragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      this.onWindowMouseMove(event);\n\n      const index0 = this.dragState.index0;\n      const index1 = this.station.tracks.indexOf(this.track);\n      if (index0 != index1) {\n        this.historyManager.push({\n          undo: () => { \n            this.station.removeTrack(this.track); \n            this.station.addNewTrack(this.track, index0); \n          },\n          redo: () => {\n            this.station.removeTrack(this.track); \n            this.station.addNewTrack(this.track, index1); \n          }\n        });\n      }\n\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrackGroup.vue?vue&type=template&id=04365208&scoped=true&\"\nimport script from \"./TrackGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrackGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"04365208\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport TrackGroup from \"./TrackGroup.vue\";\nimport { KonvaEventObject } from \"konva/types/Node\";\n\n@Component({\n  components: {\n    TrackGroup\n  },\n})\nexport default class StationGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n\n  dragState: { sy0: number, mileage0: number, dragging: boolean } | null = null;\n\n  get topLineConfig(): unknown {\n    return {\n      points: [\n        0, \n        this.diagram.getYByRelY(this.station.topRelY), \n        this.viewState.viewWidth, \n        this.diagram.getYByRelY(this.station.topRelY)\n      ],\n      stroke: this.diagram.config.stationLineColor,\n      strokeWidth: this.diagram.config.stationLineWidth,\n      listening: false,\n    }\n  }\n\n  get bottomLineConfig(): unknown {\n    return {\n      points: [\n        0, \n        this.diagram.getYByRelY(this.station.bottomRelY), \n        this.viewState.viewWidth, \n        this.diagram.getYByRelY(this.station.bottomRelY)\n      ],\n      stroke: this.diagram.config.stationLineColor,\n      strokeWidth: this.diagram.config.stationLineWidth,\n      listening: false,\n    }\n  }\n\n  get labelRectConfig(): unknown {\n    return {\n      id: `station-label-${this.station.id}`,\n      x: this.diagram.config.stationLabelLeftMargin,\n      y: this.diagram.getYByRelY(this.station.topRelY) - this.diagram.config.stationLabelFontSize,\n      width: this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.stationLabelRightMargin,\n      height: this.diagram.config.stationLabelFontSize,\n    };\n  }\n\n  get labelCharacters(): unknown {\n    const widthForChars = this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.stationLabelRightMargin - this.diagram.config.stationLabelFontSize;\n    const charSpan = this.station.name.length > 1 ? widthForChars / (this.station.name.length - 1) : 0;\n    return Array.from(this.station.name).map((c, index) => {\n      return {\n        key: `station-label-${this.station.id}-${index}`,\n        x: this.station.name.length > 1 ? \n            this.diagram.config.stationLabelLeftMargin + index * charSpan :\n            this.diagram.config.stationLabelLeftMargin + widthForChars * 0.5,\n        y: this.diagram.getYByRelY(this.station.topRelY) - this.diagram.config.stationLabelFontSize,\n        height: this.diagram.config.stationLabelFontSize,\n        text: c,\n        fontSize: this.diagram.config.stationLabelFontSize,\n        fontFamily: this.diagram.config.fontFamily,\n        fill: this.diagram.config.stationLabelColor,\n        align: \"left\",\n        verticalAlign: \"bottom\",\n      }\n    });\n  }\n\n  get isTopLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.topRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.topRelY) < this.viewState.viewHeight;\n  }\n\n  get isBottomLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.bottomRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  onStationLabelClick(): void {\n    if (this.viewConfig.editMode && !this.viewState.busy) {\n      this.viewState.stationNameInputTarget = this.station;\n      this.$emit(\"stationNameInputStart\");\n    }\n  }\n\n  onStationLabelMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewConfig.editMode && !this.viewState.inputEnabled) {\n      this.dragState = {\n        sy0: konvaEvent.evt.screenY,\n        mileage0: this.station.mileage,\n        dragging: false,\n      };\n      window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    }\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState) {\n      if (Math.abs(event.screenY - this.dragState.sy0) > 1) {\n        this.dragState.dragging = true;\n      }\n      if (this.dragState.dragging) {\n        this.station.mileage = this.dragState.mileage0 + (event.screenY - this.dragState.sy0) / this.diagram.config.yScale;\n        this.$emit(\"updateY\");\n      }\n    }\n  }\n\n  onWindowMouseUp(event: MouseEvent): void {\n    if (this.dragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      this.onWindowMouseMove(event);\n\n      if (this.dragState.dragging) {\n        const mileage0 = this.dragState.mileage0;\n        const mileage1 = this.station.mileage;\n        this.historyManager.push({\n          undo: () => { this.station.mileage = mileage0; },\n          redo: () => { this.station.mileage = mileage1; }\n        });\n      }\n\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationGroup.vue?vue&type=template&id=73c79956&scoped=true&\"\nimport script from \"./StationGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"73c79956\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewState from \"@/data/ViewState\";\nimport StationGroup from \"./StationGroup.vue\";\n\n@Component({\n  components: {\n    StationGroup\n  },\n})\nexport default class BackLayer extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  get timeGridLines(): unknown {\n    const lines = [];\n    const scrollLeftTime = this.diagram.config.scrollX / this.diagram.config.xScale;\n    let t = Math.ceil(scrollLeftTime / this.diagram.config.minorMinutelyGridLineSpan) * this.diagram.config.minorMinutelyGridLineSpan;\n    let x = t * this.diagram.config.xScale - this.diagram.config.scrollX + this.diagram.config.leftPaneWidth;\n    while (x < this.viewState.viewWidth) {\n      lines.push({\n        key: `time-grid-line-${lines.length}`,\n        lineConfig: {\n          points: [\n            x,\n            this.diagram.config.topPaneHeight,\n            x,\n            this.viewState.viewHeight\n          ],\n          stroke:\n            t % 3600 == 0 ? this.diagram.config.hourlyGridLineColor :\n            t % this.diagram.config.majorMinutelyGridLineSpan == 0 ? this.diagram.config.majorMinutelyGridLineColor :\n            this.diagram.config.minorMinutelyGridLineColor,\n          strokeWidth: \n            t % 3600 == 0 ? this.diagram.config.hourlyGridLineWidth :\n            t % this.diagram.config.majorMinutelyGridLineSpan == 0 ? this.diagram.config.majorMinutelyGridLineWidth :\n            this.diagram.config.minorMinutelyGridLineWidth,\n          listening: false,\n        },\n        labelConfig: t % 3600 != 0 ? null : {\n          x: x - this.diagram.config.hourlyLabelFontSize,\n          y: this.diagram.config.topPaneHeight - this.diagram.config.hourlyLabelBottomMargin - this.diagram.config.hourlyLabelFontSize,\n          width: this.diagram.config.hourlyLabelFontSize * 2,\n          height: this.diagram.config.hourlyLabelFontSize,\n          text: `${ t / 3600 % 24 }`,\n          fontSize: this.diagram.config.hourlyLabelFontSize,\n          fontFamily: this.diagram.config.fontFamily,\n          fill: this.diagram.config.hourlyLabelColor,\n          align: \"center\",\n          verticalAlign: \"bottom\",\n        }\n      });\n      t += this.diagram.config.minorMinutelyGridLineSpan;\n      x = t * this.diagram.config.xScale - this.diagram.config.scrollX + this.diagram.config.leftPaneWidth;\n    }\n    return lines;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BackLayer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BackLayer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./BackLayer.vue?vue&type=template&id=654ee79b&scoped=true&\"\nimport script from \"./BackLayer.vue?vue&type=script&lang=ts&\"\nexport * from \"./BackLayer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"654ee79b\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.pointerEnabled)?_c('v-group',[_c('v-rect',{attrs:{\"config\":_vm.rectConfig}}),_c('v-text',{attrs:{\"config\":_vm.labelConfig}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export function getTimeText(time: number, forceSec?: boolean): string {\n    const hStr = `${Math.floor(time / 3600)}`;\n    const mmStr = `${Math.floor(time / 60) % 60}`.padStart(2, \"0\");\n    const ssStr = `${time % 60}`.padStart(2, \"0\");\n    return time % 60 != 0 || forceSec ? `${hStr}:${mmStr}:${ssStr}` : `${hStr}:${mmStr}`;\n}\n","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport { getTimeText } from \"@/utils\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class TrainPathGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  get pointerEnabled(): unknown {\n    return this.viewState.pointerTargetLine && !this.viewState.pointerTargetTrainPath &&\n      !this.viewState.trainPathDragState && !this.viewState.drawingState;\n  }\n\n  get rectConfig(): unknown {\n    const width = this.viewState.drawingState ? this.viewConfig.selectedTrainPathMarkerWidth : this.viewConfig.pointerWidth;\n    return {\n      x: this.diagram.getXByTime(this.viewState.pointerTime) - width * 0.5,\n      y: this.viewState.pointerY - width * 0.5,\n      width: width,\n      height: width,\n      fill: this.viewConfig.pointerColor,\n      listening: false,\n    };\n  }\n\n  get labelConfig(): unknown {\n    const time = this.viewState.pointerTime >= 0 ? \n      this.viewState.pointerTime : \n      this.viewState.pointerTime + Math.ceil(-this.viewState.pointerTime / 3600) * 3600;\n    return {\n      x: this.diagram.getXByTime(this.viewState.pointerTime),\n      y: this.viewState.pointerY - this.viewConfig.pointerLabelFontSize,\n      height: this.viewConfig.pointerLabelFontSize,\n      text: getTimeText(time, this.viewState.pointerPreciseState != null),\n      fontSize: this.viewConfig.pointerLabelFontSize,\n      fontFamily: this.diagram.config.fontFamily,\n      fill: this.viewConfig.pointerColor,\n      align: \"left\",\n      verticalAlign: \"bottom\",\n      listening: false,\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pointer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Pointer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Pointer.vue?vue&type=template&id=3766b4d0&scoped=true&\"\nimport script from \"./Pointer.vue?vue&type=script&lang=ts&\"\nexport * from \"./Pointer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3766b4d0\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-layer',{ref:\"trainPathLayer\",attrs:{\"id\":\"train-path-layer\",\"config\":_vm.layerConfig}},[_vm._l((Object.values(_vm.diagram.trains).filter(function (t) { return !_vm.viewState.trainSelections[t.id]; })),function(t){return _c('train-path-group',{key:(\"train-\" + (t.id)),attrs:{\"train\":t}})}),_vm._l((Object.values(_vm.diagram.trains).filter(function (t) { return _vm.viewState.trainSelections[t.id]; })),function(t){return _c('train-path-group',{key:(\"train-\" + (t.id)),attrs:{\"train\":t}})})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[_c('v-line',{attrs:{\"config\":_vm.regularTrainPathConfig},on:{\"click\":_vm.onTrainPathClick,\"mousemove\":_vm.onTrainPathMouseMove}}),(_vm.selectedTrainPathEnabled)?[_c('v-line',{attrs:{\"config\":_vm.selectedTrainPathConfig},on:{\"click\":_vm.onSelectedTrainPathClick,\"dblclick\":_vm.onSelectedTrainPathDoubleClick,\"mousedown\":_vm.onSelectedTrainPathMouseDown,\"mousemove\":_vm.onSelectedTrainPathMouseMove}}),_vm._l((_vm.selectedTrainPathNodes),function(n){return _c('train-path-marker',{key:(\"marker-\" + (_vm.train.id) + \"-\" + (n.stev.privateId) + \"-\" + (n.phase)),attrs:{\"trainPathNode\":n},on:{\"click\":_vm.onMarkerClick,\"mousedown\":_vm.onMarkerMouseDown}})})]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-group',[_c('v-rect',{attrs:{\"config\":_vm.rectConfig},on:{\"click\":function($event){return _vm.$emit('click', $event, _vm.trainPathNode)},\"mousemove\":_vm.onRectMouseMove,\"mousedown\":function($event){return _vm.$emit('mousedown', $event, _vm.trainPathNode)},\"dblclick\":_vm.onRectDoubleClick}}),(_vm.labelEnabled)?_c('v-text',{attrs:{\"config\":_vm.labelConfig}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport { getTimeText } from \"@/utils\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport TrainPathNode from \"@/data/TrainPathNode\";\n\n@Component\nexport default class TrainPathMarker extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() trainPathNode!: TrainPathNode;\n\n  get rectConfig(): unknown {\n    return {\n      x: this.diagram.getXByTime(this.trainPathNode.time) - this.viewConfig.selectedTrainPathMarkerWidth * 0.5,\n      y: this.diagram.getYByRelY(this.trainPathNode.relY) - this.viewConfig.selectedTrainPathMarkerWidth * 0.5,\n      width: this.viewConfig.selectedTrainPathMarkerWidth,\n      height: this.viewConfig.selectedTrainPathMarkerWidth,\n      fill: this.viewConfig.selectedTrainPathMarkerColor,\n    };\n  }\n\n  get labelEnabled(): boolean {\n    return this.trainPathNode.phase == \"track\";\n  }\n\n  get labelConfig(): unknown {\n    const labelPosition = this.getLabelPosition();\n    return {\n      x: this.diagram.getXByTime(this.trainPathNode.time) + labelPosition.x - this.viewConfig.markerLabelFontSize * 8,\n      y: this.diagram.getYByRelY(this.trainPathNode.relY) + labelPosition.y - this.viewConfig.markerLabelLineHeight,\n      width: this.viewConfig.markerLabelFontSize * 8,\n      height: this.viewConfig.markerLabelLineHeight,\n      text: getTimeText(this.trainPathNode.time, this.viewState.pointerPreciseState != null),\n      fontSize: this.viewConfig.pointerLabelFontSize,\n      fontFamily: this.diagram.config.fontFamily,\n      fill: this.viewConfig.markerLabelColor,\n      align: \"right\",\n      verticalAlign: \"bottom\",\n      listening: false,\n    }\n  }\n\n  getLabelPosition(): { x: number, y: number } {\n    const thisStev = this.trainPathNode.stev;\n    const prevStev = thisStev.prev;\n    const nextStev = thisStev.next;\n    if (prevStev && prevStev.track != thisStev.track && (!nextStev || nextStev.track == thisStev.track)) {\n      const thisRelY = prevStev.station.mileage < thisStev.station.mileage ? thisStev.station.topRelY : thisStev.station.bottomRelY;\n      const prevRelY = prevStev.station.mileage < thisStev.station.mileage ? prevStev.station.bottomRelY : prevStev.station.topRelY;\n      const x = thisRelY == prevRelY ? 0:\n        -this.viewConfig.markerLabelLineHeight *\n        ((thisStev.time - prevStev.time) * this.diagram.config.xScale) /\n        Math.abs(thisRelY - prevRelY);\n      return {\n        x: Math.max(x, -this.viewConfig.markerLabelMaxDistance),\n        y: prevStev.station.mileage < thisStev.station.mileage ? 0 : this.viewConfig.markerLabelLineHeight\n      };\n    }\n\n    return {\n      x: 0,\n      y: nextStev && nextStev.station.mileage < thisStev.station.mileage || prevStev && prevStev.station.mileage > thisStev.station.mileage ? 0 : this.viewConfig.markerLabelLineHeight,\n    };\n  }\n\n  onRectMouseMove(): void {\n    this.viewState.pointerTargetTrainPath = {\n      train: this.trainPathNode.stev.train,\n      stevRange: { from: this.trainPathNode.stev, to: this.trainPathNode.stev }\n    };\n  }\n\n  onRectDoubleClick(): void {\n    if (this.viewConfig.editMode) {\n      if (!this.viewState.drawingState) {\n        const n = this.trainPathNode;\n        if (!n.stev.prev) {\n          this.viewState.drawingState = {\n            train: n.stev.train,\n            lastStev: n.stev,\n            direction: -1,\n            stableEnd: n.stev,\n            floating: null\n          };\n          this.viewState.trainSelections[n.stev.train.id].stevRange = null;\n        } else if (!n.stev.next) {\n          this.viewState.drawingState = {\n            train: n.stev.train,\n            lastStev: n.stev,\n            direction: 1,\n            stableEnd: n.stev,\n            floating: null\n          };\n          this.viewState.trainSelections[n.stev.train.id].stevRange = null;\n        }\n      } else {\n        this.viewState.drawingState = null;\n        this.viewState.trainSelections = {};\n      }\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathMarker.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathMarker.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathMarker.vue?vue&type=template&id=40df1b93&scoped=true&\"\nimport script from \"./TrainPathMarker.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathMarker.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"40df1b93\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport StopEvent, { StopEventRange } from \"@/data/StopEvent\";\nimport Track from \"@/data/Track\";\nimport TrainPathNode from \"@/data/TrainPathNode\";\nimport Train from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport TrainPathMarker from \"./TrainPathMarker.vue\";\n\n@Component({\n  components: {\n    TrainPathMarker\n  },\n})\nexport default class TrainPathGroup extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() train!: Train;\n\n  dragState: { \n    t0: number, \n    y0: number,\n    sx0: number, \n    sy0: number,\n    track0: Track | null,\n    minTimeShift: number,\n    maxTimeShift: number,\n    changeTimeTargets: StopEvent[] | null,\n    changeTrackTargets: StopEvent[] | null,\n  } | null = null;\n\n  get regularTrainPathConfig(): unknown {\n    return {\n      points: this.regularTrainPathNodes.flatMap(n => [this.diagram.getXByTime(n.time), this.diagram.getYByRelY(n.relY)]),\n      stroke: this.diagram.config.trainPathColor,\n      opacity: Object.keys(this.viewState.trainSelections).length > 0 ? this.viewConfig.unselectedTrainPathOpacity : 1,\n      strokeWidth: this.diagram.config.trainPathWidth,\n      hitStrokeWidth: Math.max(this.diagram.config.trainPathWidth, this.viewConfig.minHitWidth * 2),\n    }\n  }\n\n  get regularTrainPathNodes(): TrainPathNode[] {\n    return this.getTrainPathNodes(\"regular\");\n  }\n\n  get selectedTrainPathEnabled(): boolean {\n    return this.viewState.trainSelections[this.train.id] != null;\n  }\n\n  get selectedTrainPathConfig(): unknown {\n    return {\n      points: this.selectedTrainPathNodes.flatMap(n => [this.diagram.getXByTime(n.time), this.diagram.getYByRelY(n.relY)]),\n      stroke: this.viewConfig.selectedTrainPathColor,\n      strokeWidth: this.diagram.config.trainPathWidth * this.viewConfig.selectedTrainPathWidthScale,\n      hitStrokeWidth: Math.max(this.diagram.config.trainPathWidth * this.viewConfig.selectedTrainPathWidthScale, this.viewConfig.minHitWidth * 2)\n    };\n  }\n\n  get selectedTrainPathNodes(): TrainPathNode[] {\n    return this.getTrainPathNodes(\"selected\");\n  }\n\n  getTrainPathNodes(mode: \"regular\" | \"selected\"): TrainPathNode[] {\n    const sel = this.viewState.trainSelections[this.train.id];\n    const stevs = mode == \"selected\" && sel.stevRange != null ? \n      this.train.getStopEventsInRange(sel.stevRange) : this.train.stevs;\n\n    const shiftEnabled = this.viewState.trainPathDragState?.targets[this.train.id] && (mode == \"selected\" || !this.viewState.controlKeyPressed);\n    const shiftTime = this.viewState.trainPathDragState?.timeShift ?? 0;\n    const shiftRange = this.viewState.trainPathDragState?.targets[this.train.id]?.stevRange;\n    let inShiftRange = shiftEnabled && !shiftRange;\n\n    const result: TrainPathNode[] = [];\n    for (const stev of stevs) {\n      if (shiftEnabled && stev == shiftRange?.from) inShiftRange = true;\n      const time = inShiftRange ? stev.time + shiftTime : stev.time;\n      if (stev.station.expanded && stev.prev && stev.prev.station != stev.station) {\n        result.push({ \n          stev, \n          phase: \"arr\",\n          time, \n          relY: stev.prev.station.mileage < stev.station.mileage ? stev.station.topRelY : stev.station.bottomRelY\n        });\n      }\n      result.push({\n        stev,\n        phase: \"track\",\n        time,\n        relY: stev.track.relY\n      });\n      if (stev.station.expanded && stev.next && stev.next.station != stev.station) {\n        result.push({ \n          stev, \n          phase: \"dep\",\n          time, \n          relY: stev.next.station.mileage < stev.station.mileage ? stev.station.topRelY : stev.station.bottomRelY\n        });\n      }\n      if (shiftEnabled && stev == shiftRange?.to) inShiftRange = false;\n    }\n    return result;\n  }\n\n  onTrainPathMouseMove(): void {\n    this.viewState.pointerTargetTrainPath = null;\n  }\n\n  onSelectedTrainPathMouseMove(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    this.viewState.pointerTargetTrainPath = { \n      train: this.train, \n      stevRange: this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY)\n    };\n  }\n\n  onTrainPathClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const clickedStopRange = this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    this.changeTrainSelections(konvaEvent, clickedStopRange, false);\n  }\n\n  onSelectedTrainPathClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const clickedStopRange = this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    this.changeTrainSelections(konvaEvent, clickedStopRange, true);\n  }\n\n  onMarkerClick(konvaEvent: KonvaEventObject<MouseEvent>, trainPathNode: TrainPathNode): void {\n    const clickedStevRange = { from: trainPathNode.stev, to: trainPathNode.stev };\n    this.changeTrainSelections(konvaEvent, clickedStevRange, true);\n  }\n\n  changeTrainSelections(konvaEvent: KonvaEventObject<MouseEvent>, clickedStevRange: StopEventRange, clickSelected: boolean): void {\n    if (!this.viewState.trainPathDragState?.dragging && !this.viewState.drawingState) {\n      const sel = this.viewState.trainSelections[this.train.id];\n\n      // Remove other trains if ctrl not pressed\n      if (!konvaEvent.evt.ctrlKey) {\n        this.viewState.trainSelections = sel ? { [this.train.id]: sel } : {};\n      }\n\n      if (!sel) {\n        this.$set(this.viewState.trainSelections, this.train.id, { train: this.train, stevRange: null });\n      } else {\n        const selectedStevRange = sel.stevRange;\n        if (!selectedStevRange) {\n          sel.stevRange = clickedStevRange;\n        } else if (!konvaEvent.evt.ctrlKey) {\n          sel.stevRange = clickSelected ? clickedStevRange : null;\n        } else {\n          let selStart = false, selEnd = false, changed = false;\n          for (const stev of this.train.stevs) {\n            if (!selStart && stev == clickedStevRange.from) {\n              selectedStevRange.from = clickedStevRange.from;\n              changed = true;\n            }\n            if (stev == selectedStevRange.from) selStart = true;\n            if (stev == selectedStevRange.to) selEnd = true;\n            if (selEnd && stev == clickedStevRange.to) {\n              selectedStevRange.to = clickedStevRange.to;\n              changed = true;\n            }\n          }\n          if (!changed) {\n            this.$delete(this.viewState.trainSelections, this.train.id);\n          }\n        }\n      }\n    }\n  }\n\n  getPointedStevRange(x: number, y: number): StopEventRange {\n    if (this.train.stevs.length <= 2) {\n      return { from: this.train.stevs[0], to: this.train.stevs[this.train.stevs.length - 1] };\n    }\n\n    // TODO: more precise detection\n    for (let i = 0; i < this.train.stevs.length - 1; ++i) {\n      const thisStev = this.train.stevs[i];\n      const nextStev = this.train.stevs[i + 1];\n      const leftX = this.diagram.getXByTime(thisStev.time) - this.viewConfig.minHitWidth;\n      const rightX = this.diagram.getXByTime(nextStev.time) + this.viewConfig.minHitWidth;\n      const topY = this.diagram.getYByRelY(Math.min(thisStev.track.relY, nextStev.track.relY)) - this.viewConfig.minHitWidth;\n      const bottomY = this.diagram.getYByRelY(Math.max(thisStev.track.relY, nextStev.track.relY)) + this.viewConfig.minHitWidth;\n      if (leftX < x && x < rightX && topY < y && y < bottomY) {\n        return { from: thisStev, to: nextStev };\n      }\n    }\n    return { from: this.train.stevs[0], to: this.train.stevs[this.train.stevs.length - 1] };\n  }\n\n  onSelectedTrainPathDoubleClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (this.viewConfig.editMode && !this.viewState.drawingState) {\n      const targetTime = this.viewState.pointerTime;\n      const nearestStation = this.getNearestStation(konvaEvent.evt.clientY);\n      const nearestStev = this.getNearestStopEvent(targetTime);\n      if (!(nearestStation == nearestStev.station && (nearestStev.prev?.track == nearestStev.track || nearestStev.next?.track == nearestStev.track))) {\n        const index = this.train.stevs.findIndex(s => s.time > targetTime);\n        const newStev = this.train.addNewStopEvent(new StopEvent(this.train, nearestStation.tracks[0], targetTime), index);\n        this.viewState.trainSelections = { \n          [this.train.id]: {\n            train: this.train,\n            stevRange: { from: newStev, to: newStev }\n          } \n        };\n      }\n    }\n  }\n\n  getNearestStation(y: number): Station {\n    const stations = this.diagram.getStationsInMileageOrder();\n    const relY = this.diagram.getRelYByY(y);\n    let minSta = stations[0];\n    let minDist = Math.abs(relY - minSta.bottomRelY);\n    for (const s of stations) {\n      if (Math.abs(relY - s.topRelY) < minDist) {\n        minSta = s;\n        minDist = Math.abs(relY - s.topRelY);\n      }\n      if (Math.abs(relY - s.bottomRelY) < minDist) {\n        minSta = s;\n        minDist = Math.abs(relY - s.bottomRelY);\n      }\n    }\n    return minSta;\n  }\n\n  getNearestStopEvent(time: number): StopEvent {\n    let minStop = this.train.stevs[0];\n    let minDist = Math.abs(time - minStop.time);\n    for (const s of this.train.stevs) {\n      if (Math.abs(time - s.time) < minDist) {\n        minStop = s;\n        minDist = Math.abs(time - s.time);\n      }\n    }\n    return minStop;\n  }\n\n  onSelectedTrainPathMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (!this.viewConfig.editMode) {\n      return;\n    }\n\n    let minTimeShift = -86400;\n    let maxTimeShift = 86400;\n    for (const sel of Object.values(this.viewState.trainSelections)) {\n      const stevRange = sel.stevRange;\n      if (stevRange) {\n        if (stevRange.from.prev) {\n          minTimeShift = Math.max(minTimeShift, stevRange.from.prev.time - stevRange.from.time);\n        }\n        if (stevRange.to.next) {\n          maxTimeShift = Math.min(maxTimeShift, stevRange.to.next.time - stevRange.to.time);\n        }\n      }\n    }\n\n    const clickedStevRange = this.getPointedStevRange(konvaEvent.evt.clientX, konvaEvent.evt.clientY);\n    const changeTrackTargets = \n      clickedStevRange.from == clickedStevRange.to ? [ clickedStevRange.from ] : \n      clickedStevRange.from.track == clickedStevRange.to.track ? [ clickedStevRange.from, clickedStevRange.to ] :\n      null;\n\n    const firstNode = this.selectedTrainPathNodes[0];\n    this.dragState = { \n      t0: firstNode.time, \n      y0: this.diagram.getYByRelY(firstNode.relY),\n      sx0: konvaEvent.evt.screenX, \n      sy0: konvaEvent.evt.screenY,\n      track0: changeTrackTargets ? changeTrackTargets[0].track : null,\n      minTimeShift: minTimeShift,\n      maxTimeShift: maxTimeShift,\n      changeTimeTargets: null,\n      changeTrackTargets: changeTrackTargets ?? null\n    };\n    this.viewState.trainPathDragState = {\n      dragging: false,\n      targets: this.viewState.trainSelections,\n      timeShift: 0\n    };\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n  }\n\n  onMarkerMouseDown(konvaEvent: KonvaEventObject<MouseEvent>, node: TrainPathNode): void {\n    if (!this.viewConfig.editMode) {\n      return;\n    }\n\n    this.dragState = {\n      t0: node.time,\n      y0: this.diagram.getYByRelY(node.relY),\n      track0: node.stev.track,\n      sx0: konvaEvent.evt.screenX,\n      sy0: konvaEvent.evt.screenY,\n      minTimeShift: node.stev.prev ? node.stev.prev.time - node.time : -86400,\n      maxTimeShift: node.stev.next ? node.stev.next.time - node.time : 86400,\n      changeTimeTargets: [ node.stev ],\n      changeTrackTargets: [ node.stev ]\n    };\n    this.viewState.trainPathDragState = {\n      dragging: false,\n      targets: { [node.stev.train.id]: { train: node.stev.train, stevRange: { from: node.stev, to: node.stev } } },\n      timeShift: 0\n    };\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    if (this.dragState && this.viewState.trainPathDragState) {\n      if (!this.viewState.trainPathDragState.dragging && Math.hypot(event.clientX - this.dragState.sx0, event.clientY - this.dragState.sy0) > 1) {\n        this.viewState.trainPathDragState.dragging = true;\n        this.viewState.pointerY = this.dragState.y0;\n      }\n      if (this.viewState.trainPathDragState.dragging) {\n        if (!this.viewState.pointerPreciseState) {\n          this.viewState.pointerTime = this.dragState.t0 + Math.floor((event.screenX - this.dragState.sx0) / this.diagram.config.xScale / 60) * 60;\n        }\n        this.viewState.trainPathDragState.timeShift = \n          !this.viewState.controlKeyPressed ?\n            Math.min(this.dragState.maxTimeShift, Math.max(this.dragState.minTimeShift, this.viewState.pointerTime - this.dragState.t0)) :\n            this.viewState.pointerTime - this.dragState.t0;\n        if (this.dragState.changeTrackTargets) {\n          const mouseRelY = this.diagram.getRelYByY(event.clientY);\n          const targetStation = this.dragState.changeTrackTargets[0].station;\n          const mouseTrack = targetStation.tracks.find(t => Math.abs(t.relY - mouseRelY) < this.viewConfig.minHitWidth);\n          if (mouseTrack) {\n            for (const stev of this.dragState.changeTrackTargets) {\n              stev.track = mouseTrack;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  onWindowMouseUp(): void {\n    if (this.dragState && this.viewState.trainPathDragState) {\n      window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n      window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n      if (this.viewState.trainPathDragState.dragging) {\n        if (this.dragState.changeTrackTargets && this.dragState.track0) {\n          const targets = this.dragState.changeTrackTargets;\n          const track0 = this.dragState.track0;\n          const track1 = this.dragState.changeTrackTargets[0].track;\n          if (track0 != track1) {\n            this.historyManager.push({\n              undo: () => { targets.forEach(stev => stev.track = track0); },\n              redo: () => { targets.forEach(stev => stev.track = track1); }\n            });\n          }\n        }\n\n        const timeShift = this.viewState.trainPathDragState.timeShift;\n        if (timeShift != 0) {\n          if (!this.viewState.controlKeyPressed) {\n            const targets = \n              this.dragState.changeTimeTargets ??\n              Object.values(this.viewState.trainSelections).flatMap(sel => {\n                return sel.stevRange ? sel.train.getStopEventsInRange(sel.stevRange) : sel.train.stevs;\n              });\n            targets.forEach(stev => stev.time += timeShift);\n            this.historyManager.push({\n              undo: () => { targets.forEach(stev => stev.time -= timeShift); },\n              redo: () => { targets.forEach(stev => stev.time += timeShift); }\n            });\n          } else {\n            const newTrains = Object.values(this.viewState.trainSelections).map(sel => {\n              const srcTrain = sel.train;\n              const srcStevs = sel.stevRange ? srcTrain.getStopEventsInRange(sel.stevRange) : srcTrain.stevs;\n              const newTrain = this.diagram.addNewTrain(new Train(this.diagram.genId(), \"\"));\n              for (const srcStev of srcStevs) {\n                newTrain.addNewStopEvent(new StopEvent(newTrain, srcStev.track, srcStev.time + timeShift));\n              }\n              this.$delete(this.viewState.trainSelections, sel.train.id);\n              this.$set(this.viewState.trainSelections, newTrain.id, { trainId: newTrain.id, stevRange: null });\n              return newTrain;\n            });\n            this.historyManager.push({\n              undo: () => { newTrains.forEach(train => this.diagram.removeTrain(train)); },\n              redo: () => { newTrains.forEach(train => this.diagram.addNewTrain(train)); }\n            });\n          }\n        }\n      }\n      this.viewState.trainPathDragState = null;\n      this.dragState = null;\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathGroup.vue?vue&type=template&id=b89abab4&scoped=true&\"\nimport script from \"./TrainPathGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathGroup.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b89abab4\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\nimport { Component, InjectReactive, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewState from \"@/data/ViewState\";\nimport TrainPathGroup from \"./TrainPathGroup.vue\";\n\n@Component({\n  components: {\n    TrainPathGroup\n  },\n})\nexport default class BackLayer extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n\n  // mounted(): void {\n  //   const hitCanvas = (this.$refs.trainPathLayer as any).getNode().hitCanvas._canvas;\n  //   document.body.appendChild(hitCanvas);\n  // }\n\n  get layerConfig(): unknown {\n    return {\n      clip: {\n        x: this.diagram.config.leftPaneWidth,\n        y: this.diagram.config.topPaneHeight,\n        width: this.viewState.viewWidth - this.diagram.config.leftPaneWidth,\n        height: this.viewState.viewHeight - this.diagram.config.topPaneHeight,\n      }\n    };\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathLayer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrainPathLayer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrainPathLayer.vue?vue&type=template&id=2f6cdf07&scoped=true&\"\nimport script from \"./TrainPathLayer.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrainPathLayer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2f6cdf07\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Inject, InjectReactive, Vue } from \"vue-property-decorator\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport StopEvent from \"@/data/StopEvent\";\nimport Track from \"@/data/Track\";\nimport Train from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport BackLayer from \"./BackLayer.vue\";\nimport Pointer from \"./Pointer.vue\";\nimport TrainPathLayer from \"./TrainPathLayer.vue\";\n\n@Component({\n  components: {\n    BackLayer, Pointer, TrainPathLayer\n  },\n})\nexport default class Stage extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n\n  stageDragState: { scrollX0: number, scrollY0: number, x0: number, y0: number, dragging: boolean } | null = null;\n  pinchState: { scaleX0: number, scaleY0: number } | null = null;\n\n  onTap(): void { \n    console.log('hello');    \n  }\n\n  get stageConfig(): unknown {\n    return {\n      width: this.viewState.viewWidth,\n      height: this.viewState.viewHeight\n    };\n  }\n\n  get stationsInMileageOrder(): Station[] {\n    return this.diagram.getStationsInMileageOrder();\n  }\n\n  mounted(): void {\n    window.addEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.addEventListener(\"mouseup\", this.onWindowMouseUp);\n    document.addEventListener(\"keydown\", this.onKeyDown);\n    document.addEventListener(\"keyup\", this.onKeyUp);\n  }\n\n  unmounted(): void {\n    window.removeEventListener(\"mousemove\", this.onWindowMouseMove);\n    window.removeEventListener(\"mouseup\", this.onWindowMouseUp);\n    document.removeEventListener(\"keydown\", this.onKeyDown);\n    document.removeEventListener(\"keyup\", this.onKeyUp);\n  }\n\n  onStageMouseMove(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const event = konvaEvent.evt;\n\n    // Update pointer state\n    this.viewState.pointerScreenX = event.screenX;\n    if (this.viewState.pointerPreciseState) {\n      const dUnit = Math.round((event.screenX - this.viewState.pointerPreciseState.sx0) / this.viewConfig.pointerPrecisePixelPerTimeUnit);\n      this.viewState.pointerTime = dUnit * this.diagram.config.minimumTimeUnit + this.viewState.pointerPreciseState.t0;\n    } else if (!this.viewState.trainPathDragState?.dragging) {\n      this.viewState.pointerTime = Math.round(this.diagram.getTimeByX(event.clientX) / 60) * 60;\n      if (event.clientX >= this.diagram.config.leftPaneWidth) {\n        const pointerTargetLine = this.findPointerTargetLine(event.clientY);\n        if (pointerTargetLine) {\n          this.viewState.pointerTargetLine = pointerTargetLine ?? null;\n          this.viewState.pointerY = this.diagram.getYByRelY(pointerTargetLine.relY);\n        } else {\n          this.viewState.pointerTargetLine = null;\n        }\n      } else {\n        this.viewState.pointerTargetLine = null;\n      }\n    }\n    if (konvaEvent.target == konvaEvent.currentTarget) {\n      this.viewState.pointerTargetTrainPath = null;\n    }\n\n    // Update drawing floating\n    const drawingState = this.viewState.drawingState;\n    if (drawingState) {\n      if (drawingState.direction > 0) {\n        this.viewState.pointerTime = Math.max(this.viewState.pointerTime, drawingState.lastStev.time);\n      } else if (drawingState.direction < 0) {\n        this.viewState.pointerTime = Math.min(this.viewState.pointerTime, drawingState.lastStev.time);\n      }\n\n      if (drawingState.floating) {\n        drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.floating), 1);\n        drawingState.floating = null;\n      }\n\n      const pointerTargetLine = event.clientX >= this.diagram.config.leftPaneWidth ?\n        this.findPointerTargetLine(event.clientY) : undefined;\n      if (pointerTargetLine) {\n        const targetTrack = pointerTargetLine.track ?? pointerTargetLine.station.tracks[0];\n        const newStev = drawingState.train.addNewStopEvent(\n          new StopEvent(\n            drawingState.train,\n            targetTrack,\n            this.viewState.pointerTime\n          ),\n          drawingState.direction > 0 || (drawingState.direction == 0 && this.viewState.pointerTime >= drawingState.lastStev.time) ? undefined : 0\n        );\n        drawingState.floating = newStev;\n      }\n    }\n  }\n\n  findPointerTargetLine(y: number): { station: Station, track: Track | null, relY: number } | undefined {\n    const stationPointedOnTop = this.stationsInMileageOrder.find(s => \n      Math.abs(this.diagram.getYByRelY(s.topRelY) - y) < Math.max(this.diagram.config.stationLineWidth * 0.5, this.viewConfig.minHitWidth));\n    if (stationPointedOnTop) {\n      return { station: stationPointedOnTop, track: null, relY: stationPointedOnTop.topRelY };\n    }\n\n    const stationPointedOnBottom = this.stationsInMileageOrder.find(s =>\n      Math.abs(this.diagram.getYByRelY(s.bottomRelY) - y) < Math.max(this.diagram.config.stationLineWidth * 0.5, this.viewConfig.minHitWidth));\n    if (stationPointedOnBottom) {\n      return { station: stationPointedOnBottom, track: null, relY: stationPointedOnBottom.bottomRelY };\n    }\n\n    const station = this.stationsInMileageOrder.find(s => \n      this.diagram.getYByRelY(s.topRelY) + this.diagram.config.trackLineSpan - Math.max(this.diagram.config.trackLineWidth * 0.5, this.viewConfig.minHitWidth) < y &&\n      this.diagram.getYByRelY(s.bottomRelY) - this.diagram.config.trackLineSpan + Math.max(this.diagram.config.trackLineWidth * 0.5, this.viewConfig.minHitWidth) > y\n    );\n    if (station) {\n      const pointedTrack = station.tracks.find(t => Math.abs(this.diagram.getYByRelY(t.relY) - y) < Math.max(this.diagram.config.trackLineWidth * 0.5, this.viewConfig.minHitWidth));\n      if (pointedTrack) {\n        return { station, track: pointedTrack, relY: pointedTrack.relY };\n      }\n    }\n  }\n\n  onStageClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    const drawingState = this.viewState.drawingState;\n    if (drawingState) {\n      if (konvaEvent.evt.button == 0 && this.viewState.pointerTargetLine) {\n        if (drawingState.direction == 0) {\n          drawingState.direction = Math.sign(this.viewState.pointerTime - drawingState.lastStev.time);\n        }\n        if (drawingState.floating){\n          const triple = drawingState.floating.track == drawingState.lastStev.track && (\n            drawingState.direction > 0 && drawingState.lastStev.track == drawingState.lastStev.prev?.track ||\n            drawingState.direction < 0 && drawingState.lastStev.track == drawingState.lastStev.next?.track\n          );\n          if (triple) {\n            drawingState.lastStev.time = this.viewState.pointerTime;\n            drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.floating), 1);\n          } else {\n            drawingState.lastStev = drawingState.floating;\n          }\n          drawingState.floating = null;\n        }\n      }\n      if (konvaEvent.evt.button == 2) {\n        if (drawingState.lastStev == drawingState.stableEnd) {\n          if (drawingState.floating) {\n            drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.floating), 1);\n          }\n          this.viewState.drawingState = null;\n        } else {\n          const newLastStev = drawingState.direction > 0 ? drawingState.lastStev.prev : drawingState.lastStev.next;\n          if (newLastStev) {\n            drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.lastStev), 1);\n            drawingState.lastStev = newLastStev;\n          } else {\n            this.$delete(this.diagram.trains, drawingState.train.id);\n            this.viewState.drawingState = null;\n          }\n        }\n      }\n    }\n\n    if (konvaEvent.target == konvaEvent.currentTarget && \n        !konvaEvent.evt.ctrlKey && \n        !this.stageDragState?.dragging && \n        !this.viewState.trainPathDragState?.dragging && \n        !this.viewState.drawingState) {\n      this.viewState.trainSelections = {};\n    }\n  }\n\n  onStageDoubleClick(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget && this.viewState.drawingState) {\n      const drawingState = this.viewState.drawingState;\n      if (drawingState.floating) {\n        drawingState.train.stevs.splice(drawingState.train.stevs.indexOf(drawingState.floating), 1);\n      }\n      if (drawingState.train.stevs.length <= 1) {\n        this.$delete(this.diagram.trains, drawingState.train.id);\n      } else {\n        const stableEnd = drawingState.stableEnd;\n        if (stableEnd) {\n          const stableIndex = drawingState.train.stevs.indexOf(stableEnd);\n          const addedStevs = drawingState.direction > 0 ? \n            drawingState.train.stevs.filter((e, i) => i > stableIndex) : drawingState.train.stevs.filter((e, i) => i < stableIndex);\n          if (drawingState.direction > 0) {\n            this.historyManager.push({\n              undo: () => { drawingState.train.stevs.splice(stableIndex + 1); },\n              redo: () => { addedStevs.forEach(stev => drawingState.train.stevs.push(stev)); }\n            });\n          } else {\n            this.historyManager.push({\n              undo: () => { drawingState.train.stevs.splice(0, stableIndex); },\n              redo: () => { drawingState.train.stevs = addedStevs.concat(drawingState.train.stevs); }\n            });\n          }\n        } else {\n          this.historyManager.push({\n            undo: () => { this.$delete(this.diagram.trains, drawingState.train.id); },\n            redo: () => { this.$set(this.diagram.trains, drawingState.train.id, drawingState.train) }\n          });\n        }\n      }\n      this.viewState.drawingState = null;\n      this.viewState.trainSelections = {};\n    } else if (konvaEvent.target == konvaEvent.currentTarget && this.viewConfig.editMode) {\n      if (konvaEvent.evt.clientX >= this.diagram.config.leftPaneWidth) {\n        const targetLine = this.viewState.pointerTargetLine;\n        if (targetLine && (targetLine.track || !targetLine.station.expanded)) {\n          const track = targetLine.track ?? targetLine.station.tracks[0];\n          const train = this.diagram.addNewTrain(new Train(this.diagram.genId(), \"\"));\n          train.addNewStopEvent(new StopEvent(train, track, this.viewState.pointerTime));\n          this.viewState.trainSelections = { [train.id]: { train: train, stevRange: null } };\n          this.viewState.drawingState = {\n            train: this.diagram.trains[train.id],\n            lastStev: this.diagram.trains[train.id].stevs[0],\n            direction: 0,\n            stableEnd: null,\n            floating: null\n          };\n        }\n      } else {\n        const relY = this.diagram.getRelYByY(konvaEvent.evt.clientY);\n        const prevSta = this.stationsInMileageOrder.reverse().find(s => s.topRelY < relY);\n        const mileage = prevSta ?\n          (relY - prevSta.bottomRelY) / this.diagram.config.yScale + prevSta.mileage :\n          relY / this.diagram.config.yScale;\n        const station = Station.fromJSON({\n          id: this.diagram.genId(),\n          name: \"\",\n          mileage,\n          tracks: [ { id: this.diagram.genId(), name: \"\" } ],\n        });\n        this.$set(this.diagram.stations, station.id, station);\n        this.historyManager.push({\n          undo: () => { this.$delete(this.diagram.stations, station.id) },\n          redo: () => { this.$set(this.diagram.stations, station.id, station) }\n        });\n        this.$emit(\"updateY\");\n\n        this.viewState.stationNameInputTarget = station;\n        this.$emit(\"stationNameInputStart\");\n      }\n    }\n  }\n\n  onStageMouseDown(konvaEvent: KonvaEventObject<MouseEvent>): void {\n    if (konvaEvent.target == konvaEvent.currentTarget) {\n      this.startDrag(konvaEvent.evt.screenX, konvaEvent.evt.screenY);\n    }\n  }\n\n  onWindowMouseMove(event: MouseEvent): void {\n    this.moveDrag(event.screenX, event.screenY);\n  }\n\n  onWindowMouseUp(event: MouseEvent): void {\n    this.endDrag(event.screenX, event.screenY);\n  }\n\n  onPan(event: { center: { x: number, y: number }, isLast: boolean }): void {\n    if (!this.stageDragState) {\n      this.onPanStart(event);\n    } else {\n      this.onPanMove(event);\n    }\n    if (event.isLast) {\n      this.onPanEnd(event);\n    }\n  }\n\n  onPanStart(event: { center: { x: number, y: number } }): void {\n    this.startDrag(event.center.x, event.center.y);\n  }\n\n  onPanMove(event: { center: { x: number, y: number } }): void {\n    this.moveDrag(event.center.x, event.center.y);\n  }\n\n  onPanEnd(event: { center: { x: number, y: number } }): void {\n    this.endDrag(event.center.x, event.center.y);\n  }\n\n  startDrag(x: number, y: number): void {\n    this.stageDragState = {\n      scrollX0: this.diagram.config.scrollX,\n      scrollY0: this.diagram.config.scrollY,\n      x0: x,\n      y0: y,\n      dragging: false,\n    };\n  }\n\n  moveDrag(x: number, y: number): void {\n    if (this.stageDragState) {\n      if (Math.hypot(x - this.stageDragState.x0, y - this.stageDragState.y0) > 1) {\n        this.stageDragState.dragging = true;\n      }\n      if (this.stageDragState.dragging) {\n        this.stageDragState.dragging = true;\n        this.diagram.config.scrollX = this.stageDragState.scrollX0 - (x - this.stageDragState.x0);\n        this.diagram.config.scrollY = \n          Math.max(0, Math.min(this.diagram.maxRelY + this.diagram.config.topPaneHeight - this.viewState.viewHeight, \n            this.stageDragState.scrollY0 - (y - this.stageDragState.y0)));\n      }\n    }\n  }\n\n  endDrag(x: number, y: number): void {\n    if (this.stageDragState) {\n      this.moveDrag(x, y);\n      this.stageDragState = null;\n    }\n  }\n\n  onStageMouseWheel(konvaEvent: KonvaEventObject<WheelEvent>): void {\n    const f = Math.pow(2, -konvaEvent.evt.deltaY * this.viewConfig.wheelScale * 0.001);\n    this.diagram.config.scrollX += (f - 1) * (konvaEvent.evt.clientX - this.diagram.config.leftPaneWidth + this.diagram.config.scrollX);\n    this.diagram.config.scrollY = \n      Math.max(0, Math.min(this.diagram.maxRelY + this.diagram.config.topPaneHeight - this.viewState.viewHeight,\n      this.diagram.config.scrollY + (f - 1) * (konvaEvent.evt.clientY - this.diagram.config.topPaneHeight + this.diagram.config.scrollY)));\n    this.diagram.config.xScale *= f;\n    this.diagram.config.yScale *= f;\n    this.$emit(\"updateY\");\n    konvaEvent.evt.preventDefault();\n  }\n\n  onPinch(event: { scale: number, isLast: boolean }): void {\n    if (!this.pinchState) {\n      this.pinchState = { \n        scaleX0: this.diagram.config.xScale,\n        scaleY0: this.diagram.config.yScale\n      };\n    }\n    this.diagram.config.xScale = this.pinchState.scaleX0 * event.scale;\n    this.diagram.config.yScale = this.pinchState.scaleY0 * event.scale;\n    if (event.isLast) {\n      this.pinchState = null;\n    }\n    this.$emit(\"updateY\");\n  }\n\n  onKeyDown(event: KeyboardEvent): void {\n    if (!event.repeat) {\n      if (event.key == \"Shift\") {\n        this.viewState.pointerPreciseState = {\n          sx0: this.viewState.pointerScreenX,\n          t0: this.viewState.pointerTime\n        };\n      }\n      if (event.key == \"Control\") {\n        this.viewState.controlKeyPressed = true;\n      }\n      if (event.key == \"Delete\" && this.viewConfig.editMode && !this.viewState.busy) {\n        const deletingTrains: Train[] = [];\n        const deletingStevs: { stev: StopEvent, index: number }[] = [];\n        for (const sel of Object.values(this.viewState.trainSelections)) {\n          if (!sel.stevRange) {\n            deletingTrains.push(sel.train);\n          } else {\n            const fromIndex = sel.train.stevs.indexOf(sel.stevRange.from);\n            const toIndex = sel.train.stevs.indexOf(sel.stevRange.to);\n            const size = toIndex - fromIndex + 1;\n            if (size >= sel.train.stevs.length - 1) {\n              deletingTrains.push(sel.train);\n            } else {\n              for (let i = fromIndex; i <= toIndex; ++i) {\n                deletingStevs.push({ stev: sel.train.stevs[i], index: i });\n              }\n            }\n          }\n        }\n        deletingTrains.forEach(train => this.$delete(this.diagram.trains, train.id));\n        deletingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n        this.historyManager.push({\n          undo: () => {\n            deletingStevs.forEach(e => e.stev.train.addNewStopEvent(e.stev, e.index));\n            deletingTrains.forEach(train => this.$set(this.diagram.trains, train.id, train));\n          },\n          redo: () => {\n            deletingTrains.forEach(train => this.$delete(this.diagram.trains, train.id));\n            deletingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n          }\n        });\n        this.viewState.trainSelections = {};\n      }\n    }\n  }\n\n  onKeyUp(event: KeyboardEvent): void {\n    if (event.key == \"Shift\") {\n      this.viewState.pointerPreciseState = null;\n    }\n    if (event.key == \"Control\") {\n      this.viewState.controlKeyPressed = false;\n    }\n  }\n\n  onContextMenu(konvaEvent: KonvaEventObject<MouseEvent>): boolean {\n    konvaEvent.evt.preventDefault();\n    return false;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Stage.vue?vue&type=template&id=64659d1f&scoped=true&\"\nimport script from \"./Stage.vue?vue&type=script&lang=ts&\"\nexport * from \"./Stage.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"64659d1f\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.viewConfig.editMode && _vm.station.expanded && _vm.isBottomLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":\"plus\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport Track from \"@/data/Track\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationAddTrackButton extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelRightMargin}px`,\n      top: `${this.diagram.getYByRelY(this.station.bottomRelY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isBottomLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.bottomRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.inputEnabled) {\n      const newTrack = this.station.addNewTrack(new Track(this.station, this.diagram.genId(), \"\"));\n      this.historyManager.push({\n        undo: () => { this.station.removeTrack(newTrack); },\n        redo: () => { this.station.addNewTrack(newTrack); }\n      });\n      this.$emit(\"updateY\");\n\n      this.viewState.trackNameInputTarget = newTrack;\n      this.$emit(\"trackNameInputStart\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationAddTrackButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationAddTrackButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationAddTrackButton.vue?vue&type=template&id=5b8586aa&scoped=true&\"\nimport script from \"./StationAddTrackButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationAddTrackButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5b8586aa\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isBottomLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":_vm.icon,\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationExpandButton extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Prop() station!: Station;\n\n  get icon(): string {\n    return this.station.expanded ? \"chevron-up\" : \"chevron-down\";\n  }\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.stationLabelLeftMargin}px`,\n      top: `${this.diagram.getYByRelY(this.station.bottomRelY)}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isBottomLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.bottomRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.bottomRelY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.inputEnabled) {\n      this.$set(this.station, \"expanded\", !this.station.expanded);\n      this.$emit(\"updateY\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationExpandButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationExpandButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationExpandButton.vue?vue&type=template&id=154aa5d4&scoped=true&\"\nimport script from \"./StationExpandButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationExpandButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"154aa5d4\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.stationNameInputTarget),expression:\"viewState.stationNameInputTarget\"}],style:(_vm.style),domProps:{\"value\":_vm.targetStation.name},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onComplete($event)},\"blur\":_vm.onComplete}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationNameInput extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n\n  get targetStation(): Station | Record<string, never> {\n    return this.viewState.stationNameInputTarget ?? {};\n  }\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.stationLabelLeftMargin}px`,\n      top: `${this.diagram.getYByRelY(this.targetStation.topRelY) - this.diagram.config.stationLabelFontSize - 4}px`,\n      width: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.stationLabelRightMargin}px`,\n      height: `${this.diagram.config.stationLabelFontSize + 4}px`,\n      paddingTop: \"2px\",\n      lineHeight: `${this.diagram.config.stationLabelFontSize}px`,\n      border: \"none\",\n      fontSize: `${this.diagram.config.stationLabelFontSize}px`,\n    };\n  }\n\n  onComplete(): void {\n    const targetStation = this.targetStation;\n    const name0 = this.targetStation.name;\n    const name1 = (this.$el as HTMLInputElement).value;\n    targetStation.name = name1;\n    this.historyManager.push({\n      undo: () => { targetStation.name = name0; },\n      redo: () => { targetStation.name = name1; }\n    });\n    this.viewState.stationNameInputTarget = null;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationNameInput.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationNameInput.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationNameInput.vue?vue&type=template&id=9f0b4232&scoped=true&\"\nimport script from \"./StationNameInput.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationNameInput.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9f0b4232\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.viewConfig.editMode && _vm.isTopLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":\"close\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport StopEvent from \"@/data/StopEvent\";\nimport Train from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationRemoveButton extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelRightMargin}px`,\n      top: `${this.diagram.getYByRelY(this.station.topRelY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isTopLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.station.topRelY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.station.topRelY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.busy) {\n      const removingTrains: Train[] = [];\n      const removingStevs: { stev: StopEvent, index: number }[] = [];\n      for (const train of Object.values(this.diagram.trains)) {\n        for (let i = train.stevs.length - 1; i >= 0; --i) {\n          const stev = train.stevs[i];\n          if (stev.station == this.station) {\n            train.removeStopEvent(stev);\n            removingStevs.push({ stev, index: i });\n            if (train.stevs.length <= 1) {\n              this.diagram.removeTrain(train);\n              removingTrains.push(train);\n            }\n          }\n        }\n      }\n\n      this.$delete(this.diagram.stations, this.station.id);\n\n      this.historyManager.push({\n        undo: () => { \n          this.$set(this.diagram.stations, this.station.id, this.station);\n          removingTrains.forEach(train => this.diagram.addNewTrain(train)); \n          removingStevs.forEach(e => e.stev.train.addNewStopEvent(e.stev, e.index));\n        },\n        redo: () => { \n          removingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n          removingTrains.forEach(train => this.diagram.removeTrain(train)); \n          this.$delete(this.diagram.stations, this.station.id); \n        }\n      });\n      this.$emit(\"updateY\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationRemoveButton.vue?vue&type=template&id=234953ee&scoped=true&\"\nimport script from \"./StationRemoveButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationRemoveButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"234953ee\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.viewConfig.editMode && _vm.station.expanded && Object.values(_vm.station.tracks).length > 1 && _vm.isLineIntersectingPlotPane)?_c('b-icon',{style:(_vm.style),attrs:{\"icon\":\"close\",\"size\":\"is-small\"},nativeOn:{\"click\":function($event){return _vm.onClick($event)}}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Prop, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Station from \"@/data/Station\";\nimport StopEvent from \"@/data/StopEvent\";\nimport Track from \"@/data/Track\";\nimport Train from \"@/data/Train\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class StationRemoveTrackButton extends Vue {\n  @InjectReactive() viewConfig!: ViewConfig;\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n  @Prop() station!: Station;\n  @Prop() track!: Track;\n\n  get style(): unknown {\n    return {\n      left: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelRightMargin}px`,\n      top: `${this.diagram.getYByRelY(this.track.relY) - this.diagram.config.trackLineSpan}px`,\n      height: `${this.diagram.config.trackLineSpan}px`,\n    };\n  }\n\n  get isLineIntersectingPlotPane(): boolean {\n    return this.diagram.getYByRelY(this.track.relY) >= this.diagram.config.topPaneHeight && \n      this.diagram.getYByRelY(this.track.relY) < this.viewState.viewHeight;\n  }\n\n  onClick(): void {\n    if (!this.viewState.busy) {\n      const removingTrains: Train[] = [];\n      const removingStevs: { stev: StopEvent, index: number }[] = [];\n      for (const train of Object.values(this.diagram.trains)) {\n        for (let i = train.stevs.length - 1; i >= 0; --i) {\n          const stev = train.stevs[i];\n          if (stev.track == this.track) {\n            train.removeStopEvent(stev);\n            removingStevs.push({ stev, index: i });\n            if (train.stevs.length <= 1) {\n              this.diagram.removeTrain(train);\n              removingTrains.push(train);\n            }\n          }\n        }\n      }\n      removingStevs.reverse();\n      const trackIndex = this.station.tracks.indexOf(this.track);\n\n      this.station.removeTrack(this.track);\n\n      this.historyManager.push({\n        undo: () => { \n          this.station.addNewTrack(this.track, trackIndex); \n          removingTrains.forEach(train => this.diagram.addNewTrain(train)); \n          removingStevs.forEach(e => e.stev.train.addNewStopEvent(e.stev, e.index));\n        },\n        redo: () => { \n          removingStevs.forEach(e => e.stev.train.removeStopEvent(e.stev));\n          removingTrains.forEach(train => this.diagram.removeTrain(train)); \n          this.station.removeTrack(this.track);\n        }\n      });\n      this.$emit(\"updateY\");\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StationRemoveTrackButton.vue?vue&type=template&id=457c01f8&scoped=true&\"\nimport script from \"./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./StationRemoveTrackButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"457c01f8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.viewState.trackNameInputTarget),expression:\"viewState.trackNameInputTarget\"}],style:(_vm.style),domProps:{\"value\":_vm.targetTrack.name},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onComplete($event)},\"blur\":_vm.onComplete}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Inject, InjectReactive, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport Track from \"@/data/Track\";\nimport ViewState from \"@/data/ViewState\";\n\n@Component\nexport default class TrackNameInput extends Vue {\n  @InjectReactive() viewState!: ViewState;\n  @InjectReactive() diagram!: Diagram;\n  @Inject() historyManager!: HistoryManager;\n\n  get targetTrack(): Track | Record<string, never> {\n    return this.viewState.trackNameInputTarget ?? {};\n  }\n\n  get style(): unknown {\n    return this.viewState.trackNameInputTarget ?\n      {\n        left: `${this.diagram.config.stationLabelLeftMargin + this.diagram.config.trackLabelLeftMargin}px`,\n        top: `${this.diagram.getYByRelY(this.targetTrack.relY) - this.diagram.config.stationLabelFontSize - 4}px`,\n        width: `${this.diagram.config.leftPaneWidth - this.diagram.config.stationLabelLeftMargin - this.diagram.config.trackLabelLeftMargin - this.diagram.config.stationLabelRightMargin}px`,\n        height: `${this.diagram.config.stationLabelFontSize + 4}px`,\n        paddingTop: \"2px\",\n        lineHeight: `${this.diagram.config.stationLabelFontSize}px`,\n        border: \"none\",\n        fontSize: `${this.diagram.config.stationLabelFontSize}px`,\n      } : {};\n  }\n\n  onComplete(): void {\n    const targetTrack = this.targetTrack;\n    const name0 = targetTrack.name;\n    const name1 = (this.$el as HTMLInputElement).value;\n    targetTrack.name = name1;\n    this.historyManager.push({\n      undo: () => { targetTrack.name = name0; },\n      redo: () => { targetTrack.name = name1; }\n    });\n    this.viewState.trackNameInputTarget = null;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackNameInput.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackNameInput.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TrackNameInput.vue?vue&type=template&id=652c3fab&scoped=true&\"\nimport script from \"./TrackNameInput.vue?vue&type=script&lang=ts&\"\nexport * from \"./TrackNameInput.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"652c3fab\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Provide, ProvideReactive, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"@/HistoryManager\";\nimport Diagram from \"@/data/Diagram\";\nimport ViewConfig from \"@/data/ViewConfig\";\nimport ViewState from \"@/data/ViewState\";\nimport Stage from \"./Stage.vue\";\nimport StationAddTrackButton from \"./StationAddTrackButton.vue\";\nimport StationExpandButton from \"./StationExpandButton.vue\";\nimport StationNameInput from \"./StationNameInput.vue\";\nimport StationRemoveButton from \"./StationRemoveButton.vue\";\nimport StationRemoveTrackButton from \"./StationRemoveTrackButton.vue\";\nimport TrackNameInput from \"./TrackNameInput.vue\";\n\n@Component({\n  components: {\n    Stage, StationAddTrackButton, StationExpandButton, StationNameInput, StationRemoveButton, StationRemoveTrackButton, TrackNameInput\n  },\n})\nexport default class DiagramView extends Vue {\n  @Prop({ default: () => Diagram.fromJSON({ stations: [], trains: [] }) }) @ProvideReactive() diagram!: Diagram;\n  @Prop({ default: new ViewConfig() }) @ProvideReactive() viewConfig!: ViewConfig;\n  @Prop() @Provide() historyManager!: HistoryManager;\n  @ProvideReactive() viewState = new ViewState();\n\n  mounted(): void {\n    const resizeObserver = new ResizeObserver(this.updateViewSize);\n    resizeObserver.observe(this.$el);\n  }\n\n  onStationNameInputStart(): void {\n    this.$nextTick(() => ((this.$refs.stationNameInput as Vue).$el as HTMLInputElement).focus());\n  }\n\n  onTrackNameInputStart(): void {\n    this.$nextTick(() => ((this.$refs.trackNameInput as Vue).$el as HTMLInputElement).focus());\n  }\n\n  updateViewSize(): void {\n    if (this.$el) {\n      this.viewState.viewWidth = this.$el.clientWidth;\n      this.viewState.viewHeight = this.$el.clientHeight;\n    }\n  }\n\n  updateY(): void {\n    this.diagram.updateY();\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DiagramView.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DiagramView.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./DiagramView.vue?vue&type=template&id=d5ac33d8&scoped=true&\"\nimport script from \"./DiagramView.vue?vue&type=script&lang=ts&\"\nexport * from \"./DiagramView.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./DiagramView.vue?vue&type=style&index=0&id=d5ac33d8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d5ac33d8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-carousel',{attrs:{\"autoplay\":false,\"indicator-inside\":false}},[_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_add_new_station.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewStationTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewStationBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_add_new_train.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewTrainTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.addNewTrainBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_select_train.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.selectTrainTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.selectTrainBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_edit_train.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTrainTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTrainBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('div',{staticClass:\"help-image\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_edit_time.png\")}})]),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTimeTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.editTimeBody'))}})])])]),_c('b-carousel-item',[_c('div',{staticClass:\"help-item\"},[_c('img',{attrs:{\"src\":require(\"@/assets/help_tips.png\")}}),_c('div',{staticClass:\"help-desc content\"},[_c('h5',{staticClass:\"title is-5\",domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.tipsTitle'))}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.help.tipsBody'))}})])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\n\n@Component\nexport default class HelpPane extends Vue {\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HelpPane.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HelpPane.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./HelpPane.vue?vue&type=template&id=da68d834&scoped=true&\"\nimport script from \"./HelpPane.vue?vue&type=script&lang=ts&\"\nexport * from \"./HelpPane.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./HelpPane.vue?vue&type=style&index=0&id=da68d834&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"da68d834\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from \"vue-property-decorator\";\nimport HistoryManager from \"./HistoryManager\";\nimport Diagram from \"./data/Diagram\";\nimport ViewConfig from \"./data/ViewConfig\";\nimport DiagramView from \"./components/DiagramView.vue\";\nimport HelpPane from \"./components/HelpPane.vue\";\n\n@Component({\n  components: {\n    DiagramView, HelpPane \n  },\n})\nexport default class App extends Vue {\n  diagramFileName = \"diagram.json\";\n  diagram = Diagram.fromJSON({ stations: [], trains: [] });\n  viewConfig = new ViewConfig();\n  historyManager = new HistoryManager(100);\n  helpPaneVisible = false;\n\n  mounted(): void {\n    this.viewConfig.editMode = document.body.clientWidth >= 600;\n    fetch(\"sample-diagram.json\").then(async result => {\n      const json = await result.json();\n      this.diagram = Diagram.fromJSON(json);\n      this.diagramFileName = \"sample-diagram.json\";\n    });\n  }\n\n  onEditButtonClick(): void {\n    this.viewConfig.editMode = !this.viewConfig.editMode;\n  }\n\n  onUndoButtonClick(): void {\n    this.historyManager.undo();\n  }\n\n  onRedoButtonClick(): void {\n    this.historyManager.redo();\n  }\n\n  onVanishButtonClick(): void {\n    if (Object.keys(this.diagram.trains).length > 0) {\n      const trains = this.diagram.trains;\n      this.historyManager.push({\n        undo: () => { this.diagram.trains = trains; },\n        redo: () => { this.diagram.trains = {}; }\n      });\n      this.diagram.trains = {}; \n    } else {\n      const diagram = this.diagram;\n      this.historyManager.push({\n        undo: () => { this.diagram = diagram; },\n        redo: () => { this.diagram = Diagram.fromJSON({ stations: {}, trains: {} }); }\n      });\n      this.diagram = Diagram.fromJSON({ stations: {}, trains: {} }); \n    }\n  }\n\n  onUploadButtonClick(): void {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \".json, application/json\";\n    input.onchange = () => {\n      const reader = new FileReader();\n      if (input.files && input.files.length > 0) {\n        const file = input.files[0];\n        reader.readAsText(file);\n        reader.onload = () => {\n          if (typeof(reader.result) == \"string\") {\n            try {\n              const data = JSON.parse(reader.result);\n              this.diagram = Diagram.fromJSON(data);\n              this.diagramFileName = file.name;\n              this.historyManager.clear();\n            } catch (e) {\n              this.$buefy.notification.open({\n                type: \"is-danger\",\n                message: `${this.$t(\"message.failedToLoadJSON\").toString()}<br>${file.name}`,\n              });\n            }\n          }\n        };\n      }\n    };\n    input.click();\n  }\n\n  onDownloadButtonClick(): void {\n    const json = JSON.stringify(this.diagram);\n    const blob = new Blob([ json ], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = this.diagramFileName;\n    a.click();\n  }\n\n  onHelpButtonClick(): void {\n    this.helpPaneVisible = !this.helpPaneVisible;\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=9d5808c0&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\n    ja: {\n        message: {\n            confirmRemoveStationRefered: \"この駅を使用している列車があります。駅を削除すると、列車の時刻情報も削除されます。よろしいですか？\",\n            confirmRemoveTrackRefered: \"この番線を使用している列車があります。番線を削除すると、列車の時刻情報も削除されます。よろしいですか？\",\n            failedToLoadJSON: \"ファイルの読み込みに失敗しました。\",\n            editButtonTooltip: \"編集モード\",\n            undoButtonTooltip: \"元に戻す\",\n            redoButtonTooltip: \"やり直す\",\n            vanishTrainsButtonTooltip: \"列車をクリア\",\n            vanishStationsButtonTooltip: \"駅をクリア\",\n            uploadButtonTooltip: \"ダイヤファイルを読み込む\",\n            downloadButtonTooltip: \"ダイヤファイルを保存する\",\n            helpButtonTooltip: \"操作方法\",\n            help: {\n                addNewStationTitle: \"駅を追加する\",\n                addNewStationBody: \n                    \"<p>左側の駅名エリアをダブルクリックすると、新しい駅を追加できます。</p>\" +\n                    \"<ul><li>駅名をドラッグすると、駅線の位置を調整できます。\" +\n                    \"<li>駅名をクリックすると、駅名を編集できます。\" +\n                    \"<li>駅右側の<i class='mdi mdi-close'></i>アイコンをクリックすると、駅を削除できます。</ul>\",\n                addNewTrainTitle: \"列車を追加する\",\n                addNewTrainBody:\n                    \"<p>駅線の上でダブルクリックすると、新しい列車を追加できます。駅線を続けてクリックして、停車駅を順に追加できます。</p>\" +\n                    \"<ul><li>列車線の編集を終了するには、もう一度ダブルクリックします。\" +\n                    \"<li>Shiftキーを押しながらカーソルを動かすと、秒単位で時刻を指定できます。\" +\n                    \"<li>右クリックすると、追加した停車駅を順に削除します。</ul>\",\n                selectTrainTitle: \"列車を選択する\",\n                selectTrainBody:\n                    \"<p>列車線をクリックすると、列車を選択できます。</p>\" +\n                    \"<ul><li>Ctrlキーを押しながら別の列車線クリックすると、複数列車を選択できます。\" +\n                    \"<li>列車を選択した状態でさらにクリックすると、特定の駅または駅間を選択できます。<br>Ctrlキーを押しながらクリックすると、複数駅間を選択できます。</ul>\",\n                editTrainTitle: \"列車を編集する\",\n                editTrainBody:\n                    \"<p>列車を選択した状態では、さまざまな方法で列車を編集できます。</p>\" +\n                    \"<ul><li>列車線と駅線の交点をダブルクリックすると、停車駅を追加できます。\" +\n                    \"<li>列車線の始端・終端をダブルクリックすると、列車を延長できます。\" +\n                    \"<li>Deleteキーを押すと、選択した区間を削除できます。</ul>\",\n                editTimeTitle: \"着発時刻を編集する\",\n                editTimeBody: \n                    \"<p>列車を選択した状態では、さまざまな方法で時刻を編集できます。</p>\" +\n                    \"<ul><li>列車線をドラッグすると、選択した区間の時刻を変更できます。\" +\n                    \"<li>Shiftキーを押しながらカーソルを動かすと、秒単位で時刻を指定できます。\" +\n                    \"<li>番線を開いた状態でドラッグすることで、着発番線を変更できます。\",\n                tipsTitle: \"便利な機能\",\n                tipsBody: \n                    \"<p>その他にも、さまざまな便利な機能があります。</p>\" +\n                    \"<ul><li>列車線を選択した状態でCtrlキーを押しながらドラッグすると、列車線をコピーできます。\" +\n                    \"<li><i class='mdi mdi-upload'></i>ボタンを押すと、ローカルファイルのダイヤデータをロードできます。\" +\n                    \"<li><i class='mdi mdi-download'></i>ボタンを押すと、ダイヤデータをローカルファイルに保存できます。\"\n            },\n        },\n    },\n};\n","import Vue from \"vue\";\nimport Buefy from \"buefy\";\nimport \"buefy/dist/buefy.css\";\nimport VueI18n from \"vue-i18n\";\nimport VueKonva from \"vue-konva\";\nimport { VueHammer } from \"vue2-hammer\";\nimport App from \"./App.vue\";\nimport messages from \"./messages\";\n\nVue.config.productionTip = false\nVue.use(Buefy, {\n  defaultNotificationDuration: 5000,\n  defaultNotificationPosition: \"is-bottom-right\",\n});\nVue.use(VueI18n);\nVue.use(VueKonva);\nVue.use(VueHammer);\n\nconst i18n = new VueI18n({\n  locale: \"ja\",\n  messages,\n});\n\nnew Vue({\n  render: h => h(App),\n  i18n,\n}).$mount(\"#app\");\n","module.exports = __webpack_public_path__ + \"img/logo.b1deff45.png\";"],"sourceRoot":""}